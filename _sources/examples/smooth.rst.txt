
.. DO NOT EDIT.
.. THIS FILE WAS AUTOMATICALLY GENERATED BY SPHINX-GALLERY.
.. TO MAKE CHANGES, EDIT THE SOURCE PYTHON FILE:
.. "examples/smooth.py"
.. LINE NUMBERS ARE GIVEN BELOW.

.. only:: html

    .. note::
        :class: sphx-glr-download-link-note

        :ref:`Go to the end <sphx_glr_download_examples_smooth.py>`
        to download the full example code. or to run this example in your browser via Binder

.. rst-class:: sphx-glr-example-title

.. _sphx_glr_examples_smooth.py:

Smooth pose tracks
=====================

Smooth pose tracks using the rolling median and Savitzky-Golay filters.

.. GENERATED FROM PYTHON SOURCE LINES 8-10

Imports
-------

.. GENERATED FROM PYTHON SOURCE LINES 10-21

.. code-block:: Python


    import matplotlib.pyplot as plt
    from scipy.signal import welch

    from movement import sample_data
    from movement.filtering import (
        interpolate_over_time,
        rolling_filter,
        savgol_filter,
    )








.. GENERATED FROM PYTHON SOURCE LINES 22-28

Load a sample dataset
---------------------
Let's load a sample dataset and print it to inspect its contents.
Note that if you are running this notebook interactively, you can simply
type the variable name (here ``ds_wasp``) in a cell to get an interactive
display of the dataset's contents.

.. GENERATED FROM PYTHON SOURCE LINES 28-32

.. code-block:: Python


    ds_wasp = sample_data.fetch_dataset("DLC_single-wasp.predictions.h5")
    print(ds_wasp)





.. rst-class:: sphx-glr-script-out

 .. code-block:: none

    <xarray.Dataset> Size: 61kB
    Dimensions:      (time: 1085, space: 2, keypoints: 2, individuals: 1)
    Coordinates:
      * time         (time) float64 9kB 0.0 0.025 0.05 0.075 ... 27.05 27.07 27.1
      * space        (space) <U1 8B 'x' 'y'
      * keypoints    (keypoints) <U7 56B 'head' 'stinger'
      * individuals  (individuals) <U12 48B 'individual_0'
    Data variables:
        position     (time, space, keypoints, individuals) float64 35kB 1.086e+03...
        confidence   (time, keypoints, individuals) float64 17kB 0.05305 ... 0.0
    Attributes:
        source_software:  DeepLabCut
        ds_type:          poses
        fps:              40.0
        time_unit:        seconds
        source_file:      /home/runner/.movement/data/poses/DLC_single-wasp.predi...
        frame_path:       /home/runner/.movement/data/frames/single-wasp_frame-10...




.. GENERATED FROM PYTHON SOURCE LINES 33-37

We see that the dataset contains the 2D pose tracks and confidence scores
for a single wasp, generated with DeepLabCut. The wasp is tracked at two
keypoints: "head" and "stinger" in a video that was recorded at 40 fps and
lasts for approximately 27 seconds.

.. GENERATED FROM PYTHON SOURCE LINES 39-47

Define a plotting function
--------------------------
Let's define a plotting function to help us visualise the effects of
smoothing both in the time and frequency domains.
The function takes as inputs two datasets containing raw and smooth data
respectively, and plots the position time series and power spectral density
(PSD) for a given individual and keypoint. The function also allows you to
specify the spatial coordinate (``x`` or ``y``) and a time range to focus on.

.. GENERATED FROM PYTHON SOURCE LINES 47-112

.. code-block:: Python



    def plot_raw_and_smooth_timeseries_and_psd(
        ds_raw,
        ds_smooth,
        individual="individual_0",
        keypoint="stinger",
        space="x",
        time_range=None,
    ):
        # If no time range is specified, plot the entire time series
        if time_range is None:
            time_range = slice(0, ds_raw.time[-1])

        selection = {
            "time": time_range,
            "individuals": individual,
            "keypoints": keypoint,
            "space": space,
        }

        fig, ax = plt.subplots(2, 1, figsize=(10, 6))

        for ds, color, label in zip(
            [ds_raw, ds_smooth], ["k", "r"], ["raw", "smooth"], strict=False
        ):
            # plot position time series
            pos = ds.position.sel(**selection)
            ax[0].plot(
                pos.time,
                pos,
                color=color,
                lw=2,
                alpha=0.7,
                label=f"{label} {space}",
            )

            # interpolate data to remove NaNs in the PSD calculation
            pos_interp = interpolate_over_time(pos, fill_value="extrapolate")

            # compute and plot the PSD
            freq, psd = welch(pos_interp, fs=ds.fps, nperseg=256)
            ax[1].semilogy(
                freq,
                psd,
                color=color,
                lw=2,
                alpha=0.7,
                label=f"{label} {space}",
            )

        ax[0].set_ylabel(f"{space} position (px)")
        ax[0].set_xlabel("Time (s)")
        ax[0].set_title("Time Domain")
        ax[0].legend()

        ax[1].set_ylabel("PSD (px$^2$/Hz)")
        ax[1].set_xlabel("Frequency (Hz)")
        ax[1].set_title("Frequency Domain")
        ax[1].legend()

        plt.tight_layout()
        fig.show()









.. GENERATED FROM PYTHON SOURCE LINES 113-128

Smoothing with a rolling median filter
--------------------------------------
Using the :func:`movement.filtering.rolling_filter` function on the
``position`` data variable, we can apply a rolling median filter
over a 0.1-second window (4 frames) to the wasp dataset.
As the ``window`` parameter is defined in *number of observations*,
we can simply multiply the desired time window by the frame rate
of the video. We will also create a copy of the dataset to avoid
modifying the original data.

Here we use the default ``statistic="median"`` option, which is a sensible
choice for smoothing time-series data while being robust to outliers.
You can also use the ``rolling_filter`` function to compute the rolling
mean, maximum, and minimum values (instead of the median), by
setting ``statistic`` to ``"mean"``, ``"max"``, or ``"min"``, respectively.

.. GENERATED FROM PYTHON SOURCE LINES 128-139

.. code-block:: Python


    window = int(0.1 * ds_wasp.fps)
    ds_wasp_smooth = ds_wasp.copy()
    ds_wasp_smooth.update(
        {
            "position": rolling_filter(
                ds_wasp.position, window, statistic="median", print_report=True
            )
        }
    )





.. rst-class:: sphx-glr-script-out

 .. code-block:: none


    Missing points (marked as NaN) in input
            Individual: individual_0
                    head: 0/1085 (0.0%)
                    stinger: 0/1085 (0.0%)

    Missing points (marked as NaN) in output
            Individual: individual_0
                    head: 0/1085 (0.0%)
                    stinger: 0/1085 (0.0%)


.. raw:: html

    <div class="output_subarea output_html rendered_html output_result">
    <div><svg style="position: absolute; width: 0; height: 0; overflow: hidden">
    <defs>
    <symbol id="icon-database" viewBox="0 0 32 32">
    <path d="M16 0c-8.837 0-16 2.239-16 5v4c0 2.761 7.163 5 16 5s16-2.239 16-5v-4c0-2.761-7.163-5-16-5z"></path>
    <path d="M16 17c-8.837 0-16-2.239-16-5v6c0 2.761 7.163 5 16 5s16-2.239 16-5v-6c0 2.761-7.163 5-16 5z"></path>
    <path d="M16 26c-8.837 0-16-2.239-16-5v6c0 2.761 7.163 5 16 5s16-2.239 16-5v-6c0 2.761-7.163 5-16 5z"></path>
    </symbol>
    <symbol id="icon-file-text2" viewBox="0 0 32 32">
    <path d="M28.681 7.159c-0.694-0.947-1.662-2.053-2.724-3.116s-2.169-2.030-3.116-2.724c-1.612-1.182-2.393-1.319-2.841-1.319h-15.5c-1.378 0-2.5 1.121-2.5 2.5v27c0 1.378 1.122 2.5 2.5 2.5h23c1.378 0 2.5-1.122 2.5-2.5v-19.5c0-0.448-0.137-1.23-1.319-2.841zM24.543 5.457c0.959 0.959 1.712 1.825 2.268 2.543h-4.811v-4.811c0.718 0.556 1.584 1.309 2.543 2.268zM28 29.5c0 0.271-0.229 0.5-0.5 0.5h-23c-0.271 0-0.5-0.229-0.5-0.5v-27c0-0.271 0.229-0.5 0.5-0.5 0 0 15.499-0 15.5 0v7c0 0.552 0.448 1 1 1h7v19.5z"></path>
    <path d="M23 26h-14c-0.552 0-1-0.448-1-1s0.448-1 1-1h14c0.552 0 1 0.448 1 1s-0.448 1-1 1z"></path>
    <path d="M23 22h-14c-0.552 0-1-0.448-1-1s0.448-1 1-1h14c0.552 0 1 0.448 1 1s-0.448 1-1 1z"></path>
    <path d="M23 18h-14c-0.552 0-1-0.448-1-1s0.448-1 1-1h14c0.552 0 1 0.448 1 1s-0.448 1-1 1z"></path>
    </symbol>
    </defs>
    </svg>
    <style>/* CSS stylesheet for displaying xarray objects in jupyterlab.
     *
     */

    :root {
      --xr-font-color0: var(--jp-content-font-color0, rgba(0, 0, 0, 1));
      --xr-font-color2: var(--jp-content-font-color2, rgba(0, 0, 0, 0.54));
      --xr-font-color3: var(--jp-content-font-color3, rgba(0, 0, 0, 0.38));
      --xr-border-color: var(--jp-border-color2, #e0e0e0);
      --xr-disabled-color: var(--jp-layout-color3, #bdbdbd);
      --xr-background-color: var(--jp-layout-color0, white);
      --xr-background-color-row-even: var(--jp-layout-color1, white);
      --xr-background-color-row-odd: var(--jp-layout-color2, #eeeeee);
    }

    html[theme="dark"],
    html[data-theme="dark"],
    body[data-theme="dark"],
    body.vscode-dark {
      --xr-font-color0: rgba(255, 255, 255, 1);
      --xr-font-color2: rgba(255, 255, 255, 0.54);
      --xr-font-color3: rgba(255, 255, 255, 0.38);
      --xr-border-color: #1f1f1f;
      --xr-disabled-color: #515151;
      --xr-background-color: #111111;
      --xr-background-color-row-even: #111111;
      --xr-background-color-row-odd: #313131;
    }

    .xr-wrap {
      display: block !important;
      min-width: 300px;
      max-width: 700px;
    }

    .xr-text-repr-fallback {
      /* fallback to plain text repr when CSS is not injected (untrusted notebook) */
      display: none;
    }

    .xr-header {
      padding-top: 6px;
      padding-bottom: 6px;
      margin-bottom: 4px;
      border-bottom: solid 1px var(--xr-border-color);
    }

    .xr-header > div,
    .xr-header > ul {
      display: inline;
      margin-top: 0;
      margin-bottom: 0;
    }

    .xr-obj-type,
    .xr-array-name {
      margin-left: 2px;
      margin-right: 10px;
    }

    .xr-obj-type {
      color: var(--xr-font-color2);
    }

    .xr-sections {
      padding-left: 0 !important;
      display: grid;
      grid-template-columns: 150px auto auto 1fr 0 20px 0 20px;
    }

    .xr-section-item {
      display: contents;
    }

    .xr-section-item input {
      display: inline-block;
      opacity: 0;
      height: 0;
    }

    .xr-section-item input + label {
      color: var(--xr-disabled-color);
    }

    .xr-section-item input:enabled + label {
      cursor: pointer;
      color: var(--xr-font-color2);
    }

    .xr-section-item input:focus + label {
      border: 2px solid var(--xr-font-color0);
    }

    .xr-section-item input:enabled + label:hover {
      color: var(--xr-font-color0);
    }

    .xr-section-summary {
      grid-column: 1;
      color: var(--xr-font-color2);
      font-weight: 500;
    }

    .xr-section-summary > span {
      display: inline-block;
      padding-left: 0.5em;
    }

    .xr-section-summary-in:disabled + label {
      color: var(--xr-font-color2);
    }

    .xr-section-summary-in + label:before {
      display: inline-block;
      content: "►";
      font-size: 11px;
      width: 15px;
      text-align: center;
    }

    .xr-section-summary-in:disabled + label:before {
      color: var(--xr-disabled-color);
    }

    .xr-section-summary-in:checked + label:before {
      content: "▼";
    }

    .xr-section-summary-in:checked + label > span {
      display: none;
    }

    .xr-section-summary,
    .xr-section-inline-details {
      padding-top: 4px;
      padding-bottom: 4px;
    }

    .xr-section-inline-details {
      grid-column: 2 / -1;
    }

    .xr-section-details {
      display: none;
      grid-column: 1 / -1;
      margin-bottom: 5px;
    }

    .xr-section-summary-in:checked ~ .xr-section-details {
      display: contents;
    }

    .xr-array-wrap {
      grid-column: 1 / -1;
      display: grid;
      grid-template-columns: 20px auto;
    }

    .xr-array-wrap > label {
      grid-column: 1;
      vertical-align: top;
    }

    .xr-preview {
      color: var(--xr-font-color3);
    }

    .xr-array-preview,
    .xr-array-data {
      padding: 0 5px !important;
      grid-column: 2;
    }

    .xr-array-data,
    .xr-array-in:checked ~ .xr-array-preview {
      display: none;
    }

    .xr-array-in:checked ~ .xr-array-data,
    .xr-array-preview {
      display: inline-block;
    }

    .xr-dim-list {
      display: inline-block !important;
      list-style: none;
      padding: 0 !important;
      margin: 0;
    }

    .xr-dim-list li {
      display: inline-block;
      padding: 0;
      margin: 0;
    }

    .xr-dim-list:before {
      content: "(";
    }

    .xr-dim-list:after {
      content: ")";
    }

    .xr-dim-list li:not(:last-child):after {
      content: ",";
      padding-right: 5px;
    }

    .xr-has-index {
      font-weight: bold;
    }

    .xr-var-list,
    .xr-var-item {
      display: contents;
    }

    .xr-var-item > div,
    .xr-var-item label,
    .xr-var-item > .xr-var-name span {
      background-color: var(--xr-background-color-row-even);
      margin-bottom: 0;
    }

    .xr-var-item > .xr-var-name:hover span {
      padding-right: 5px;
    }

    .xr-var-list > li:nth-child(odd) > div,
    .xr-var-list > li:nth-child(odd) > label,
    .xr-var-list > li:nth-child(odd) > .xr-var-name span {
      background-color: var(--xr-background-color-row-odd);
    }

    .xr-var-name {
      grid-column: 1;
    }

    .xr-var-dims {
      grid-column: 2;
    }

    .xr-var-dtype {
      grid-column: 3;
      text-align: right;
      color: var(--xr-font-color2);
    }

    .xr-var-preview {
      grid-column: 4;
    }

    .xr-index-preview {
      grid-column: 2 / 5;
      color: var(--xr-font-color2);
    }

    .xr-var-name,
    .xr-var-dims,
    .xr-var-dtype,
    .xr-preview,
    .xr-attrs dt {
      white-space: nowrap;
      overflow: hidden;
      text-overflow: ellipsis;
      padding-right: 10px;
    }

    .xr-var-name:hover,
    .xr-var-dims:hover,
    .xr-var-dtype:hover,
    .xr-attrs dt:hover {
      overflow: visible;
      width: auto;
      z-index: 1;
    }

    .xr-var-attrs,
    .xr-var-data,
    .xr-index-data {
      display: none;
      background-color: var(--xr-background-color) !important;
      padding-bottom: 5px !important;
    }

    .xr-var-attrs-in:checked ~ .xr-var-attrs,
    .xr-var-data-in:checked ~ .xr-var-data,
    .xr-index-data-in:checked ~ .xr-index-data {
      display: block;
    }

    .xr-var-data > table {
      float: right;
    }

    .xr-var-name span,
    .xr-var-data,
    .xr-index-name div,
    .xr-index-data,
    .xr-attrs {
      padding-left: 25px !important;
    }

    .xr-attrs,
    .xr-var-attrs,
    .xr-var-data,
    .xr-index-data {
      grid-column: 1 / -1;
    }

    dl.xr-attrs {
      padding: 0;
      margin: 0;
      display: grid;
      grid-template-columns: 125px auto;
    }

    .xr-attrs dt,
    .xr-attrs dd {
      padding: 0;
      margin: 0;
      float: left;
      padding-right: 10px;
      width: auto;
    }

    .xr-attrs dt {
      font-weight: normal;
      grid-column: 1;
    }

    .xr-attrs dt:hover span {
      display: inline-block;
      background: var(--xr-background-color);
      padding-right: 10px;
    }

    .xr-attrs dd {
      grid-column: 2;
      white-space: pre-wrap;
      word-break: break-all;
    }

    .xr-icon-database,
    .xr-icon-file-text2,
    .xr-no-icon {
      display: inline-block;
      vertical-align: middle;
      width: 1em;
      height: 1.5em !important;
      stroke-width: 0;
      stroke: currentColor;
      fill: currentColor;
    }
    </style><pre class='xr-text-repr-fallback'>&lt;xarray.Dataset&gt; Size: 61kB
    Dimensions:      (time: 1085, space: 2, keypoints: 2, individuals: 1)
    Coordinates:
      * time         (time) float64 9kB 0.0 0.025 0.05 0.075 ... 27.05 27.07 27.1
      * space        (space) &lt;U1 8B &#x27;x&#x27; &#x27;y&#x27;
      * keypoints    (keypoints) &lt;U7 56B &#x27;head&#x27; &#x27;stinger&#x27;
      * individuals  (individuals) &lt;U12 48B &#x27;individual_0&#x27;
    Data variables:
        position     (time, space, keypoints, individuals) float64 35kB 1.086e+03...
        confidence   (time, keypoints, individuals) float64 17kB 0.05305 ... 0.0
    Attributes:
        source_software:  DeepLabCut
        ds_type:          poses
        fps:              40.0
        time_unit:        seconds
        source_file:      /home/runner/.movement/data/poses/DLC_single-wasp.predi...
        frame_path:       /home/runner/.movement/data/frames/single-wasp_frame-10...</pre><div class='xr-wrap' style='display:none'><div class='xr-header'><div class='xr-obj-type'>xarray.Dataset</div></div><ul class='xr-sections'><li class='xr-section-item'><input id='section-38ad2686-8f83-43ef-b127-2ed45352f0ed' class='xr-section-summary-in' type='checkbox' disabled ><label for='section-38ad2686-8f83-43ef-b127-2ed45352f0ed' class='xr-section-summary'  title='Expand/collapse section'>Dimensions:</label><div class='xr-section-inline-details'><ul class='xr-dim-list'><li><span class='xr-has-index'>time</span>: 1085</li><li><span class='xr-has-index'>space</span>: 2</li><li><span class='xr-has-index'>keypoints</span>: 2</li><li><span class='xr-has-index'>individuals</span>: 1</li></ul></div><div class='xr-section-details'></div></li><li class='xr-section-item'><input id='section-f2a5df35-d97d-4c68-9121-cfb0a0279e2e' class='xr-section-summary-in' type='checkbox'  checked><label for='section-f2a5df35-d97d-4c68-9121-cfb0a0279e2e' class='xr-section-summary' >Coordinates: <span>(4)</span></label><div class='xr-section-inline-details'></div><div class='xr-section-details'><ul class='xr-var-list'><li class='xr-var-item'><div class='xr-var-name'><span class='xr-has-index'>time</span></div><div class='xr-var-dims'>(time)</div><div class='xr-var-dtype'>float64</div><div class='xr-var-preview xr-preview'>0.0 0.025 0.05 ... 27.05 27.07 27.1</div><input id='attrs-a940b3e8-9d1a-4102-a594-066039302b43' class='xr-var-attrs-in' type='checkbox' disabled><label for='attrs-a940b3e8-9d1a-4102-a594-066039302b43' title='Show/Hide attributes'><svg class='icon xr-icon-file-text2'><use xlink:href='#icon-file-text2'></use></svg></label><input id='data-9984b828-3fe6-4309-a134-a2a82e637639' class='xr-var-data-in' type='checkbox'><label for='data-9984b828-3fe6-4309-a134-a2a82e637639' title='Show/Hide data repr'><svg class='icon xr-icon-database'><use xlink:href='#icon-database'></use></svg></label><div class='xr-var-attrs'><dl class='xr-attrs'></dl></div><div class='xr-var-data'><pre>array([0.0000e+00, 2.5000e-02, 5.0000e-02, ..., 2.7050e+01, 2.7075e+01,
           2.7100e+01], shape=(1085,))</pre></div></li><li class='xr-var-item'><div class='xr-var-name'><span class='xr-has-index'>space</span></div><div class='xr-var-dims'>(space)</div><div class='xr-var-dtype'>&lt;U1</div><div class='xr-var-preview xr-preview'>&#x27;x&#x27; &#x27;y&#x27;</div><input id='attrs-186a95dd-4537-4e21-bf6b-6e6da6119f8d' class='xr-var-attrs-in' type='checkbox' disabled><label for='attrs-186a95dd-4537-4e21-bf6b-6e6da6119f8d' title='Show/Hide attributes'><svg class='icon xr-icon-file-text2'><use xlink:href='#icon-file-text2'></use></svg></label><input id='data-192c720e-a724-4e77-93b3-4aae6459002f' class='xr-var-data-in' type='checkbox'><label for='data-192c720e-a724-4e77-93b3-4aae6459002f' title='Show/Hide data repr'><svg class='icon xr-icon-database'><use xlink:href='#icon-database'></use></svg></label><div class='xr-var-attrs'><dl class='xr-attrs'></dl></div><div class='xr-var-data'><pre>array([&#x27;x&#x27;, &#x27;y&#x27;], dtype=&#x27;&lt;U1&#x27;)</pre></div></li><li class='xr-var-item'><div class='xr-var-name'><span class='xr-has-index'>keypoints</span></div><div class='xr-var-dims'>(keypoints)</div><div class='xr-var-dtype'>&lt;U7</div><div class='xr-var-preview xr-preview'>&#x27;head&#x27; &#x27;stinger&#x27;</div><input id='attrs-02d5d1e5-1ece-4124-8cba-eeb79404cc87' class='xr-var-attrs-in' type='checkbox' disabled><label for='attrs-02d5d1e5-1ece-4124-8cba-eeb79404cc87' title='Show/Hide attributes'><svg class='icon xr-icon-file-text2'><use xlink:href='#icon-file-text2'></use></svg></label><input id='data-7d9b48fb-6bf6-4fbf-ac6f-3eb3aeb125a2' class='xr-var-data-in' type='checkbox'><label for='data-7d9b48fb-6bf6-4fbf-ac6f-3eb3aeb125a2' title='Show/Hide data repr'><svg class='icon xr-icon-database'><use xlink:href='#icon-database'></use></svg></label><div class='xr-var-attrs'><dl class='xr-attrs'></dl></div><div class='xr-var-data'><pre>array([&#x27;head&#x27;, &#x27;stinger&#x27;], dtype=&#x27;&lt;U7&#x27;)</pre></div></li><li class='xr-var-item'><div class='xr-var-name'><span class='xr-has-index'>individuals</span></div><div class='xr-var-dims'>(individuals)</div><div class='xr-var-dtype'>&lt;U12</div><div class='xr-var-preview xr-preview'>&#x27;individual_0&#x27;</div><input id='attrs-df2bd1ff-31c8-4894-9be9-dcf22ef84933' class='xr-var-attrs-in' type='checkbox' disabled><label for='attrs-df2bd1ff-31c8-4894-9be9-dcf22ef84933' title='Show/Hide attributes'><svg class='icon xr-icon-file-text2'><use xlink:href='#icon-file-text2'></use></svg></label><input id='data-6cddd4c2-972e-427f-a98d-80600d797e49' class='xr-var-data-in' type='checkbox'><label for='data-6cddd4c2-972e-427f-a98d-80600d797e49' title='Show/Hide data repr'><svg class='icon xr-icon-database'><use xlink:href='#icon-database'></use></svg></label><div class='xr-var-attrs'><dl class='xr-attrs'></dl></div><div class='xr-var-data'><pre>array([&#x27;individual_0&#x27;], dtype=&#x27;&lt;U12&#x27;)</pre></div></li></ul></div></li><li class='xr-section-item'><input id='section-cfe5b5b5-31dd-4ea0-b861-1a3f923e4772' class='xr-section-summary-in' type='checkbox'  checked><label for='section-cfe5b5b5-31dd-4ea0-b861-1a3f923e4772' class='xr-section-summary' >Data variables: <span>(2)</span></label><div class='xr-section-inline-details'></div><div class='xr-section-details'><ul class='xr-var-list'><li class='xr-var-item'><div class='xr-var-name'><span>position</span></div><div class='xr-var-dims'>(time, space, keypoints, individuals)</div><div class='xr-var-dtype'>float64</div><div class='xr-var-preview xr-preview'>1.086e+03 1.083e+03 ... 0.0 0.0</div><input id='attrs-d2f384bf-1d6b-450a-bd5e-00b4a81b5826' class='xr-var-attrs-in' type='checkbox' ><label for='attrs-d2f384bf-1d6b-450a-bd5e-00b4a81b5826' title='Show/Hide attributes'><svg class='icon xr-icon-file-text2'><use xlink:href='#icon-file-text2'></use></svg></label><input id='data-07d40e9d-5915-4003-9356-5efaf8b48143' class='xr-var-data-in' type='checkbox'><label for='data-07d40e9d-5915-4003-9356-5efaf8b48143' title='Show/Hide data repr'><svg class='icon xr-icon-database'><use xlink:href='#icon-database'></use></svg></label><div class='xr-var-attrs'><dl class='xr-attrs'><dt><span>log :</span></dt><dd>[{&#x27;operation&#x27;: &#x27;rolling_filter&#x27;, &#x27;datetime&#x27;: &#x27;2025-05-14 09:39:04.447559&#x27;, &#x27;arg_1&#x27;: 4, &#x27;statistic&#x27;: &#x27;median&#x27;, &#x27;print_report&#x27;: True}]</dd></dl></div><div class='xr-var-data'><pre>array([[[[1086.02038574],
             [1083.36999512]],

            [[ 421.54428101],
             [ 421.45770264]]],


           [[[1086.02038574],
             [1083.36999512]],

            [[ 421.54428101],
             [ 421.45770264]]],


           [[[1085.78253174],
             [1083.15985107]],

            [[ 421.67584229],
             [ 421.53366089]]],

    ...

           [[[   0.        ],
             [   0.        ]],

            [[   0.        ],
             [   0.        ]]],


           [[[   0.        ],
             [   0.        ]],

            [[   0.        ],
             [   0.        ]]],


           [[[   0.        ],
             [   0.        ]],

            [[   0.        ],
             [   0.        ]]]], shape=(1085, 2, 2, 1))</pre></div></li><li class='xr-var-item'><div class='xr-var-name'><span>confidence</span></div><div class='xr-var-dims'>(time, keypoints, individuals)</div><div class='xr-var-dtype'>float64</div><div class='xr-var-preview xr-preview'>0.05305 0.07366 0.03532 ... 0.0 0.0</div><input id='attrs-6ef3b5fb-2968-48a4-9342-54e1b9a0fb04' class='xr-var-attrs-in' type='checkbox' disabled><label for='attrs-6ef3b5fb-2968-48a4-9342-54e1b9a0fb04' title='Show/Hide attributes'><svg class='icon xr-icon-file-text2'><use xlink:href='#icon-file-text2'></use></svg></label><input id='data-bdf9c258-42a9-4cad-ac5c-83b24c13f31c' class='xr-var-data-in' type='checkbox'><label for='data-bdf9c258-42a9-4cad-ac5c-83b24c13f31c' title='Show/Hide data repr'><svg class='icon xr-icon-database'><use xlink:href='#icon-database'></use></svg></label><div class='xr-var-attrs'><dl class='xr-attrs'></dl></div><div class='xr-var-data'><pre>array([[[0.05305099],
            [0.07366323]],

           [[0.03531652],
            [0.03293059]],

           [[0.01706707],
            [0.01022208]],

           ...,

           [[0.        ],
            [0.        ]],

           [[0.        ],
            [0.        ]],

           [[0.        ],
            [0.        ]]], shape=(1085, 2, 1))</pre></div></li></ul></div></li><li class='xr-section-item'><input id='section-78a81b84-aab5-42a4-a094-142545a2e337' class='xr-section-summary-in' type='checkbox'  ><label for='section-78a81b84-aab5-42a4-a094-142545a2e337' class='xr-section-summary' >Indexes: <span>(4)</span></label><div class='xr-section-inline-details'></div><div class='xr-section-details'><ul class='xr-var-list'><li class='xr-var-item'><div class='xr-index-name'><div>time</div></div><div class='xr-index-preview'>PandasIndex</div><input type='checkbox' disabled/><label></label><input id='index-21fc9644-2b11-494d-994e-46e7d9d10b03' class='xr-index-data-in' type='checkbox'/><label for='index-21fc9644-2b11-494d-994e-46e7d9d10b03' title='Show/Hide index repr'><svg class='icon xr-icon-database'><use xlink:href='#icon-database'></use></svg></label><div class='xr-index-data'><pre>PandasIndex(Index([   0.0,  0.025,   0.05,  0.075,    0.1,  0.125,   0.15,  0.175,    0.2,
            0.225,
           ...
           26.875,   26.9, 26.925,  26.95, 26.975,   27.0, 27.025,  27.05, 27.075,
             27.1],
          dtype=&#x27;float64&#x27;, name=&#x27;time&#x27;, length=1085))</pre></div></li><li class='xr-var-item'><div class='xr-index-name'><div>space</div></div><div class='xr-index-preview'>PandasIndex</div><input type='checkbox' disabled/><label></label><input id='index-e9da1e71-0041-4d00-b8fd-460689791510' class='xr-index-data-in' type='checkbox'/><label for='index-e9da1e71-0041-4d00-b8fd-460689791510' title='Show/Hide index repr'><svg class='icon xr-icon-database'><use xlink:href='#icon-database'></use></svg></label><div class='xr-index-data'><pre>PandasIndex(Index([&#x27;x&#x27;, &#x27;y&#x27;], dtype=&#x27;object&#x27;, name=&#x27;space&#x27;))</pre></div></li><li class='xr-var-item'><div class='xr-index-name'><div>keypoints</div></div><div class='xr-index-preview'>PandasIndex</div><input type='checkbox' disabled/><label></label><input id='index-a1ede286-ccbf-4930-bfcb-6865ff016d1d' class='xr-index-data-in' type='checkbox'/><label for='index-a1ede286-ccbf-4930-bfcb-6865ff016d1d' title='Show/Hide index repr'><svg class='icon xr-icon-database'><use xlink:href='#icon-database'></use></svg></label><div class='xr-index-data'><pre>PandasIndex(Index([&#x27;head&#x27;, &#x27;stinger&#x27;], dtype=&#x27;object&#x27;, name=&#x27;keypoints&#x27;))</pre></div></li><li class='xr-var-item'><div class='xr-index-name'><div>individuals</div></div><div class='xr-index-preview'>PandasIndex</div><input type='checkbox' disabled/><label></label><input id='index-bc93af24-51c7-426d-bda1-7fb26298059a' class='xr-index-data-in' type='checkbox'/><label for='index-bc93af24-51c7-426d-bda1-7fb26298059a' title='Show/Hide index repr'><svg class='icon xr-icon-database'><use xlink:href='#icon-database'></use></svg></label><div class='xr-index-data'><pre>PandasIndex(Index([&#x27;individual_0&#x27;], dtype=&#x27;object&#x27;, name=&#x27;individuals&#x27;))</pre></div></li></ul></div></li><li class='xr-section-item'><input id='section-52289be5-2cd9-4349-9125-55ed979ee8d0' class='xr-section-summary-in' type='checkbox'  checked><label for='section-52289be5-2cd9-4349-9125-55ed979ee8d0' class='xr-section-summary' >Attributes: <span>(6)</span></label><div class='xr-section-inline-details'></div><div class='xr-section-details'><dl class='xr-attrs'><dt><span>source_software :</span></dt><dd>DeepLabCut</dd><dt><span>ds_type :</span></dt><dd>poses</dd><dt><span>fps :</span></dt><dd>40.0</dd><dt><span>time_unit :</span></dt><dd>seconds</dd><dt><span>source_file :</span></dt><dd>/home/runner/.movement/data/poses/DLC_single-wasp.predictions.h5</dd><dt><span>frame_path :</span></dt><dd>/home/runner/.movement/data/frames/single-wasp_frame-10sec.png</dd></dl></div></li></ul></div></div>
    </div>
    <br />
    <br />

.. GENERATED FROM PYTHON SOURCE LINES 140-143

We see from the printed report that the dataset has no missing values
neither before nor after smoothing. Let's visualise the effects of applying
the rolling median filter in the time and frequency domains.

.. GENERATED FROM PYTHON SOURCE LINES 143-148

.. code-block:: Python


    plot_raw_and_smooth_timeseries_and_psd(
        ds_wasp, ds_wasp_smooth, keypoint="stinger"
    )




.. image-sg:: /examples/images/sphx_glr_smooth_001.png
   :alt: Time Domain, Frequency Domain
   :srcset: /examples/images/sphx_glr_smooth_001.png
   :class: sphx-glr-single-img





.. GENERATED FROM PYTHON SOURCE LINES 149-159

We see that applying the filter has removed the "spikes" present around the
14 second mark in the raw data. However, it has not dealt with the big shift
occurring during the final second. In the frequency domain, we can see that
the filter has reduced the power in the high-frequency components, without
affecting the low frequency components.

This shows what the rolling median is good for: removing brief "spikes"
(e.g. a keypoint abruptly jumping to a different location for a frame or two)
and high-frequency "jitter" (often present due to pose estimation
working on a per-frame basis).

.. GENERATED FROM PYTHON SOURCE LINES 161-168

Choosing parameters for the rolling filter
^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
We can control the behaviour of the rolling filter
via three parameters: ``window``, ``min_periods`` and ``statistic`` which was
mentioned above.
To better understand the effect of these parameters, let's use a
dataset that contains missing values.

.. GENERATED FROM PYTHON SOURCE LINES 168-172

.. code-block:: Python


    ds_mouse = sample_data.fetch_dataset("SLEAP_single-mouse_EPM.analysis.h5")
    print(ds_mouse)





.. rst-class:: sphx-glr-script-out

 .. code-block:: none

    <xarray.Dataset> Size: 1MB
    Dimensions:      (time: 18485, space: 2, keypoints: 6, individuals: 1)
    Coordinates:
      * time         (time) float64 148kB 0.0 0.03333 0.06667 ... 616.1 616.1 616.1
      * space        (space) <U1 8B 'x' 'y'
      * keypoints    (keypoints) <U9 216B 'snout' 'left_ear' ... 'tail_end'
      * individuals  (individuals) <U12 48B 'individual_0'
    Data variables:
        position     (time, space, keypoints, individuals) float32 887kB nan ... ...
        confidence   (time, keypoints, individuals) float32 444kB nan nan ... 0.7607
    Attributes:
        source_software:  SLEAP
        ds_type:          poses
        fps:              30.0
        time_unit:        seconds
        source_file:      /home/runner/.movement/data/poses/SLEAP_single-mouse_EP...
        frame_path:       /home/runner/.movement/data/frames/single-mouse_EPM_fra...




.. GENERATED FROM PYTHON SOURCE LINES 173-179

The dataset contains a single mouse with six keypoints tracked in
2D space. The video was recorded at 30 fps and lasts for ~616 seconds. We can
see that there are some missing values, indicated as "nan" in the
printed dataset.
Let's apply the rolling median filter over a 0.1-second window (3 frames)
to the dataset.

.. GENERATED FROM PYTHON SOURCE LINES 179-190

.. code-block:: Python


    window = int(0.1 * ds_mouse.fps)
    ds_mouse_smooth = ds_mouse.copy()
    ds_mouse_smooth.update(
        {
            "position": rolling_filter(
                ds_mouse.position, window, statistic="median", print_report=True
            )
        }
    )





.. rst-class:: sphx-glr-script-out

 .. code-block:: none


    Missing points (marked as NaN) in input
            Individual: individual_0
                    snout: 4494/18485 (24.3%)
                    left_ear: 513/18485 (2.8%)
                    right_ear: 533/18485 (2.9%)
                    centre: 490/18485 (2.7%)
                    tail_base: 704/18485 (3.8%)
                    tail_end: 2496/18485 (13.5%)

    Missing points (marked as NaN) in output
            Individual: individual_0
                    snout: 5106/18485 (27.6%)
                    left_ear: 678/18485 (3.7%)
                    right_ear: 695/18485 (3.8%)
                    centre: 640/18485 (3.5%)
                    tail_base: 913/18485 (4.9%)
                    tail_end: 3103/18485 (16.8%)


.. raw:: html

    <div class="output_subarea output_html rendered_html output_result">
    <div><svg style="position: absolute; width: 0; height: 0; overflow: hidden">
    <defs>
    <symbol id="icon-database" viewBox="0 0 32 32">
    <path d="M16 0c-8.837 0-16 2.239-16 5v4c0 2.761 7.163 5 16 5s16-2.239 16-5v-4c0-2.761-7.163-5-16-5z"></path>
    <path d="M16 17c-8.837 0-16-2.239-16-5v6c0 2.761 7.163 5 16 5s16-2.239 16-5v-6c0 2.761-7.163 5-16 5z"></path>
    <path d="M16 26c-8.837 0-16-2.239-16-5v6c0 2.761 7.163 5 16 5s16-2.239 16-5v-6c0 2.761-7.163 5-16 5z"></path>
    </symbol>
    <symbol id="icon-file-text2" viewBox="0 0 32 32">
    <path d="M28.681 7.159c-0.694-0.947-1.662-2.053-2.724-3.116s-2.169-2.030-3.116-2.724c-1.612-1.182-2.393-1.319-2.841-1.319h-15.5c-1.378 0-2.5 1.121-2.5 2.5v27c0 1.378 1.122 2.5 2.5 2.5h23c1.378 0 2.5-1.122 2.5-2.5v-19.5c0-0.448-0.137-1.23-1.319-2.841zM24.543 5.457c0.959 0.959 1.712 1.825 2.268 2.543h-4.811v-4.811c0.718 0.556 1.584 1.309 2.543 2.268zM28 29.5c0 0.271-0.229 0.5-0.5 0.5h-23c-0.271 0-0.5-0.229-0.5-0.5v-27c0-0.271 0.229-0.5 0.5-0.5 0 0 15.499-0 15.5 0v7c0 0.552 0.448 1 1 1h7v19.5z"></path>
    <path d="M23 26h-14c-0.552 0-1-0.448-1-1s0.448-1 1-1h14c0.552 0 1 0.448 1 1s-0.448 1-1 1z"></path>
    <path d="M23 22h-14c-0.552 0-1-0.448-1-1s0.448-1 1-1h14c0.552 0 1 0.448 1 1s-0.448 1-1 1z"></path>
    <path d="M23 18h-14c-0.552 0-1-0.448-1-1s0.448-1 1-1h14c0.552 0 1 0.448 1 1s-0.448 1-1 1z"></path>
    </symbol>
    </defs>
    </svg>
    <style>/* CSS stylesheet for displaying xarray objects in jupyterlab.
     *
     */

    :root {
      --xr-font-color0: var(--jp-content-font-color0, rgba(0, 0, 0, 1));
      --xr-font-color2: var(--jp-content-font-color2, rgba(0, 0, 0, 0.54));
      --xr-font-color3: var(--jp-content-font-color3, rgba(0, 0, 0, 0.38));
      --xr-border-color: var(--jp-border-color2, #e0e0e0);
      --xr-disabled-color: var(--jp-layout-color3, #bdbdbd);
      --xr-background-color: var(--jp-layout-color0, white);
      --xr-background-color-row-even: var(--jp-layout-color1, white);
      --xr-background-color-row-odd: var(--jp-layout-color2, #eeeeee);
    }

    html[theme="dark"],
    html[data-theme="dark"],
    body[data-theme="dark"],
    body.vscode-dark {
      --xr-font-color0: rgba(255, 255, 255, 1);
      --xr-font-color2: rgba(255, 255, 255, 0.54);
      --xr-font-color3: rgba(255, 255, 255, 0.38);
      --xr-border-color: #1f1f1f;
      --xr-disabled-color: #515151;
      --xr-background-color: #111111;
      --xr-background-color-row-even: #111111;
      --xr-background-color-row-odd: #313131;
    }

    .xr-wrap {
      display: block !important;
      min-width: 300px;
      max-width: 700px;
    }

    .xr-text-repr-fallback {
      /* fallback to plain text repr when CSS is not injected (untrusted notebook) */
      display: none;
    }

    .xr-header {
      padding-top: 6px;
      padding-bottom: 6px;
      margin-bottom: 4px;
      border-bottom: solid 1px var(--xr-border-color);
    }

    .xr-header > div,
    .xr-header > ul {
      display: inline;
      margin-top: 0;
      margin-bottom: 0;
    }

    .xr-obj-type,
    .xr-array-name {
      margin-left: 2px;
      margin-right: 10px;
    }

    .xr-obj-type {
      color: var(--xr-font-color2);
    }

    .xr-sections {
      padding-left: 0 !important;
      display: grid;
      grid-template-columns: 150px auto auto 1fr 0 20px 0 20px;
    }

    .xr-section-item {
      display: contents;
    }

    .xr-section-item input {
      display: inline-block;
      opacity: 0;
      height: 0;
    }

    .xr-section-item input + label {
      color: var(--xr-disabled-color);
    }

    .xr-section-item input:enabled + label {
      cursor: pointer;
      color: var(--xr-font-color2);
    }

    .xr-section-item input:focus + label {
      border: 2px solid var(--xr-font-color0);
    }

    .xr-section-item input:enabled + label:hover {
      color: var(--xr-font-color0);
    }

    .xr-section-summary {
      grid-column: 1;
      color: var(--xr-font-color2);
      font-weight: 500;
    }

    .xr-section-summary > span {
      display: inline-block;
      padding-left: 0.5em;
    }

    .xr-section-summary-in:disabled + label {
      color: var(--xr-font-color2);
    }

    .xr-section-summary-in + label:before {
      display: inline-block;
      content: "►";
      font-size: 11px;
      width: 15px;
      text-align: center;
    }

    .xr-section-summary-in:disabled + label:before {
      color: var(--xr-disabled-color);
    }

    .xr-section-summary-in:checked + label:before {
      content: "▼";
    }

    .xr-section-summary-in:checked + label > span {
      display: none;
    }

    .xr-section-summary,
    .xr-section-inline-details {
      padding-top: 4px;
      padding-bottom: 4px;
    }

    .xr-section-inline-details {
      grid-column: 2 / -1;
    }

    .xr-section-details {
      display: none;
      grid-column: 1 / -1;
      margin-bottom: 5px;
    }

    .xr-section-summary-in:checked ~ .xr-section-details {
      display: contents;
    }

    .xr-array-wrap {
      grid-column: 1 / -1;
      display: grid;
      grid-template-columns: 20px auto;
    }

    .xr-array-wrap > label {
      grid-column: 1;
      vertical-align: top;
    }

    .xr-preview {
      color: var(--xr-font-color3);
    }

    .xr-array-preview,
    .xr-array-data {
      padding: 0 5px !important;
      grid-column: 2;
    }

    .xr-array-data,
    .xr-array-in:checked ~ .xr-array-preview {
      display: none;
    }

    .xr-array-in:checked ~ .xr-array-data,
    .xr-array-preview {
      display: inline-block;
    }

    .xr-dim-list {
      display: inline-block !important;
      list-style: none;
      padding: 0 !important;
      margin: 0;
    }

    .xr-dim-list li {
      display: inline-block;
      padding: 0;
      margin: 0;
    }

    .xr-dim-list:before {
      content: "(";
    }

    .xr-dim-list:after {
      content: ")";
    }

    .xr-dim-list li:not(:last-child):after {
      content: ",";
      padding-right: 5px;
    }

    .xr-has-index {
      font-weight: bold;
    }

    .xr-var-list,
    .xr-var-item {
      display: contents;
    }

    .xr-var-item > div,
    .xr-var-item label,
    .xr-var-item > .xr-var-name span {
      background-color: var(--xr-background-color-row-even);
      margin-bottom: 0;
    }

    .xr-var-item > .xr-var-name:hover span {
      padding-right: 5px;
    }

    .xr-var-list > li:nth-child(odd) > div,
    .xr-var-list > li:nth-child(odd) > label,
    .xr-var-list > li:nth-child(odd) > .xr-var-name span {
      background-color: var(--xr-background-color-row-odd);
    }

    .xr-var-name {
      grid-column: 1;
    }

    .xr-var-dims {
      grid-column: 2;
    }

    .xr-var-dtype {
      grid-column: 3;
      text-align: right;
      color: var(--xr-font-color2);
    }

    .xr-var-preview {
      grid-column: 4;
    }

    .xr-index-preview {
      grid-column: 2 / 5;
      color: var(--xr-font-color2);
    }

    .xr-var-name,
    .xr-var-dims,
    .xr-var-dtype,
    .xr-preview,
    .xr-attrs dt {
      white-space: nowrap;
      overflow: hidden;
      text-overflow: ellipsis;
      padding-right: 10px;
    }

    .xr-var-name:hover,
    .xr-var-dims:hover,
    .xr-var-dtype:hover,
    .xr-attrs dt:hover {
      overflow: visible;
      width: auto;
      z-index: 1;
    }

    .xr-var-attrs,
    .xr-var-data,
    .xr-index-data {
      display: none;
      background-color: var(--xr-background-color) !important;
      padding-bottom: 5px !important;
    }

    .xr-var-attrs-in:checked ~ .xr-var-attrs,
    .xr-var-data-in:checked ~ .xr-var-data,
    .xr-index-data-in:checked ~ .xr-index-data {
      display: block;
    }

    .xr-var-data > table {
      float: right;
    }

    .xr-var-name span,
    .xr-var-data,
    .xr-index-name div,
    .xr-index-data,
    .xr-attrs {
      padding-left: 25px !important;
    }

    .xr-attrs,
    .xr-var-attrs,
    .xr-var-data,
    .xr-index-data {
      grid-column: 1 / -1;
    }

    dl.xr-attrs {
      padding: 0;
      margin: 0;
      display: grid;
      grid-template-columns: 125px auto;
    }

    .xr-attrs dt,
    .xr-attrs dd {
      padding: 0;
      margin: 0;
      float: left;
      padding-right: 10px;
      width: auto;
    }

    .xr-attrs dt {
      font-weight: normal;
      grid-column: 1;
    }

    .xr-attrs dt:hover span {
      display: inline-block;
      background: var(--xr-background-color);
      padding-right: 10px;
    }

    .xr-attrs dd {
      grid-column: 2;
      white-space: pre-wrap;
      word-break: break-all;
    }

    .xr-icon-database,
    .xr-icon-file-text2,
    .xr-no-icon {
      display: inline-block;
      vertical-align: middle;
      width: 1em;
      height: 1.5em !important;
      stroke-width: 0;
      stroke: currentColor;
      fill: currentColor;
    }
    </style><pre class='xr-text-repr-fallback'>&lt;xarray.Dataset&gt; Size: 1MB
    Dimensions:      (time: 18485, space: 2, keypoints: 6, individuals: 1)
    Coordinates:
      * time         (time) float64 148kB 0.0 0.03333 0.06667 ... 616.1 616.1 616.1
      * space        (space) &lt;U1 8B &#x27;x&#x27; &#x27;y&#x27;
      * keypoints    (keypoints) &lt;U9 216B &#x27;snout&#x27; &#x27;left_ear&#x27; ... &#x27;tail_end&#x27;
      * individuals  (individuals) &lt;U12 48B &#x27;individual_0&#x27;
    Data variables:
        position     (time, space, keypoints, individuals) float32 887kB nan ... ...
        confidence   (time, keypoints, individuals) float32 444kB nan nan ... 0.7607
    Attributes:
        source_software:  SLEAP
        ds_type:          poses
        fps:              30.0
        time_unit:        seconds
        source_file:      /home/runner/.movement/data/poses/SLEAP_single-mouse_EP...
        frame_path:       /home/runner/.movement/data/frames/single-mouse_EPM_fra...</pre><div class='xr-wrap' style='display:none'><div class='xr-header'><div class='xr-obj-type'>xarray.Dataset</div></div><ul class='xr-sections'><li class='xr-section-item'><input id='section-e71e3dd6-4ad2-4a5f-adb4-b3d0bb89eb9b' class='xr-section-summary-in' type='checkbox' disabled ><label for='section-e71e3dd6-4ad2-4a5f-adb4-b3d0bb89eb9b' class='xr-section-summary'  title='Expand/collapse section'>Dimensions:</label><div class='xr-section-inline-details'><ul class='xr-dim-list'><li><span class='xr-has-index'>time</span>: 18485</li><li><span class='xr-has-index'>space</span>: 2</li><li><span class='xr-has-index'>keypoints</span>: 6</li><li><span class='xr-has-index'>individuals</span>: 1</li></ul></div><div class='xr-section-details'></div></li><li class='xr-section-item'><input id='section-fab3e2e3-4a6b-47f1-9216-4ca392108c9f' class='xr-section-summary-in' type='checkbox'  checked><label for='section-fab3e2e3-4a6b-47f1-9216-4ca392108c9f' class='xr-section-summary' >Coordinates: <span>(4)</span></label><div class='xr-section-inline-details'></div><div class='xr-section-details'><ul class='xr-var-list'><li class='xr-var-item'><div class='xr-var-name'><span class='xr-has-index'>time</span></div><div class='xr-var-dims'>(time)</div><div class='xr-var-dtype'>float64</div><div class='xr-var-preview xr-preview'>0.0 0.03333 0.06667 ... 616.1 616.1</div><input id='attrs-314fc786-debb-4699-bcd6-5de3b464d397' class='xr-var-attrs-in' type='checkbox' disabled><label for='attrs-314fc786-debb-4699-bcd6-5de3b464d397' title='Show/Hide attributes'><svg class='icon xr-icon-file-text2'><use xlink:href='#icon-file-text2'></use></svg></label><input id='data-a8c9e737-9ab9-4f58-8d42-f200fe8a97f4' class='xr-var-data-in' type='checkbox'><label for='data-a8c9e737-9ab9-4f58-8d42-f200fe8a97f4' title='Show/Hide data repr'><svg class='icon xr-icon-database'><use xlink:href='#icon-database'></use></svg></label><div class='xr-var-attrs'><dl class='xr-attrs'></dl></div><div class='xr-var-data'><pre>array([0.000000e+00, 3.333333e-02, 6.666667e-02, ..., 6.160667e+02,
           6.161000e+02, 6.161333e+02], shape=(18485,))</pre></div></li><li class='xr-var-item'><div class='xr-var-name'><span class='xr-has-index'>space</span></div><div class='xr-var-dims'>(space)</div><div class='xr-var-dtype'>&lt;U1</div><div class='xr-var-preview xr-preview'>&#x27;x&#x27; &#x27;y&#x27;</div><input id='attrs-30db4ac6-16ed-4aa7-9b05-f89c84445f0a' class='xr-var-attrs-in' type='checkbox' disabled><label for='attrs-30db4ac6-16ed-4aa7-9b05-f89c84445f0a' title='Show/Hide attributes'><svg class='icon xr-icon-file-text2'><use xlink:href='#icon-file-text2'></use></svg></label><input id='data-f290cc3f-d7c7-49c4-a135-b9db974d9a2c' class='xr-var-data-in' type='checkbox'><label for='data-f290cc3f-d7c7-49c4-a135-b9db974d9a2c' title='Show/Hide data repr'><svg class='icon xr-icon-database'><use xlink:href='#icon-database'></use></svg></label><div class='xr-var-attrs'><dl class='xr-attrs'></dl></div><div class='xr-var-data'><pre>array([&#x27;x&#x27;, &#x27;y&#x27;], dtype=&#x27;&lt;U1&#x27;)</pre></div></li><li class='xr-var-item'><div class='xr-var-name'><span class='xr-has-index'>keypoints</span></div><div class='xr-var-dims'>(keypoints)</div><div class='xr-var-dtype'>&lt;U9</div><div class='xr-var-preview xr-preview'>&#x27;snout&#x27; &#x27;left_ear&#x27; ... &#x27;tail_end&#x27;</div><input id='attrs-c764d270-5c56-44e9-9d7a-2256be685b33' class='xr-var-attrs-in' type='checkbox' disabled><label for='attrs-c764d270-5c56-44e9-9d7a-2256be685b33' title='Show/Hide attributes'><svg class='icon xr-icon-file-text2'><use xlink:href='#icon-file-text2'></use></svg></label><input id='data-a9cbda8a-8c80-4538-bb50-0e5722ffae4f' class='xr-var-data-in' type='checkbox'><label for='data-a9cbda8a-8c80-4538-bb50-0e5722ffae4f' title='Show/Hide data repr'><svg class='icon xr-icon-database'><use xlink:href='#icon-database'></use></svg></label><div class='xr-var-attrs'><dl class='xr-attrs'></dl></div><div class='xr-var-data'><pre>array([&#x27;snout&#x27;, &#x27;left_ear&#x27;, &#x27;right_ear&#x27;, &#x27;centre&#x27;, &#x27;tail_base&#x27;, &#x27;tail_end&#x27;],
          dtype=&#x27;&lt;U9&#x27;)</pre></div></li><li class='xr-var-item'><div class='xr-var-name'><span class='xr-has-index'>individuals</span></div><div class='xr-var-dims'>(individuals)</div><div class='xr-var-dtype'>&lt;U12</div><div class='xr-var-preview xr-preview'>&#x27;individual_0&#x27;</div><input id='attrs-4f27a866-5b95-4721-92e1-63bfc5a0ea41' class='xr-var-attrs-in' type='checkbox' disabled><label for='attrs-4f27a866-5b95-4721-92e1-63bfc5a0ea41' title='Show/Hide attributes'><svg class='icon xr-icon-file-text2'><use xlink:href='#icon-file-text2'></use></svg></label><input id='data-e09fe1d8-9ce4-41c6-954f-e1239c7c580d' class='xr-var-data-in' type='checkbox'><label for='data-e09fe1d8-9ce4-41c6-954f-e1239c7c580d' title='Show/Hide data repr'><svg class='icon xr-icon-database'><use xlink:href='#icon-database'></use></svg></label><div class='xr-var-attrs'><dl class='xr-attrs'></dl></div><div class='xr-var-data'><pre>array([&#x27;individual_0&#x27;], dtype=&#x27;&lt;U12&#x27;)</pre></div></li></ul></div></li><li class='xr-section-item'><input id='section-4d6355a6-57bd-4a83-ba82-2a1b13e89a69' class='xr-section-summary-in' type='checkbox'  checked><label for='section-4d6355a6-57bd-4a83-ba82-2a1b13e89a69' class='xr-section-summary' >Data variables: <span>(2)</span></label><div class='xr-section-inline-details'></div><div class='xr-section-details'><ul class='xr-var-list'><li class='xr-var-item'><div class='xr-var-name'><span>position</span></div><div class='xr-var-dims'>(time, space, keypoints, individuals)</div><div class='xr-var-dtype'>float32</div><div class='xr-var-preview xr-preview'>nan nan nan ... 440.0 384.0 476.3</div><input id='attrs-a98447b0-83cd-49e3-b27d-88b7f20d7ef8' class='xr-var-attrs-in' type='checkbox' ><label for='attrs-a98447b0-83cd-49e3-b27d-88b7f20d7ef8' title='Show/Hide attributes'><svg class='icon xr-icon-file-text2'><use xlink:href='#icon-file-text2'></use></svg></label><input id='data-ebc27b50-27bf-42f0-b94a-2e9de1731a25' class='xr-var-data-in' type='checkbox'><label for='data-ebc27b50-27bf-42f0-b94a-2e9de1731a25' title='Show/Hide data repr'><svg class='icon xr-icon-database'><use xlink:href='#icon-database'></use></svg></label><div class='xr-var-attrs'><dl class='xr-attrs'><dt><span>log :</span></dt><dd>[{&#x27;operation&#x27;: &#x27;rolling_filter&#x27;, &#x27;datetime&#x27;: &#x27;2025-05-14 09:39:04.757848&#x27;, &#x27;arg_1&#x27;: 3, &#x27;statistic&#x27;: &#x27;median&#x27;, &#x27;print_report&#x27;: True}]</dd></dl></div><div class='xr-var-data'><pre>array([[[[      nan],
             [      nan],
             [      nan],
             [      nan],
             [      nan],
             [      nan]],

            [[      nan],
             [      nan],
             [      nan],
             [      nan],
             [      nan],
             [      nan]]],


           [[[      nan],
             [      nan],
             [      nan],
             [      nan],
             [      nan],
    ...
             [484.86316],
             [492.0457 ],
             [439.9774 ],
             [384.10602],
             [476.33466]]],


           [[[688.18134],
             [692.3218 ],
             [668.4878 ],
             [667.9094 ],
             [636.8362 ],
             [588.56854]],

            [[507.72455],
             [484.5658 ],
             [492.0457 ],
             [439.9774 ],
             [384.02936],
             [476.33466]]]], shape=(18485, 2, 6, 1), dtype=float32)</pre></div></li><li class='xr-var-item'><div class='xr-var-name'><span>confidence</span></div><div class='xr-var-dims'>(time, keypoints, individuals)</div><div class='xr-var-dtype'>float32</div><div class='xr-var-preview xr-preview'>nan nan nan ... 0.9336 0.7607</div><input id='attrs-77d7cc1b-3a33-410d-b877-11b033f0b067' class='xr-var-attrs-in' type='checkbox' disabled><label for='attrs-77d7cc1b-3a33-410d-b877-11b033f0b067' title='Show/Hide attributes'><svg class='icon xr-icon-file-text2'><use xlink:href='#icon-file-text2'></use></svg></label><input id='data-33b63287-ab57-4643-b3f5-a7f5d045fb11' class='xr-var-data-in' type='checkbox'><label for='data-33b63287-ab57-4643-b3f5-a7f5d045fb11' title='Show/Hide data repr'><svg class='icon xr-icon-database'><use xlink:href='#icon-database'></use></svg></label><div class='xr-var-attrs'><dl class='xr-attrs'></dl></div><div class='xr-var-data'><pre>array([[[       nan],
            [       nan],
            [       nan],
            [       nan],
            [       nan],
            [       nan]],

           [[       nan],
            [       nan],
            [       nan],
            [       nan],
            [       nan],
            [       nan]],

           [[       nan],
            [       nan],
            [       nan],
            [       nan],
            [       nan],
            [       nan]],
    ...
           [[0.9317396 ],
            [1.0026728 ],
            [1.025079  ],
            [0.92725545],
            [0.95202184],
            [0.7779419 ]],

           [[0.9193515 ],
            [1.0136327 ],
            [1.0336665 ],
            [0.93108493],
            [0.94561106],
            [0.7662804 ]],

           [[0.93820494],
            [1.0224991 ],
            [1.0452943 ],
            [0.9363993 ],
            [0.9335798 ],
            [0.76068705]]], shape=(18485, 6, 1), dtype=float32)</pre></div></li></ul></div></li><li class='xr-section-item'><input id='section-e03565be-fbbf-402c-a97c-d6c6561e8b86' class='xr-section-summary-in' type='checkbox'  ><label for='section-e03565be-fbbf-402c-a97c-d6c6561e8b86' class='xr-section-summary' >Indexes: <span>(4)</span></label><div class='xr-section-inline-details'></div><div class='xr-section-details'><ul class='xr-var-list'><li class='xr-var-item'><div class='xr-index-name'><div>time</div></div><div class='xr-index-preview'>PandasIndex</div><input type='checkbox' disabled/><label></label><input id='index-b9337338-4a4d-448d-baa3-443e9b3463f7' class='xr-index-data-in' type='checkbox'/><label for='index-b9337338-4a4d-448d-baa3-443e9b3463f7' title='Show/Hide index repr'><svg class='icon xr-icon-database'><use xlink:href='#icon-database'></use></svg></label><div class='xr-index-data'><pre>PandasIndex(Index([                0.0, 0.03333333333333333, 0.06666666666666667,
                           0.1, 0.13333333333333333, 0.16666666666666666,
                           0.2, 0.23333333333333334, 0.26666666666666666,
                           0.3,
           ...
             615.8333333333334,   615.8666666666667,               615.9,
             615.9333333333333,   615.9666666666667,               616.0,
             616.0333333333333,   616.0666666666667,               616.1,
             616.1333333333333],
          dtype=&#x27;float64&#x27;, name=&#x27;time&#x27;, length=18485))</pre></div></li><li class='xr-var-item'><div class='xr-index-name'><div>space</div></div><div class='xr-index-preview'>PandasIndex</div><input type='checkbox' disabled/><label></label><input id='index-8aa0a46c-afc9-4bd2-ba63-2d030de6ae3d' class='xr-index-data-in' type='checkbox'/><label for='index-8aa0a46c-afc9-4bd2-ba63-2d030de6ae3d' title='Show/Hide index repr'><svg class='icon xr-icon-database'><use xlink:href='#icon-database'></use></svg></label><div class='xr-index-data'><pre>PandasIndex(Index([&#x27;x&#x27;, &#x27;y&#x27;], dtype=&#x27;object&#x27;, name=&#x27;space&#x27;))</pre></div></li><li class='xr-var-item'><div class='xr-index-name'><div>keypoints</div></div><div class='xr-index-preview'>PandasIndex</div><input type='checkbox' disabled/><label></label><input id='index-8ec2e98c-6878-4fd5-9fa9-f713ef86f53e' class='xr-index-data-in' type='checkbox'/><label for='index-8ec2e98c-6878-4fd5-9fa9-f713ef86f53e' title='Show/Hide index repr'><svg class='icon xr-icon-database'><use xlink:href='#icon-database'></use></svg></label><div class='xr-index-data'><pre>PandasIndex(Index([&#x27;snout&#x27;, &#x27;left_ear&#x27;, &#x27;right_ear&#x27;, &#x27;centre&#x27;, &#x27;tail_base&#x27;, &#x27;tail_end&#x27;], dtype=&#x27;object&#x27;, name=&#x27;keypoints&#x27;))</pre></div></li><li class='xr-var-item'><div class='xr-index-name'><div>individuals</div></div><div class='xr-index-preview'>PandasIndex</div><input type='checkbox' disabled/><label></label><input id='index-edcd12bd-5d6e-4342-9b58-7703b7000441' class='xr-index-data-in' type='checkbox'/><label for='index-edcd12bd-5d6e-4342-9b58-7703b7000441' title='Show/Hide index repr'><svg class='icon xr-icon-database'><use xlink:href='#icon-database'></use></svg></label><div class='xr-index-data'><pre>PandasIndex(Index([&#x27;individual_0&#x27;], dtype=&#x27;object&#x27;, name=&#x27;individuals&#x27;))</pre></div></li></ul></div></li><li class='xr-section-item'><input id='section-48407e44-fa21-43b4-91e1-3d7a36aa91c4' class='xr-section-summary-in' type='checkbox'  checked><label for='section-48407e44-fa21-43b4-91e1-3d7a36aa91c4' class='xr-section-summary' >Attributes: <span>(6)</span></label><div class='xr-section-inline-details'></div><div class='xr-section-details'><dl class='xr-attrs'><dt><span>source_software :</span></dt><dd>SLEAP</dd><dt><span>ds_type :</span></dt><dd>poses</dd><dt><span>fps :</span></dt><dd>30.0</dd><dt><span>time_unit :</span></dt><dd>seconds</dd><dt><span>source_file :</span></dt><dd>/home/runner/.movement/data/poses/SLEAP_single-mouse_EPM.analysis.h5</dd><dt><span>frame_path :</span></dt><dd>/home/runner/.movement/data/frames/single-mouse_EPM_frame-20sec.png</dd></dl></div></li></ul></div></div>
    </div>
    <br />
    <br />

.. GENERATED FROM PYTHON SOURCE LINES 191-202

The report informs us that the raw data contains NaN values, most of which
occur at the ``snout`` and ``tail_end`` keypoints. After filtering, the
number of NaNs has increased. This is because the default behaviour of the
rolling filter is to propagate NaN values, i.e. if any value in the rolling
window is NaN, the output will also be NaN.

To modify this behaviour, you can set the value of the ``min_periods``
parameter to an integer value. This parameter determines the minimum number
of non-NaN values required in the window for the output to be non-NaN.
For example, setting ``min_periods=2`` means that two non-NaN values in the
window are sufficient for the median to be calculated. Let's try this.

.. GENERATED FROM PYTHON SOURCE LINES 202-215

.. code-block:: Python


    ds_mouse_smooth.update(
        {
            "position": rolling_filter(
                ds_mouse.position,
                window,
                min_periods=2,
                statistic="median",
                print_report=True,
            )
        }
    )





.. rst-class:: sphx-glr-script-out

 .. code-block:: none


    Missing points (marked as NaN) in input
            Individual: individual_0
                    snout: 4494/18485 (24.3%)
                    left_ear: 513/18485 (2.8%)
                    right_ear: 533/18485 (2.9%)
                    centre: 490/18485 (2.7%)
                    tail_base: 704/18485 (3.8%)
                    tail_end: 2496/18485 (13.5%)

    Missing points (marked as NaN) in output
            Individual: individual_0
                    snout: 4455/18485 (24.1%)
                    left_ear: 487/18485 (2.6%)
                    right_ear: 507/18485 (2.7%)
                    centre: 465/18485 (2.5%)
                    tail_base: 673/18485 (3.6%)
                    tail_end: 2428/18485 (13.1%)


.. raw:: html

    <div class="output_subarea output_html rendered_html output_result">
    <div><svg style="position: absolute; width: 0; height: 0; overflow: hidden">
    <defs>
    <symbol id="icon-database" viewBox="0 0 32 32">
    <path d="M16 0c-8.837 0-16 2.239-16 5v4c0 2.761 7.163 5 16 5s16-2.239 16-5v-4c0-2.761-7.163-5-16-5z"></path>
    <path d="M16 17c-8.837 0-16-2.239-16-5v6c0 2.761 7.163 5 16 5s16-2.239 16-5v-6c0 2.761-7.163 5-16 5z"></path>
    <path d="M16 26c-8.837 0-16-2.239-16-5v6c0 2.761 7.163 5 16 5s16-2.239 16-5v-6c0 2.761-7.163 5-16 5z"></path>
    </symbol>
    <symbol id="icon-file-text2" viewBox="0 0 32 32">
    <path d="M28.681 7.159c-0.694-0.947-1.662-2.053-2.724-3.116s-2.169-2.030-3.116-2.724c-1.612-1.182-2.393-1.319-2.841-1.319h-15.5c-1.378 0-2.5 1.121-2.5 2.5v27c0 1.378 1.122 2.5 2.5 2.5h23c1.378 0 2.5-1.122 2.5-2.5v-19.5c0-0.448-0.137-1.23-1.319-2.841zM24.543 5.457c0.959 0.959 1.712 1.825 2.268 2.543h-4.811v-4.811c0.718 0.556 1.584 1.309 2.543 2.268zM28 29.5c0 0.271-0.229 0.5-0.5 0.5h-23c-0.271 0-0.5-0.229-0.5-0.5v-27c0-0.271 0.229-0.5 0.5-0.5 0 0 15.499-0 15.5 0v7c0 0.552 0.448 1 1 1h7v19.5z"></path>
    <path d="M23 26h-14c-0.552 0-1-0.448-1-1s0.448-1 1-1h14c0.552 0 1 0.448 1 1s-0.448 1-1 1z"></path>
    <path d="M23 22h-14c-0.552 0-1-0.448-1-1s0.448-1 1-1h14c0.552 0 1 0.448 1 1s-0.448 1-1 1z"></path>
    <path d="M23 18h-14c-0.552 0-1-0.448-1-1s0.448-1 1-1h14c0.552 0 1 0.448 1 1s-0.448 1-1 1z"></path>
    </symbol>
    </defs>
    </svg>
    <style>/* CSS stylesheet for displaying xarray objects in jupyterlab.
     *
     */

    :root {
      --xr-font-color0: var(--jp-content-font-color0, rgba(0, 0, 0, 1));
      --xr-font-color2: var(--jp-content-font-color2, rgba(0, 0, 0, 0.54));
      --xr-font-color3: var(--jp-content-font-color3, rgba(0, 0, 0, 0.38));
      --xr-border-color: var(--jp-border-color2, #e0e0e0);
      --xr-disabled-color: var(--jp-layout-color3, #bdbdbd);
      --xr-background-color: var(--jp-layout-color0, white);
      --xr-background-color-row-even: var(--jp-layout-color1, white);
      --xr-background-color-row-odd: var(--jp-layout-color2, #eeeeee);
    }

    html[theme="dark"],
    html[data-theme="dark"],
    body[data-theme="dark"],
    body.vscode-dark {
      --xr-font-color0: rgba(255, 255, 255, 1);
      --xr-font-color2: rgba(255, 255, 255, 0.54);
      --xr-font-color3: rgba(255, 255, 255, 0.38);
      --xr-border-color: #1f1f1f;
      --xr-disabled-color: #515151;
      --xr-background-color: #111111;
      --xr-background-color-row-even: #111111;
      --xr-background-color-row-odd: #313131;
    }

    .xr-wrap {
      display: block !important;
      min-width: 300px;
      max-width: 700px;
    }

    .xr-text-repr-fallback {
      /* fallback to plain text repr when CSS is not injected (untrusted notebook) */
      display: none;
    }

    .xr-header {
      padding-top: 6px;
      padding-bottom: 6px;
      margin-bottom: 4px;
      border-bottom: solid 1px var(--xr-border-color);
    }

    .xr-header > div,
    .xr-header > ul {
      display: inline;
      margin-top: 0;
      margin-bottom: 0;
    }

    .xr-obj-type,
    .xr-array-name {
      margin-left: 2px;
      margin-right: 10px;
    }

    .xr-obj-type {
      color: var(--xr-font-color2);
    }

    .xr-sections {
      padding-left: 0 !important;
      display: grid;
      grid-template-columns: 150px auto auto 1fr 0 20px 0 20px;
    }

    .xr-section-item {
      display: contents;
    }

    .xr-section-item input {
      display: inline-block;
      opacity: 0;
      height: 0;
    }

    .xr-section-item input + label {
      color: var(--xr-disabled-color);
    }

    .xr-section-item input:enabled + label {
      cursor: pointer;
      color: var(--xr-font-color2);
    }

    .xr-section-item input:focus + label {
      border: 2px solid var(--xr-font-color0);
    }

    .xr-section-item input:enabled + label:hover {
      color: var(--xr-font-color0);
    }

    .xr-section-summary {
      grid-column: 1;
      color: var(--xr-font-color2);
      font-weight: 500;
    }

    .xr-section-summary > span {
      display: inline-block;
      padding-left: 0.5em;
    }

    .xr-section-summary-in:disabled + label {
      color: var(--xr-font-color2);
    }

    .xr-section-summary-in + label:before {
      display: inline-block;
      content: "►";
      font-size: 11px;
      width: 15px;
      text-align: center;
    }

    .xr-section-summary-in:disabled + label:before {
      color: var(--xr-disabled-color);
    }

    .xr-section-summary-in:checked + label:before {
      content: "▼";
    }

    .xr-section-summary-in:checked + label > span {
      display: none;
    }

    .xr-section-summary,
    .xr-section-inline-details {
      padding-top: 4px;
      padding-bottom: 4px;
    }

    .xr-section-inline-details {
      grid-column: 2 / -1;
    }

    .xr-section-details {
      display: none;
      grid-column: 1 / -1;
      margin-bottom: 5px;
    }

    .xr-section-summary-in:checked ~ .xr-section-details {
      display: contents;
    }

    .xr-array-wrap {
      grid-column: 1 / -1;
      display: grid;
      grid-template-columns: 20px auto;
    }

    .xr-array-wrap > label {
      grid-column: 1;
      vertical-align: top;
    }

    .xr-preview {
      color: var(--xr-font-color3);
    }

    .xr-array-preview,
    .xr-array-data {
      padding: 0 5px !important;
      grid-column: 2;
    }

    .xr-array-data,
    .xr-array-in:checked ~ .xr-array-preview {
      display: none;
    }

    .xr-array-in:checked ~ .xr-array-data,
    .xr-array-preview {
      display: inline-block;
    }

    .xr-dim-list {
      display: inline-block !important;
      list-style: none;
      padding: 0 !important;
      margin: 0;
    }

    .xr-dim-list li {
      display: inline-block;
      padding: 0;
      margin: 0;
    }

    .xr-dim-list:before {
      content: "(";
    }

    .xr-dim-list:after {
      content: ")";
    }

    .xr-dim-list li:not(:last-child):after {
      content: ",";
      padding-right: 5px;
    }

    .xr-has-index {
      font-weight: bold;
    }

    .xr-var-list,
    .xr-var-item {
      display: contents;
    }

    .xr-var-item > div,
    .xr-var-item label,
    .xr-var-item > .xr-var-name span {
      background-color: var(--xr-background-color-row-even);
      margin-bottom: 0;
    }

    .xr-var-item > .xr-var-name:hover span {
      padding-right: 5px;
    }

    .xr-var-list > li:nth-child(odd) > div,
    .xr-var-list > li:nth-child(odd) > label,
    .xr-var-list > li:nth-child(odd) > .xr-var-name span {
      background-color: var(--xr-background-color-row-odd);
    }

    .xr-var-name {
      grid-column: 1;
    }

    .xr-var-dims {
      grid-column: 2;
    }

    .xr-var-dtype {
      grid-column: 3;
      text-align: right;
      color: var(--xr-font-color2);
    }

    .xr-var-preview {
      grid-column: 4;
    }

    .xr-index-preview {
      grid-column: 2 / 5;
      color: var(--xr-font-color2);
    }

    .xr-var-name,
    .xr-var-dims,
    .xr-var-dtype,
    .xr-preview,
    .xr-attrs dt {
      white-space: nowrap;
      overflow: hidden;
      text-overflow: ellipsis;
      padding-right: 10px;
    }

    .xr-var-name:hover,
    .xr-var-dims:hover,
    .xr-var-dtype:hover,
    .xr-attrs dt:hover {
      overflow: visible;
      width: auto;
      z-index: 1;
    }

    .xr-var-attrs,
    .xr-var-data,
    .xr-index-data {
      display: none;
      background-color: var(--xr-background-color) !important;
      padding-bottom: 5px !important;
    }

    .xr-var-attrs-in:checked ~ .xr-var-attrs,
    .xr-var-data-in:checked ~ .xr-var-data,
    .xr-index-data-in:checked ~ .xr-index-data {
      display: block;
    }

    .xr-var-data > table {
      float: right;
    }

    .xr-var-name span,
    .xr-var-data,
    .xr-index-name div,
    .xr-index-data,
    .xr-attrs {
      padding-left: 25px !important;
    }

    .xr-attrs,
    .xr-var-attrs,
    .xr-var-data,
    .xr-index-data {
      grid-column: 1 / -1;
    }

    dl.xr-attrs {
      padding: 0;
      margin: 0;
      display: grid;
      grid-template-columns: 125px auto;
    }

    .xr-attrs dt,
    .xr-attrs dd {
      padding: 0;
      margin: 0;
      float: left;
      padding-right: 10px;
      width: auto;
    }

    .xr-attrs dt {
      font-weight: normal;
      grid-column: 1;
    }

    .xr-attrs dt:hover span {
      display: inline-block;
      background: var(--xr-background-color);
      padding-right: 10px;
    }

    .xr-attrs dd {
      grid-column: 2;
      white-space: pre-wrap;
      word-break: break-all;
    }

    .xr-icon-database,
    .xr-icon-file-text2,
    .xr-no-icon {
      display: inline-block;
      vertical-align: middle;
      width: 1em;
      height: 1.5em !important;
      stroke-width: 0;
      stroke: currentColor;
      fill: currentColor;
    }
    </style><pre class='xr-text-repr-fallback'>&lt;xarray.Dataset&gt; Size: 1MB
    Dimensions:      (time: 18485, space: 2, keypoints: 6, individuals: 1)
    Coordinates:
      * time         (time) float64 148kB 0.0 0.03333 0.06667 ... 616.1 616.1 616.1
      * space        (space) &lt;U1 8B &#x27;x&#x27; &#x27;y&#x27;
      * keypoints    (keypoints) &lt;U9 216B &#x27;snout&#x27; &#x27;left_ear&#x27; ... &#x27;tail_end&#x27;
      * individuals  (individuals) &lt;U12 48B &#x27;individual_0&#x27;
    Data variables:
        position     (time, space, keypoints, individuals) float32 887kB nan ... ...
        confidence   (time, keypoints, individuals) float32 444kB nan nan ... 0.7607
    Attributes:
        source_software:  SLEAP
        ds_type:          poses
        fps:              30.0
        time_unit:        seconds
        source_file:      /home/runner/.movement/data/poses/SLEAP_single-mouse_EP...
        frame_path:       /home/runner/.movement/data/frames/single-mouse_EPM_fra...</pre><div class='xr-wrap' style='display:none'><div class='xr-header'><div class='xr-obj-type'>xarray.Dataset</div></div><ul class='xr-sections'><li class='xr-section-item'><input id='section-430ff14d-33c2-4148-a544-36e80937865e' class='xr-section-summary-in' type='checkbox' disabled ><label for='section-430ff14d-33c2-4148-a544-36e80937865e' class='xr-section-summary'  title='Expand/collapse section'>Dimensions:</label><div class='xr-section-inline-details'><ul class='xr-dim-list'><li><span class='xr-has-index'>time</span>: 18485</li><li><span class='xr-has-index'>space</span>: 2</li><li><span class='xr-has-index'>keypoints</span>: 6</li><li><span class='xr-has-index'>individuals</span>: 1</li></ul></div><div class='xr-section-details'></div></li><li class='xr-section-item'><input id='section-b02fb85f-8a2b-4a1f-8096-3d7290c055d6' class='xr-section-summary-in' type='checkbox'  checked><label for='section-b02fb85f-8a2b-4a1f-8096-3d7290c055d6' class='xr-section-summary' >Coordinates: <span>(4)</span></label><div class='xr-section-inline-details'></div><div class='xr-section-details'><ul class='xr-var-list'><li class='xr-var-item'><div class='xr-var-name'><span class='xr-has-index'>time</span></div><div class='xr-var-dims'>(time)</div><div class='xr-var-dtype'>float64</div><div class='xr-var-preview xr-preview'>0.0 0.03333 0.06667 ... 616.1 616.1</div><input id='attrs-c6211b85-a4b6-4f27-9a31-9662ce299ed4' class='xr-var-attrs-in' type='checkbox' disabled><label for='attrs-c6211b85-a4b6-4f27-9a31-9662ce299ed4' title='Show/Hide attributes'><svg class='icon xr-icon-file-text2'><use xlink:href='#icon-file-text2'></use></svg></label><input id='data-b273aad5-9eb4-4f15-b17f-a2123d4f4521' class='xr-var-data-in' type='checkbox'><label for='data-b273aad5-9eb4-4f15-b17f-a2123d4f4521' title='Show/Hide data repr'><svg class='icon xr-icon-database'><use xlink:href='#icon-database'></use></svg></label><div class='xr-var-attrs'><dl class='xr-attrs'></dl></div><div class='xr-var-data'><pre>array([0.000000e+00, 3.333333e-02, 6.666667e-02, ..., 6.160667e+02,
           6.161000e+02, 6.161333e+02], shape=(18485,))</pre></div></li><li class='xr-var-item'><div class='xr-var-name'><span class='xr-has-index'>space</span></div><div class='xr-var-dims'>(space)</div><div class='xr-var-dtype'>&lt;U1</div><div class='xr-var-preview xr-preview'>&#x27;x&#x27; &#x27;y&#x27;</div><input id='attrs-a2bb54b9-e258-47d7-8fc7-b4ca3b96c301' class='xr-var-attrs-in' type='checkbox' disabled><label for='attrs-a2bb54b9-e258-47d7-8fc7-b4ca3b96c301' title='Show/Hide attributes'><svg class='icon xr-icon-file-text2'><use xlink:href='#icon-file-text2'></use></svg></label><input id='data-2e36e2c6-eb30-49d7-8c0d-9107bd7845da' class='xr-var-data-in' type='checkbox'><label for='data-2e36e2c6-eb30-49d7-8c0d-9107bd7845da' title='Show/Hide data repr'><svg class='icon xr-icon-database'><use xlink:href='#icon-database'></use></svg></label><div class='xr-var-attrs'><dl class='xr-attrs'></dl></div><div class='xr-var-data'><pre>array([&#x27;x&#x27;, &#x27;y&#x27;], dtype=&#x27;&lt;U1&#x27;)</pre></div></li><li class='xr-var-item'><div class='xr-var-name'><span class='xr-has-index'>keypoints</span></div><div class='xr-var-dims'>(keypoints)</div><div class='xr-var-dtype'>&lt;U9</div><div class='xr-var-preview xr-preview'>&#x27;snout&#x27; &#x27;left_ear&#x27; ... &#x27;tail_end&#x27;</div><input id='attrs-5590e907-6a1e-4fbf-b0ff-e1098be0e822' class='xr-var-attrs-in' type='checkbox' disabled><label for='attrs-5590e907-6a1e-4fbf-b0ff-e1098be0e822' title='Show/Hide attributes'><svg class='icon xr-icon-file-text2'><use xlink:href='#icon-file-text2'></use></svg></label><input id='data-d5e40929-374b-4b9f-b8f7-b819c3afd605' class='xr-var-data-in' type='checkbox'><label for='data-d5e40929-374b-4b9f-b8f7-b819c3afd605' title='Show/Hide data repr'><svg class='icon xr-icon-database'><use xlink:href='#icon-database'></use></svg></label><div class='xr-var-attrs'><dl class='xr-attrs'></dl></div><div class='xr-var-data'><pre>array([&#x27;snout&#x27;, &#x27;left_ear&#x27;, &#x27;right_ear&#x27;, &#x27;centre&#x27;, &#x27;tail_base&#x27;, &#x27;tail_end&#x27;],
          dtype=&#x27;&lt;U9&#x27;)</pre></div></li><li class='xr-var-item'><div class='xr-var-name'><span class='xr-has-index'>individuals</span></div><div class='xr-var-dims'>(individuals)</div><div class='xr-var-dtype'>&lt;U12</div><div class='xr-var-preview xr-preview'>&#x27;individual_0&#x27;</div><input id='attrs-938aaea1-4cb0-40bc-b855-e84f89aee919' class='xr-var-attrs-in' type='checkbox' disabled><label for='attrs-938aaea1-4cb0-40bc-b855-e84f89aee919' title='Show/Hide attributes'><svg class='icon xr-icon-file-text2'><use xlink:href='#icon-file-text2'></use></svg></label><input id='data-2d96dc58-d01b-416b-beaa-7a44daa6b894' class='xr-var-data-in' type='checkbox'><label for='data-2d96dc58-d01b-416b-beaa-7a44daa6b894' title='Show/Hide data repr'><svg class='icon xr-icon-database'><use xlink:href='#icon-database'></use></svg></label><div class='xr-var-attrs'><dl class='xr-attrs'></dl></div><div class='xr-var-data'><pre>array([&#x27;individual_0&#x27;], dtype=&#x27;&lt;U12&#x27;)</pre></div></li></ul></div></li><li class='xr-section-item'><input id='section-6815165e-e8b2-4ae7-ac3d-75162d5e11f6' class='xr-section-summary-in' type='checkbox'  checked><label for='section-6815165e-e8b2-4ae7-ac3d-75162d5e11f6' class='xr-section-summary' >Data variables: <span>(2)</span></label><div class='xr-section-inline-details'></div><div class='xr-section-details'><ul class='xr-var-list'><li class='xr-var-item'><div class='xr-var-name'><span>position</span></div><div class='xr-var-dims'>(time, space, keypoints, individuals)</div><div class='xr-var-dtype'>float32</div><div class='xr-var-preview xr-preview'>nan nan nan ... 440.0 384.0 476.3</div><input id='attrs-99140d57-2d9f-4c89-8dd8-2ff63adb9a58' class='xr-var-attrs-in' type='checkbox' ><label for='attrs-99140d57-2d9f-4c89-8dd8-2ff63adb9a58' title='Show/Hide attributes'><svg class='icon xr-icon-file-text2'><use xlink:href='#icon-file-text2'></use></svg></label><input id='data-60530cb3-a00c-4fcd-8a13-398b958378fe' class='xr-var-data-in' type='checkbox'><label for='data-60530cb3-a00c-4fcd-8a13-398b958378fe' title='Show/Hide data repr'><svg class='icon xr-icon-database'><use xlink:href='#icon-database'></use></svg></label><div class='xr-var-attrs'><dl class='xr-attrs'><dt><span>log :</span></dt><dd>[{&#x27;operation&#x27;: &#x27;rolling_filter&#x27;, &#x27;datetime&#x27;: &#x27;2025-05-14 09:39:04.780530&#x27;, &#x27;arg_1&#x27;: 3, &#x27;min_periods&#x27;: 2, &#x27;statistic&#x27;: &#x27;median&#x27;, &#x27;print_report&#x27;: True}]</dd></dl></div><div class='xr-var-data'><pre>array([[[[      nan],
             [      nan],
             [      nan],
             [      nan],
             [      nan],
             [      nan]],

            [[      nan],
             [      nan],
             [      nan],
             [      nan],
             [      nan],
             [      nan]]],


           [[[      nan],
             [      nan],
             [      nan],
             [      nan],
             [      nan],
    ...
             [484.86316],
             [492.0457 ],
             [439.9774 ],
             [384.10602],
             [476.33466]]],


           [[[688.18134],
             [692.3218 ],
             [668.4878 ],
             [667.9094 ],
             [636.8362 ],
             [588.56854]],

            [[507.72455],
             [484.5658 ],
             [492.0457 ],
             [439.9774 ],
             [384.02936],
             [476.33466]]]], shape=(18485, 2, 6, 1), dtype=float32)</pre></div></li><li class='xr-var-item'><div class='xr-var-name'><span>confidence</span></div><div class='xr-var-dims'>(time, keypoints, individuals)</div><div class='xr-var-dtype'>float32</div><div class='xr-var-preview xr-preview'>nan nan nan ... 0.9336 0.7607</div><input id='attrs-ceef9836-265d-47a2-b30b-8ae0d6342632' class='xr-var-attrs-in' type='checkbox' disabled><label for='attrs-ceef9836-265d-47a2-b30b-8ae0d6342632' title='Show/Hide attributes'><svg class='icon xr-icon-file-text2'><use xlink:href='#icon-file-text2'></use></svg></label><input id='data-fa1c03e4-0aed-4764-9a80-3a1da4723d84' class='xr-var-data-in' type='checkbox'><label for='data-fa1c03e4-0aed-4764-9a80-3a1da4723d84' title='Show/Hide data repr'><svg class='icon xr-icon-database'><use xlink:href='#icon-database'></use></svg></label><div class='xr-var-attrs'><dl class='xr-attrs'></dl></div><div class='xr-var-data'><pre>array([[[       nan],
            [       nan],
            [       nan],
            [       nan],
            [       nan],
            [       nan]],

           [[       nan],
            [       nan],
            [       nan],
            [       nan],
            [       nan],
            [       nan]],

           [[       nan],
            [       nan],
            [       nan],
            [       nan],
            [       nan],
            [       nan]],
    ...
           [[0.9317396 ],
            [1.0026728 ],
            [1.025079  ],
            [0.92725545],
            [0.95202184],
            [0.7779419 ]],

           [[0.9193515 ],
            [1.0136327 ],
            [1.0336665 ],
            [0.93108493],
            [0.94561106],
            [0.7662804 ]],

           [[0.93820494],
            [1.0224991 ],
            [1.0452943 ],
            [0.9363993 ],
            [0.9335798 ],
            [0.76068705]]], shape=(18485, 6, 1), dtype=float32)</pre></div></li></ul></div></li><li class='xr-section-item'><input id='section-aa0fe292-1835-448e-9099-3e6245454ccc' class='xr-section-summary-in' type='checkbox'  ><label for='section-aa0fe292-1835-448e-9099-3e6245454ccc' class='xr-section-summary' >Indexes: <span>(4)</span></label><div class='xr-section-inline-details'></div><div class='xr-section-details'><ul class='xr-var-list'><li class='xr-var-item'><div class='xr-index-name'><div>time</div></div><div class='xr-index-preview'>PandasIndex</div><input type='checkbox' disabled/><label></label><input id='index-afacf78d-ebcd-4461-8727-e695a9c3e1ac' class='xr-index-data-in' type='checkbox'/><label for='index-afacf78d-ebcd-4461-8727-e695a9c3e1ac' title='Show/Hide index repr'><svg class='icon xr-icon-database'><use xlink:href='#icon-database'></use></svg></label><div class='xr-index-data'><pre>PandasIndex(Index([                0.0, 0.03333333333333333, 0.06666666666666667,
                           0.1, 0.13333333333333333, 0.16666666666666666,
                           0.2, 0.23333333333333334, 0.26666666666666666,
                           0.3,
           ...
             615.8333333333334,   615.8666666666667,               615.9,
             615.9333333333333,   615.9666666666667,               616.0,
             616.0333333333333,   616.0666666666667,               616.1,
             616.1333333333333],
          dtype=&#x27;float64&#x27;, name=&#x27;time&#x27;, length=18485))</pre></div></li><li class='xr-var-item'><div class='xr-index-name'><div>space</div></div><div class='xr-index-preview'>PandasIndex</div><input type='checkbox' disabled/><label></label><input id='index-53f03326-307e-4140-9108-d70d4df8e863' class='xr-index-data-in' type='checkbox'/><label for='index-53f03326-307e-4140-9108-d70d4df8e863' title='Show/Hide index repr'><svg class='icon xr-icon-database'><use xlink:href='#icon-database'></use></svg></label><div class='xr-index-data'><pre>PandasIndex(Index([&#x27;x&#x27;, &#x27;y&#x27;], dtype=&#x27;object&#x27;, name=&#x27;space&#x27;))</pre></div></li><li class='xr-var-item'><div class='xr-index-name'><div>keypoints</div></div><div class='xr-index-preview'>PandasIndex</div><input type='checkbox' disabled/><label></label><input id='index-97a7c112-ba28-4f52-9c16-c98bf1783f7a' class='xr-index-data-in' type='checkbox'/><label for='index-97a7c112-ba28-4f52-9c16-c98bf1783f7a' title='Show/Hide index repr'><svg class='icon xr-icon-database'><use xlink:href='#icon-database'></use></svg></label><div class='xr-index-data'><pre>PandasIndex(Index([&#x27;snout&#x27;, &#x27;left_ear&#x27;, &#x27;right_ear&#x27;, &#x27;centre&#x27;, &#x27;tail_base&#x27;, &#x27;tail_end&#x27;], dtype=&#x27;object&#x27;, name=&#x27;keypoints&#x27;))</pre></div></li><li class='xr-var-item'><div class='xr-index-name'><div>individuals</div></div><div class='xr-index-preview'>PandasIndex</div><input type='checkbox' disabled/><label></label><input id='index-5ea439d0-9122-4f7b-8fe1-3d8cbc86d0ca' class='xr-index-data-in' type='checkbox'/><label for='index-5ea439d0-9122-4f7b-8fe1-3d8cbc86d0ca' title='Show/Hide index repr'><svg class='icon xr-icon-database'><use xlink:href='#icon-database'></use></svg></label><div class='xr-index-data'><pre>PandasIndex(Index([&#x27;individual_0&#x27;], dtype=&#x27;object&#x27;, name=&#x27;individuals&#x27;))</pre></div></li></ul></div></li><li class='xr-section-item'><input id='section-ba6907d3-ed8e-4075-b9bb-839c1f98111b' class='xr-section-summary-in' type='checkbox'  checked><label for='section-ba6907d3-ed8e-4075-b9bb-839c1f98111b' class='xr-section-summary' >Attributes: <span>(6)</span></label><div class='xr-section-inline-details'></div><div class='xr-section-details'><dl class='xr-attrs'><dt><span>source_software :</span></dt><dd>SLEAP</dd><dt><span>ds_type :</span></dt><dd>poses</dd><dt><span>fps :</span></dt><dd>30.0</dd><dt><span>time_unit :</span></dt><dd>seconds</dd><dt><span>source_file :</span></dt><dd>/home/runner/.movement/data/poses/SLEAP_single-mouse_EPM.analysis.h5</dd><dt><span>frame_path :</span></dt><dd>/home/runner/.movement/data/frames/single-mouse_EPM_frame-20sec.png</dd></dl></div></li></ul></div></div>
    </div>
    <br />
    <br />

.. GENERATED FROM PYTHON SOURCE LINES 216-222

We see that this time the number of NaN values has decreased
across all keypoints.
Let's visualise the effects of the rolling median filter in the time and
frequency domains. Here we focus on the first 80 seconds for the ``snout``
keypoint. You can adjust the ``keypoint`` and ``time_range`` arguments to
explore other parts of the data.

.. GENERATED FROM PYTHON SOURCE LINES 222-227

.. code-block:: Python


    plot_raw_and_smooth_timeseries_and_psd(
        ds_mouse, ds_mouse_smooth, keypoint="snout", time_range=slice(0, 80)
    )




.. image-sg:: /examples/images/sphx_glr_smooth_002.png
   :alt: Time Domain, Frequency Domain
   :srcset: /examples/images/sphx_glr_smooth_002.png
   :class: sphx-glr-single-img





.. GENERATED FROM PYTHON SOURCE LINES 228-232

The smoothing once again reduces the power of high-frequency components, but
the resulting time series stays quite close to the raw data.

What happens if we increase the ``window`` to 2 seconds (60 frames)?

.. GENERATED FROM PYTHON SOURCE LINES 232-246

.. code-block:: Python


    window = int(2 * ds_mouse.fps)
    ds_mouse_smooth.update(
        {
            "position": rolling_filter(
                ds_mouse.position,
                window,
                min_periods=2,
                statistic="median",
                print_report=True,
            )
        }
    )





.. rst-class:: sphx-glr-script-out

 .. code-block:: none


    Missing points (marked as NaN) in input
            Individual: individual_0
                    snout: 4494/18485 (24.3%)
                    left_ear: 513/18485 (2.8%)
                    right_ear: 533/18485 (2.9%)
                    centre: 490/18485 (2.7%)
                    tail_base: 704/18485 (3.8%)
                    tail_end: 2496/18485 (13.5%)

    Missing points (marked as NaN) in output
            Individual: individual_0
                    snout: 795/18485 (4.3%)
                    left_ear: 80/18485 (0.4%)
                    right_ear: 80/18485 (0.4%)
                    centre: 80/18485 (0.4%)
                    tail_base: 80/18485 (0.4%)
                    tail_end: 239/18485 (1.3%)


.. raw:: html

    <div class="output_subarea output_html rendered_html output_result">
    <div><svg style="position: absolute; width: 0; height: 0; overflow: hidden">
    <defs>
    <symbol id="icon-database" viewBox="0 0 32 32">
    <path d="M16 0c-8.837 0-16 2.239-16 5v4c0 2.761 7.163 5 16 5s16-2.239 16-5v-4c0-2.761-7.163-5-16-5z"></path>
    <path d="M16 17c-8.837 0-16-2.239-16-5v6c0 2.761 7.163 5 16 5s16-2.239 16-5v-6c0 2.761-7.163 5-16 5z"></path>
    <path d="M16 26c-8.837 0-16-2.239-16-5v6c0 2.761 7.163 5 16 5s16-2.239 16-5v-6c0 2.761-7.163 5-16 5z"></path>
    </symbol>
    <symbol id="icon-file-text2" viewBox="0 0 32 32">
    <path d="M28.681 7.159c-0.694-0.947-1.662-2.053-2.724-3.116s-2.169-2.030-3.116-2.724c-1.612-1.182-2.393-1.319-2.841-1.319h-15.5c-1.378 0-2.5 1.121-2.5 2.5v27c0 1.378 1.122 2.5 2.5 2.5h23c1.378 0 2.5-1.122 2.5-2.5v-19.5c0-0.448-0.137-1.23-1.319-2.841zM24.543 5.457c0.959 0.959 1.712 1.825 2.268 2.543h-4.811v-4.811c0.718 0.556 1.584 1.309 2.543 2.268zM28 29.5c0 0.271-0.229 0.5-0.5 0.5h-23c-0.271 0-0.5-0.229-0.5-0.5v-27c0-0.271 0.229-0.5 0.5-0.5 0 0 15.499-0 15.5 0v7c0 0.552 0.448 1 1 1h7v19.5z"></path>
    <path d="M23 26h-14c-0.552 0-1-0.448-1-1s0.448-1 1-1h14c0.552 0 1 0.448 1 1s-0.448 1-1 1z"></path>
    <path d="M23 22h-14c-0.552 0-1-0.448-1-1s0.448-1 1-1h14c0.552 0 1 0.448 1 1s-0.448 1-1 1z"></path>
    <path d="M23 18h-14c-0.552 0-1-0.448-1-1s0.448-1 1-1h14c0.552 0 1 0.448 1 1s-0.448 1-1 1z"></path>
    </symbol>
    </defs>
    </svg>
    <style>/* CSS stylesheet for displaying xarray objects in jupyterlab.
     *
     */

    :root {
      --xr-font-color0: var(--jp-content-font-color0, rgba(0, 0, 0, 1));
      --xr-font-color2: var(--jp-content-font-color2, rgba(0, 0, 0, 0.54));
      --xr-font-color3: var(--jp-content-font-color3, rgba(0, 0, 0, 0.38));
      --xr-border-color: var(--jp-border-color2, #e0e0e0);
      --xr-disabled-color: var(--jp-layout-color3, #bdbdbd);
      --xr-background-color: var(--jp-layout-color0, white);
      --xr-background-color-row-even: var(--jp-layout-color1, white);
      --xr-background-color-row-odd: var(--jp-layout-color2, #eeeeee);
    }

    html[theme="dark"],
    html[data-theme="dark"],
    body[data-theme="dark"],
    body.vscode-dark {
      --xr-font-color0: rgba(255, 255, 255, 1);
      --xr-font-color2: rgba(255, 255, 255, 0.54);
      --xr-font-color3: rgba(255, 255, 255, 0.38);
      --xr-border-color: #1f1f1f;
      --xr-disabled-color: #515151;
      --xr-background-color: #111111;
      --xr-background-color-row-even: #111111;
      --xr-background-color-row-odd: #313131;
    }

    .xr-wrap {
      display: block !important;
      min-width: 300px;
      max-width: 700px;
    }

    .xr-text-repr-fallback {
      /* fallback to plain text repr when CSS is not injected (untrusted notebook) */
      display: none;
    }

    .xr-header {
      padding-top: 6px;
      padding-bottom: 6px;
      margin-bottom: 4px;
      border-bottom: solid 1px var(--xr-border-color);
    }

    .xr-header > div,
    .xr-header > ul {
      display: inline;
      margin-top: 0;
      margin-bottom: 0;
    }

    .xr-obj-type,
    .xr-array-name {
      margin-left: 2px;
      margin-right: 10px;
    }

    .xr-obj-type {
      color: var(--xr-font-color2);
    }

    .xr-sections {
      padding-left: 0 !important;
      display: grid;
      grid-template-columns: 150px auto auto 1fr 0 20px 0 20px;
    }

    .xr-section-item {
      display: contents;
    }

    .xr-section-item input {
      display: inline-block;
      opacity: 0;
      height: 0;
    }

    .xr-section-item input + label {
      color: var(--xr-disabled-color);
    }

    .xr-section-item input:enabled + label {
      cursor: pointer;
      color: var(--xr-font-color2);
    }

    .xr-section-item input:focus + label {
      border: 2px solid var(--xr-font-color0);
    }

    .xr-section-item input:enabled + label:hover {
      color: var(--xr-font-color0);
    }

    .xr-section-summary {
      grid-column: 1;
      color: var(--xr-font-color2);
      font-weight: 500;
    }

    .xr-section-summary > span {
      display: inline-block;
      padding-left: 0.5em;
    }

    .xr-section-summary-in:disabled + label {
      color: var(--xr-font-color2);
    }

    .xr-section-summary-in + label:before {
      display: inline-block;
      content: "►";
      font-size: 11px;
      width: 15px;
      text-align: center;
    }

    .xr-section-summary-in:disabled + label:before {
      color: var(--xr-disabled-color);
    }

    .xr-section-summary-in:checked + label:before {
      content: "▼";
    }

    .xr-section-summary-in:checked + label > span {
      display: none;
    }

    .xr-section-summary,
    .xr-section-inline-details {
      padding-top: 4px;
      padding-bottom: 4px;
    }

    .xr-section-inline-details {
      grid-column: 2 / -1;
    }

    .xr-section-details {
      display: none;
      grid-column: 1 / -1;
      margin-bottom: 5px;
    }

    .xr-section-summary-in:checked ~ .xr-section-details {
      display: contents;
    }

    .xr-array-wrap {
      grid-column: 1 / -1;
      display: grid;
      grid-template-columns: 20px auto;
    }

    .xr-array-wrap > label {
      grid-column: 1;
      vertical-align: top;
    }

    .xr-preview {
      color: var(--xr-font-color3);
    }

    .xr-array-preview,
    .xr-array-data {
      padding: 0 5px !important;
      grid-column: 2;
    }

    .xr-array-data,
    .xr-array-in:checked ~ .xr-array-preview {
      display: none;
    }

    .xr-array-in:checked ~ .xr-array-data,
    .xr-array-preview {
      display: inline-block;
    }

    .xr-dim-list {
      display: inline-block !important;
      list-style: none;
      padding: 0 !important;
      margin: 0;
    }

    .xr-dim-list li {
      display: inline-block;
      padding: 0;
      margin: 0;
    }

    .xr-dim-list:before {
      content: "(";
    }

    .xr-dim-list:after {
      content: ")";
    }

    .xr-dim-list li:not(:last-child):after {
      content: ",";
      padding-right: 5px;
    }

    .xr-has-index {
      font-weight: bold;
    }

    .xr-var-list,
    .xr-var-item {
      display: contents;
    }

    .xr-var-item > div,
    .xr-var-item label,
    .xr-var-item > .xr-var-name span {
      background-color: var(--xr-background-color-row-even);
      margin-bottom: 0;
    }

    .xr-var-item > .xr-var-name:hover span {
      padding-right: 5px;
    }

    .xr-var-list > li:nth-child(odd) > div,
    .xr-var-list > li:nth-child(odd) > label,
    .xr-var-list > li:nth-child(odd) > .xr-var-name span {
      background-color: var(--xr-background-color-row-odd);
    }

    .xr-var-name {
      grid-column: 1;
    }

    .xr-var-dims {
      grid-column: 2;
    }

    .xr-var-dtype {
      grid-column: 3;
      text-align: right;
      color: var(--xr-font-color2);
    }

    .xr-var-preview {
      grid-column: 4;
    }

    .xr-index-preview {
      grid-column: 2 / 5;
      color: var(--xr-font-color2);
    }

    .xr-var-name,
    .xr-var-dims,
    .xr-var-dtype,
    .xr-preview,
    .xr-attrs dt {
      white-space: nowrap;
      overflow: hidden;
      text-overflow: ellipsis;
      padding-right: 10px;
    }

    .xr-var-name:hover,
    .xr-var-dims:hover,
    .xr-var-dtype:hover,
    .xr-attrs dt:hover {
      overflow: visible;
      width: auto;
      z-index: 1;
    }

    .xr-var-attrs,
    .xr-var-data,
    .xr-index-data {
      display: none;
      background-color: var(--xr-background-color) !important;
      padding-bottom: 5px !important;
    }

    .xr-var-attrs-in:checked ~ .xr-var-attrs,
    .xr-var-data-in:checked ~ .xr-var-data,
    .xr-index-data-in:checked ~ .xr-index-data {
      display: block;
    }

    .xr-var-data > table {
      float: right;
    }

    .xr-var-name span,
    .xr-var-data,
    .xr-index-name div,
    .xr-index-data,
    .xr-attrs {
      padding-left: 25px !important;
    }

    .xr-attrs,
    .xr-var-attrs,
    .xr-var-data,
    .xr-index-data {
      grid-column: 1 / -1;
    }

    dl.xr-attrs {
      padding: 0;
      margin: 0;
      display: grid;
      grid-template-columns: 125px auto;
    }

    .xr-attrs dt,
    .xr-attrs dd {
      padding: 0;
      margin: 0;
      float: left;
      padding-right: 10px;
      width: auto;
    }

    .xr-attrs dt {
      font-weight: normal;
      grid-column: 1;
    }

    .xr-attrs dt:hover span {
      display: inline-block;
      background: var(--xr-background-color);
      padding-right: 10px;
    }

    .xr-attrs dd {
      grid-column: 2;
      white-space: pre-wrap;
      word-break: break-all;
    }

    .xr-icon-database,
    .xr-icon-file-text2,
    .xr-no-icon {
      display: inline-block;
      vertical-align: middle;
      width: 1em;
      height: 1.5em !important;
      stroke-width: 0;
      stroke: currentColor;
      fill: currentColor;
    }
    </style><pre class='xr-text-repr-fallback'>&lt;xarray.Dataset&gt; Size: 1MB
    Dimensions:      (time: 18485, space: 2, keypoints: 6, individuals: 1)
    Coordinates:
      * time         (time) float64 148kB 0.0 0.03333 0.06667 ... 616.1 616.1 616.1
      * space        (space) &lt;U1 8B &#x27;x&#x27; &#x27;y&#x27;
      * keypoints    (keypoints) &lt;U9 216B &#x27;snout&#x27; &#x27;left_ear&#x27; ... &#x27;tail_end&#x27;
      * individuals  (individuals) &lt;U12 48B &#x27;individual_0&#x27;
    Data variables:
        position     (time, space, keypoints, individuals) float32 887kB nan ... ...
        confidence   (time, keypoints, individuals) float32 444kB nan nan ... 0.7607
    Attributes:
        source_software:  SLEAP
        ds_type:          poses
        fps:              30.0
        time_unit:        seconds
        source_file:      /home/runner/.movement/data/poses/SLEAP_single-mouse_EP...
        frame_path:       /home/runner/.movement/data/frames/single-mouse_EPM_fra...</pre><div class='xr-wrap' style='display:none'><div class='xr-header'><div class='xr-obj-type'>xarray.Dataset</div></div><ul class='xr-sections'><li class='xr-section-item'><input id='section-b222c8b5-c6dd-4699-9246-4bd638b437ad' class='xr-section-summary-in' type='checkbox' disabled ><label for='section-b222c8b5-c6dd-4699-9246-4bd638b437ad' class='xr-section-summary'  title='Expand/collapse section'>Dimensions:</label><div class='xr-section-inline-details'><ul class='xr-dim-list'><li><span class='xr-has-index'>time</span>: 18485</li><li><span class='xr-has-index'>space</span>: 2</li><li><span class='xr-has-index'>keypoints</span>: 6</li><li><span class='xr-has-index'>individuals</span>: 1</li></ul></div><div class='xr-section-details'></div></li><li class='xr-section-item'><input id='section-177c185c-58d8-4b42-b2ba-9a3225681292' class='xr-section-summary-in' type='checkbox'  checked><label for='section-177c185c-58d8-4b42-b2ba-9a3225681292' class='xr-section-summary' >Coordinates: <span>(4)</span></label><div class='xr-section-inline-details'></div><div class='xr-section-details'><ul class='xr-var-list'><li class='xr-var-item'><div class='xr-var-name'><span class='xr-has-index'>time</span></div><div class='xr-var-dims'>(time)</div><div class='xr-var-dtype'>float64</div><div class='xr-var-preview xr-preview'>0.0 0.03333 0.06667 ... 616.1 616.1</div><input id='attrs-594b0320-70f5-4022-804e-200a07e401f4' class='xr-var-attrs-in' type='checkbox' disabled><label for='attrs-594b0320-70f5-4022-804e-200a07e401f4' title='Show/Hide attributes'><svg class='icon xr-icon-file-text2'><use xlink:href='#icon-file-text2'></use></svg></label><input id='data-0465797a-ab9c-42f2-88eb-0f2c094d870d' class='xr-var-data-in' type='checkbox'><label for='data-0465797a-ab9c-42f2-88eb-0f2c094d870d' title='Show/Hide data repr'><svg class='icon xr-icon-database'><use xlink:href='#icon-database'></use></svg></label><div class='xr-var-attrs'><dl class='xr-attrs'></dl></div><div class='xr-var-data'><pre>array([0.000000e+00, 3.333333e-02, 6.666667e-02, ..., 6.160667e+02,
           6.161000e+02, 6.161333e+02], shape=(18485,))</pre></div></li><li class='xr-var-item'><div class='xr-var-name'><span class='xr-has-index'>space</span></div><div class='xr-var-dims'>(space)</div><div class='xr-var-dtype'>&lt;U1</div><div class='xr-var-preview xr-preview'>&#x27;x&#x27; &#x27;y&#x27;</div><input id='attrs-a6dd549d-a878-4980-a935-2be84ff42150' class='xr-var-attrs-in' type='checkbox' disabled><label for='attrs-a6dd549d-a878-4980-a935-2be84ff42150' title='Show/Hide attributes'><svg class='icon xr-icon-file-text2'><use xlink:href='#icon-file-text2'></use></svg></label><input id='data-b3f4009c-dc7e-4f0f-9127-865b9c8ef5b7' class='xr-var-data-in' type='checkbox'><label for='data-b3f4009c-dc7e-4f0f-9127-865b9c8ef5b7' title='Show/Hide data repr'><svg class='icon xr-icon-database'><use xlink:href='#icon-database'></use></svg></label><div class='xr-var-attrs'><dl class='xr-attrs'></dl></div><div class='xr-var-data'><pre>array([&#x27;x&#x27;, &#x27;y&#x27;], dtype=&#x27;&lt;U1&#x27;)</pre></div></li><li class='xr-var-item'><div class='xr-var-name'><span class='xr-has-index'>keypoints</span></div><div class='xr-var-dims'>(keypoints)</div><div class='xr-var-dtype'>&lt;U9</div><div class='xr-var-preview xr-preview'>&#x27;snout&#x27; &#x27;left_ear&#x27; ... &#x27;tail_end&#x27;</div><input id='attrs-628629e0-a8e3-49a9-be1d-f9e539fdcc91' class='xr-var-attrs-in' type='checkbox' disabled><label for='attrs-628629e0-a8e3-49a9-be1d-f9e539fdcc91' title='Show/Hide attributes'><svg class='icon xr-icon-file-text2'><use xlink:href='#icon-file-text2'></use></svg></label><input id='data-fc366f4b-72cf-40a1-b6bd-4be02fafbf2d' class='xr-var-data-in' type='checkbox'><label for='data-fc366f4b-72cf-40a1-b6bd-4be02fafbf2d' title='Show/Hide data repr'><svg class='icon xr-icon-database'><use xlink:href='#icon-database'></use></svg></label><div class='xr-var-attrs'><dl class='xr-attrs'></dl></div><div class='xr-var-data'><pre>array([&#x27;snout&#x27;, &#x27;left_ear&#x27;, &#x27;right_ear&#x27;, &#x27;centre&#x27;, &#x27;tail_base&#x27;, &#x27;tail_end&#x27;],
          dtype=&#x27;&lt;U9&#x27;)</pre></div></li><li class='xr-var-item'><div class='xr-var-name'><span class='xr-has-index'>individuals</span></div><div class='xr-var-dims'>(individuals)</div><div class='xr-var-dtype'>&lt;U12</div><div class='xr-var-preview xr-preview'>&#x27;individual_0&#x27;</div><input id='attrs-a17a5595-facf-4dc1-9e73-cdf350db55b5' class='xr-var-attrs-in' type='checkbox' disabled><label for='attrs-a17a5595-facf-4dc1-9e73-cdf350db55b5' title='Show/Hide attributes'><svg class='icon xr-icon-file-text2'><use xlink:href='#icon-file-text2'></use></svg></label><input id='data-25664caf-f388-4952-90d8-0e248a6381b0' class='xr-var-data-in' type='checkbox'><label for='data-25664caf-f388-4952-90d8-0e248a6381b0' title='Show/Hide data repr'><svg class='icon xr-icon-database'><use xlink:href='#icon-database'></use></svg></label><div class='xr-var-attrs'><dl class='xr-attrs'></dl></div><div class='xr-var-data'><pre>array([&#x27;individual_0&#x27;], dtype=&#x27;&lt;U12&#x27;)</pre></div></li></ul></div></li><li class='xr-section-item'><input id='section-41737ecc-0de9-4657-b841-96dca5bc14ea' class='xr-section-summary-in' type='checkbox'  checked><label for='section-41737ecc-0de9-4657-b841-96dca5bc14ea' class='xr-section-summary' >Data variables: <span>(2)</span></label><div class='xr-section-inline-details'></div><div class='xr-section-details'><ul class='xr-var-list'><li class='xr-var-item'><div class='xr-var-name'><span>position</span></div><div class='xr-var-dims'>(time, space, keypoints, individuals)</div><div class='xr-var-dtype'>float32</div><div class='xr-var-preview xr-preview'>nan nan nan ... 428.4 380.2 476.2</div><input id='attrs-aaf2ca5e-21d9-425e-8d4a-11a52254788c' class='xr-var-attrs-in' type='checkbox' ><label for='attrs-aaf2ca5e-21d9-425e-8d4a-11a52254788c' title='Show/Hide attributes'><svg class='icon xr-icon-file-text2'><use xlink:href='#icon-file-text2'></use></svg></label><input id='data-14a4e44e-258f-463b-b4a3-be56272def27' class='xr-var-data-in' type='checkbox'><label for='data-14a4e44e-258f-463b-b4a3-be56272def27' title='Show/Hide data repr'><svg class='icon xr-icon-database'><use xlink:href='#icon-database'></use></svg></label><div class='xr-var-attrs'><dl class='xr-attrs'><dt><span>log :</span></dt><dd>[{&#x27;operation&#x27;: &#x27;rolling_filter&#x27;, &#x27;datetime&#x27;: &#x27;2025-05-14 09:39:05.037037&#x27;, &#x27;arg_1&#x27;: 60, &#x27;min_periods&#x27;: 2, &#x27;statistic&#x27;: &#x27;median&#x27;, &#x27;print_report&#x27;: True}]</dd></dl></div><div class='xr-var-data'><pre>array([[[[      nan],
             [      nan],
             [      nan],
             [      nan],
             [      nan],
             [      nan]],

            [[      nan],
             [      nan],
             [      nan],
             [      nan],
             [      nan],
             [      nan]]],


           [[[      nan],
             [      nan],
             [      nan],
             [      nan],
             [      nan],
    ...
             [476.5145 ],
             [478.4414 ],
             [428.46777],
             [380.2395 ],
             [476.2374 ]]],


           [[[684.67834],
             [688.80676],
             [667.78625],
             [668.1798 ],
             [635.94543],
             [588.9046 ]],

            [[493.02063],
             [476.48022],
             [477.0539 ],
             [428.44302],
             [380.2395 ],
             [476.2374 ]]]], shape=(18485, 2, 6, 1), dtype=float32)</pre></div></li><li class='xr-var-item'><div class='xr-var-name'><span>confidence</span></div><div class='xr-var-dims'>(time, keypoints, individuals)</div><div class='xr-var-dtype'>float32</div><div class='xr-var-preview xr-preview'>nan nan nan ... 0.9336 0.7607</div><input id='attrs-756ef4f3-79d1-46d5-80d4-c7c33178f72b' class='xr-var-attrs-in' type='checkbox' disabled><label for='attrs-756ef4f3-79d1-46d5-80d4-c7c33178f72b' title='Show/Hide attributes'><svg class='icon xr-icon-file-text2'><use xlink:href='#icon-file-text2'></use></svg></label><input id='data-423e6d72-d42a-4b34-afe1-3a06f1d6afef' class='xr-var-data-in' type='checkbox'><label for='data-423e6d72-d42a-4b34-afe1-3a06f1d6afef' title='Show/Hide data repr'><svg class='icon xr-icon-database'><use xlink:href='#icon-database'></use></svg></label><div class='xr-var-attrs'><dl class='xr-attrs'></dl></div><div class='xr-var-data'><pre>array([[[       nan],
            [       nan],
            [       nan],
            [       nan],
            [       nan],
            [       nan]],

           [[       nan],
            [       nan],
            [       nan],
            [       nan],
            [       nan],
            [       nan]],

           [[       nan],
            [       nan],
            [       nan],
            [       nan],
            [       nan],
            [       nan]],
    ...
           [[0.9317396 ],
            [1.0026728 ],
            [1.025079  ],
            [0.92725545],
            [0.95202184],
            [0.7779419 ]],

           [[0.9193515 ],
            [1.0136327 ],
            [1.0336665 ],
            [0.93108493],
            [0.94561106],
            [0.7662804 ]],

           [[0.93820494],
            [1.0224991 ],
            [1.0452943 ],
            [0.9363993 ],
            [0.9335798 ],
            [0.76068705]]], shape=(18485, 6, 1), dtype=float32)</pre></div></li></ul></div></li><li class='xr-section-item'><input id='section-e8d77b02-b339-4268-8fdd-f2d73762c474' class='xr-section-summary-in' type='checkbox'  ><label for='section-e8d77b02-b339-4268-8fdd-f2d73762c474' class='xr-section-summary' >Indexes: <span>(4)</span></label><div class='xr-section-inline-details'></div><div class='xr-section-details'><ul class='xr-var-list'><li class='xr-var-item'><div class='xr-index-name'><div>time</div></div><div class='xr-index-preview'>PandasIndex</div><input type='checkbox' disabled/><label></label><input id='index-916cf74e-84bc-43ae-b5e3-7864d4336cb9' class='xr-index-data-in' type='checkbox'/><label for='index-916cf74e-84bc-43ae-b5e3-7864d4336cb9' title='Show/Hide index repr'><svg class='icon xr-icon-database'><use xlink:href='#icon-database'></use></svg></label><div class='xr-index-data'><pre>PandasIndex(Index([                0.0, 0.03333333333333333, 0.06666666666666667,
                           0.1, 0.13333333333333333, 0.16666666666666666,
                           0.2, 0.23333333333333334, 0.26666666666666666,
                           0.3,
           ...
             615.8333333333334,   615.8666666666667,               615.9,
             615.9333333333333,   615.9666666666667,               616.0,
             616.0333333333333,   616.0666666666667,               616.1,
             616.1333333333333],
          dtype=&#x27;float64&#x27;, name=&#x27;time&#x27;, length=18485))</pre></div></li><li class='xr-var-item'><div class='xr-index-name'><div>space</div></div><div class='xr-index-preview'>PandasIndex</div><input type='checkbox' disabled/><label></label><input id='index-0cf5da45-b0a7-449d-b772-c2a040699fc3' class='xr-index-data-in' type='checkbox'/><label for='index-0cf5da45-b0a7-449d-b772-c2a040699fc3' title='Show/Hide index repr'><svg class='icon xr-icon-database'><use xlink:href='#icon-database'></use></svg></label><div class='xr-index-data'><pre>PandasIndex(Index([&#x27;x&#x27;, &#x27;y&#x27;], dtype=&#x27;object&#x27;, name=&#x27;space&#x27;))</pre></div></li><li class='xr-var-item'><div class='xr-index-name'><div>keypoints</div></div><div class='xr-index-preview'>PandasIndex</div><input type='checkbox' disabled/><label></label><input id='index-d56855db-0a26-4a91-a88e-cdc616fe2337' class='xr-index-data-in' type='checkbox'/><label for='index-d56855db-0a26-4a91-a88e-cdc616fe2337' title='Show/Hide index repr'><svg class='icon xr-icon-database'><use xlink:href='#icon-database'></use></svg></label><div class='xr-index-data'><pre>PandasIndex(Index([&#x27;snout&#x27;, &#x27;left_ear&#x27;, &#x27;right_ear&#x27;, &#x27;centre&#x27;, &#x27;tail_base&#x27;, &#x27;tail_end&#x27;], dtype=&#x27;object&#x27;, name=&#x27;keypoints&#x27;))</pre></div></li><li class='xr-var-item'><div class='xr-index-name'><div>individuals</div></div><div class='xr-index-preview'>PandasIndex</div><input type='checkbox' disabled/><label></label><input id='index-2c3417a5-7ff1-4898-95b7-a2254606807b' class='xr-index-data-in' type='checkbox'/><label for='index-2c3417a5-7ff1-4898-95b7-a2254606807b' title='Show/Hide index repr'><svg class='icon xr-icon-database'><use xlink:href='#icon-database'></use></svg></label><div class='xr-index-data'><pre>PandasIndex(Index([&#x27;individual_0&#x27;], dtype=&#x27;object&#x27;, name=&#x27;individuals&#x27;))</pre></div></li></ul></div></li><li class='xr-section-item'><input id='section-91e8ecbb-bb83-413a-8b15-c6cc5ab48678' class='xr-section-summary-in' type='checkbox'  checked><label for='section-91e8ecbb-bb83-413a-8b15-c6cc5ab48678' class='xr-section-summary' >Attributes: <span>(6)</span></label><div class='xr-section-inline-details'></div><div class='xr-section-details'><dl class='xr-attrs'><dt><span>source_software :</span></dt><dd>SLEAP</dd><dt><span>ds_type :</span></dt><dd>poses</dd><dt><span>fps :</span></dt><dd>30.0</dd><dt><span>time_unit :</span></dt><dd>seconds</dd><dt><span>source_file :</span></dt><dd>/home/runner/.movement/data/poses/SLEAP_single-mouse_EPM.analysis.h5</dd><dt><span>frame_path :</span></dt><dd>/home/runner/.movement/data/frames/single-mouse_EPM_frame-20sec.png</dd></dl></div></li></ul></div></div>
    </div>
    <br />
    <br />

.. GENERATED FROM PYTHON SOURCE LINES 247-252

The number of NaN values has decreased even further.
That's because the chance of finding at least 2 valid values within
a 2-second window (i.e. 60 frames) is quite high.
Let's plot the results for the same keypoint and time range
as before.

.. GENERATED FROM PYTHON SOURCE LINES 252-256

.. code-block:: Python


    plot_raw_and_smooth_timeseries_and_psd(
        ds_mouse, ds_mouse_smooth, keypoint="snout", time_range=slice(0, 80)
    )



.. image-sg:: /examples/images/sphx_glr_smooth_003.png
   :alt: Time Domain, Frequency Domain
   :srcset: /examples/images/sphx_glr_smooth_003.png
   :class: sphx-glr-single-img





.. GENERATED FROM PYTHON SOURCE LINES 257-265

We see that the filtered time series is much smoother and it has even
"bridged" over some small gaps. That said, it often deviates from the raw
data, in ways that may not be desirable, depending on the application.
Here, our choice of ``window`` may be too large.
In general, you should choose a ``window`` that is small enough to
preserve the original data structure, but large enough to remove
"spikes" and high-frequency noise. Always inspect the results to ensure
that the filter is not removing important features.

.. GENERATED FROM PYTHON SOURCE LINES 267-283

Smoothing with a Savitzky-Golay filter
--------------------------------------
Here we apply the :func:`movement.filtering.savgol_filter` function
(a wrapper around :func:`scipy.signal.savgol_filter`), to the ``position``
data variable.
The Savitzky-Golay filter is a polynomial smoothing filter that can be
applied to time series data on a rolling window basis.
A polynomial with a degree specified by ``polyorder`` is applied to each
data segment defined by the size ``window``.
The value of the polynomial at the midpoint of each ``window`` is then
used as the output value.

Let's try it on the mouse dataset, this time using a 0.2-second
window (i.e. 6 frames) and the default ``polyorder=2`` for smoothing.
As before, we first compute the corresponding number of observations
to be used as the ``window`` size.

.. GENERATED FROM PYTHON SOURCE LINES 283-289

.. code-block:: Python


    window = int(0.2 * ds_mouse.fps)
    ds_mouse_smooth.update(
        {"position": savgol_filter(ds_mouse.position, window, print_report=True)}
    )





.. rst-class:: sphx-glr-script-out

 .. code-block:: none


    Missing points (marked as NaN) in input
            Individual: individual_0
                    snout: 4494/18485 (24.3%)
                    left_ear: 513/18485 (2.8%)
                    right_ear: 533/18485 (2.9%)
                    centre: 490/18485 (2.7%)
                    tail_base: 704/18485 (3.8%)
                    tail_end: 2496/18485 (13.5%)

    Missing points (marked as NaN) in output
            Individual: individual_0
                    snout: 5810/18485 (31.4%)
                    left_ear: 895/18485 (4.8%)
                    right_ear: 905/18485 (4.9%)
                    centre: 839/18485 (4.5%)
                    tail_base: 1186/18485 (6.4%)
                    tail_end: 3801/18485 (20.6%)


.. raw:: html

    <div class="output_subarea output_html rendered_html output_result">
    <div><svg style="position: absolute; width: 0; height: 0; overflow: hidden">
    <defs>
    <symbol id="icon-database" viewBox="0 0 32 32">
    <path d="M16 0c-8.837 0-16 2.239-16 5v4c0 2.761 7.163 5 16 5s16-2.239 16-5v-4c0-2.761-7.163-5-16-5z"></path>
    <path d="M16 17c-8.837 0-16-2.239-16-5v6c0 2.761 7.163 5 16 5s16-2.239 16-5v-6c0 2.761-7.163 5-16 5z"></path>
    <path d="M16 26c-8.837 0-16-2.239-16-5v6c0 2.761 7.163 5 16 5s16-2.239 16-5v-6c0 2.761-7.163 5-16 5z"></path>
    </symbol>
    <symbol id="icon-file-text2" viewBox="0 0 32 32">
    <path d="M28.681 7.159c-0.694-0.947-1.662-2.053-2.724-3.116s-2.169-2.030-3.116-2.724c-1.612-1.182-2.393-1.319-2.841-1.319h-15.5c-1.378 0-2.5 1.121-2.5 2.5v27c0 1.378 1.122 2.5 2.5 2.5h23c1.378 0 2.5-1.122 2.5-2.5v-19.5c0-0.448-0.137-1.23-1.319-2.841zM24.543 5.457c0.959 0.959 1.712 1.825 2.268 2.543h-4.811v-4.811c0.718 0.556 1.584 1.309 2.543 2.268zM28 29.5c0 0.271-0.229 0.5-0.5 0.5h-23c-0.271 0-0.5-0.229-0.5-0.5v-27c0-0.271 0.229-0.5 0.5-0.5 0 0 15.499-0 15.5 0v7c0 0.552 0.448 1 1 1h7v19.5z"></path>
    <path d="M23 26h-14c-0.552 0-1-0.448-1-1s0.448-1 1-1h14c0.552 0 1 0.448 1 1s-0.448 1-1 1z"></path>
    <path d="M23 22h-14c-0.552 0-1-0.448-1-1s0.448-1 1-1h14c0.552 0 1 0.448 1 1s-0.448 1-1 1z"></path>
    <path d="M23 18h-14c-0.552 0-1-0.448-1-1s0.448-1 1-1h14c0.552 0 1 0.448 1 1s-0.448 1-1 1z"></path>
    </symbol>
    </defs>
    </svg>
    <style>/* CSS stylesheet for displaying xarray objects in jupyterlab.
     *
     */

    :root {
      --xr-font-color0: var(--jp-content-font-color0, rgba(0, 0, 0, 1));
      --xr-font-color2: var(--jp-content-font-color2, rgba(0, 0, 0, 0.54));
      --xr-font-color3: var(--jp-content-font-color3, rgba(0, 0, 0, 0.38));
      --xr-border-color: var(--jp-border-color2, #e0e0e0);
      --xr-disabled-color: var(--jp-layout-color3, #bdbdbd);
      --xr-background-color: var(--jp-layout-color0, white);
      --xr-background-color-row-even: var(--jp-layout-color1, white);
      --xr-background-color-row-odd: var(--jp-layout-color2, #eeeeee);
    }

    html[theme="dark"],
    html[data-theme="dark"],
    body[data-theme="dark"],
    body.vscode-dark {
      --xr-font-color0: rgba(255, 255, 255, 1);
      --xr-font-color2: rgba(255, 255, 255, 0.54);
      --xr-font-color3: rgba(255, 255, 255, 0.38);
      --xr-border-color: #1f1f1f;
      --xr-disabled-color: #515151;
      --xr-background-color: #111111;
      --xr-background-color-row-even: #111111;
      --xr-background-color-row-odd: #313131;
    }

    .xr-wrap {
      display: block !important;
      min-width: 300px;
      max-width: 700px;
    }

    .xr-text-repr-fallback {
      /* fallback to plain text repr when CSS is not injected (untrusted notebook) */
      display: none;
    }

    .xr-header {
      padding-top: 6px;
      padding-bottom: 6px;
      margin-bottom: 4px;
      border-bottom: solid 1px var(--xr-border-color);
    }

    .xr-header > div,
    .xr-header > ul {
      display: inline;
      margin-top: 0;
      margin-bottom: 0;
    }

    .xr-obj-type,
    .xr-array-name {
      margin-left: 2px;
      margin-right: 10px;
    }

    .xr-obj-type {
      color: var(--xr-font-color2);
    }

    .xr-sections {
      padding-left: 0 !important;
      display: grid;
      grid-template-columns: 150px auto auto 1fr 0 20px 0 20px;
    }

    .xr-section-item {
      display: contents;
    }

    .xr-section-item input {
      display: inline-block;
      opacity: 0;
      height: 0;
    }

    .xr-section-item input + label {
      color: var(--xr-disabled-color);
    }

    .xr-section-item input:enabled + label {
      cursor: pointer;
      color: var(--xr-font-color2);
    }

    .xr-section-item input:focus + label {
      border: 2px solid var(--xr-font-color0);
    }

    .xr-section-item input:enabled + label:hover {
      color: var(--xr-font-color0);
    }

    .xr-section-summary {
      grid-column: 1;
      color: var(--xr-font-color2);
      font-weight: 500;
    }

    .xr-section-summary > span {
      display: inline-block;
      padding-left: 0.5em;
    }

    .xr-section-summary-in:disabled + label {
      color: var(--xr-font-color2);
    }

    .xr-section-summary-in + label:before {
      display: inline-block;
      content: "►";
      font-size: 11px;
      width: 15px;
      text-align: center;
    }

    .xr-section-summary-in:disabled + label:before {
      color: var(--xr-disabled-color);
    }

    .xr-section-summary-in:checked + label:before {
      content: "▼";
    }

    .xr-section-summary-in:checked + label > span {
      display: none;
    }

    .xr-section-summary,
    .xr-section-inline-details {
      padding-top: 4px;
      padding-bottom: 4px;
    }

    .xr-section-inline-details {
      grid-column: 2 / -1;
    }

    .xr-section-details {
      display: none;
      grid-column: 1 / -1;
      margin-bottom: 5px;
    }

    .xr-section-summary-in:checked ~ .xr-section-details {
      display: contents;
    }

    .xr-array-wrap {
      grid-column: 1 / -1;
      display: grid;
      grid-template-columns: 20px auto;
    }

    .xr-array-wrap > label {
      grid-column: 1;
      vertical-align: top;
    }

    .xr-preview {
      color: var(--xr-font-color3);
    }

    .xr-array-preview,
    .xr-array-data {
      padding: 0 5px !important;
      grid-column: 2;
    }

    .xr-array-data,
    .xr-array-in:checked ~ .xr-array-preview {
      display: none;
    }

    .xr-array-in:checked ~ .xr-array-data,
    .xr-array-preview {
      display: inline-block;
    }

    .xr-dim-list {
      display: inline-block !important;
      list-style: none;
      padding: 0 !important;
      margin: 0;
    }

    .xr-dim-list li {
      display: inline-block;
      padding: 0;
      margin: 0;
    }

    .xr-dim-list:before {
      content: "(";
    }

    .xr-dim-list:after {
      content: ")";
    }

    .xr-dim-list li:not(:last-child):after {
      content: ",";
      padding-right: 5px;
    }

    .xr-has-index {
      font-weight: bold;
    }

    .xr-var-list,
    .xr-var-item {
      display: contents;
    }

    .xr-var-item > div,
    .xr-var-item label,
    .xr-var-item > .xr-var-name span {
      background-color: var(--xr-background-color-row-even);
      margin-bottom: 0;
    }

    .xr-var-item > .xr-var-name:hover span {
      padding-right: 5px;
    }

    .xr-var-list > li:nth-child(odd) > div,
    .xr-var-list > li:nth-child(odd) > label,
    .xr-var-list > li:nth-child(odd) > .xr-var-name span {
      background-color: var(--xr-background-color-row-odd);
    }

    .xr-var-name {
      grid-column: 1;
    }

    .xr-var-dims {
      grid-column: 2;
    }

    .xr-var-dtype {
      grid-column: 3;
      text-align: right;
      color: var(--xr-font-color2);
    }

    .xr-var-preview {
      grid-column: 4;
    }

    .xr-index-preview {
      grid-column: 2 / 5;
      color: var(--xr-font-color2);
    }

    .xr-var-name,
    .xr-var-dims,
    .xr-var-dtype,
    .xr-preview,
    .xr-attrs dt {
      white-space: nowrap;
      overflow: hidden;
      text-overflow: ellipsis;
      padding-right: 10px;
    }

    .xr-var-name:hover,
    .xr-var-dims:hover,
    .xr-var-dtype:hover,
    .xr-attrs dt:hover {
      overflow: visible;
      width: auto;
      z-index: 1;
    }

    .xr-var-attrs,
    .xr-var-data,
    .xr-index-data {
      display: none;
      background-color: var(--xr-background-color) !important;
      padding-bottom: 5px !important;
    }

    .xr-var-attrs-in:checked ~ .xr-var-attrs,
    .xr-var-data-in:checked ~ .xr-var-data,
    .xr-index-data-in:checked ~ .xr-index-data {
      display: block;
    }

    .xr-var-data > table {
      float: right;
    }

    .xr-var-name span,
    .xr-var-data,
    .xr-index-name div,
    .xr-index-data,
    .xr-attrs {
      padding-left: 25px !important;
    }

    .xr-attrs,
    .xr-var-attrs,
    .xr-var-data,
    .xr-index-data {
      grid-column: 1 / -1;
    }

    dl.xr-attrs {
      padding: 0;
      margin: 0;
      display: grid;
      grid-template-columns: 125px auto;
    }

    .xr-attrs dt,
    .xr-attrs dd {
      padding: 0;
      margin: 0;
      float: left;
      padding-right: 10px;
      width: auto;
    }

    .xr-attrs dt {
      font-weight: normal;
      grid-column: 1;
    }

    .xr-attrs dt:hover span {
      display: inline-block;
      background: var(--xr-background-color);
      padding-right: 10px;
    }

    .xr-attrs dd {
      grid-column: 2;
      white-space: pre-wrap;
      word-break: break-all;
    }

    .xr-icon-database,
    .xr-icon-file-text2,
    .xr-no-icon {
      display: inline-block;
      vertical-align: middle;
      width: 1em;
      height: 1.5em !important;
      stroke-width: 0;
      stroke: currentColor;
      fill: currentColor;
    }
    </style><pre class='xr-text-repr-fallback'>&lt;xarray.Dataset&gt; Size: 1MB
    Dimensions:      (time: 18485, space: 2, keypoints: 6, individuals: 1)
    Coordinates:
      * time         (time) float64 148kB 0.0 0.03333 0.06667 ... 616.1 616.1 616.1
      * space        (space) &lt;U1 8B &#x27;x&#x27; &#x27;y&#x27;
      * keypoints    (keypoints) &lt;U9 216B &#x27;snout&#x27; &#x27;left_ear&#x27; ... &#x27;tail_end&#x27;
      * individuals  (individuals) &lt;U12 48B &#x27;individual_0&#x27;
    Data variables:
        position     (time, space, keypoints, individuals) float32 887kB nan ... ...
        confidence   (time, keypoints, individuals) float32 444kB nan nan ... 0.7607
    Attributes:
        source_software:  SLEAP
        ds_type:          poses
        fps:              30.0
        time_unit:        seconds
        source_file:      /home/runner/.movement/data/poses/SLEAP_single-mouse_EP...
        frame_path:       /home/runner/.movement/data/frames/single-mouse_EPM_fra...</pre><div class='xr-wrap' style='display:none'><div class='xr-header'><div class='xr-obj-type'>xarray.Dataset</div></div><ul class='xr-sections'><li class='xr-section-item'><input id='section-b09fd93a-40fa-4406-818b-fa88d412fa7b' class='xr-section-summary-in' type='checkbox' disabled ><label for='section-b09fd93a-40fa-4406-818b-fa88d412fa7b' class='xr-section-summary'  title='Expand/collapse section'>Dimensions:</label><div class='xr-section-inline-details'><ul class='xr-dim-list'><li><span class='xr-has-index'>time</span>: 18485</li><li><span class='xr-has-index'>space</span>: 2</li><li><span class='xr-has-index'>keypoints</span>: 6</li><li><span class='xr-has-index'>individuals</span>: 1</li></ul></div><div class='xr-section-details'></div></li><li class='xr-section-item'><input id='section-044d10f9-bf35-4358-9ff2-eb134ea6c531' class='xr-section-summary-in' type='checkbox'  checked><label for='section-044d10f9-bf35-4358-9ff2-eb134ea6c531' class='xr-section-summary' >Coordinates: <span>(4)</span></label><div class='xr-section-inline-details'></div><div class='xr-section-details'><ul class='xr-var-list'><li class='xr-var-item'><div class='xr-var-name'><span class='xr-has-index'>time</span></div><div class='xr-var-dims'>(time)</div><div class='xr-var-dtype'>float64</div><div class='xr-var-preview xr-preview'>0.0 0.03333 0.06667 ... 616.1 616.1</div><input id='attrs-65f75a64-2dbf-48b0-890b-4020246e5e1f' class='xr-var-attrs-in' type='checkbox' disabled><label for='attrs-65f75a64-2dbf-48b0-890b-4020246e5e1f' title='Show/Hide attributes'><svg class='icon xr-icon-file-text2'><use xlink:href='#icon-file-text2'></use></svg></label><input id='data-e557f12f-a04c-42c4-99ea-e0f376d39d09' class='xr-var-data-in' type='checkbox'><label for='data-e557f12f-a04c-42c4-99ea-e0f376d39d09' title='Show/Hide data repr'><svg class='icon xr-icon-database'><use xlink:href='#icon-database'></use></svg></label><div class='xr-var-attrs'><dl class='xr-attrs'></dl></div><div class='xr-var-data'><pre>array([0.000000e+00, 3.333333e-02, 6.666667e-02, ..., 6.160667e+02,
           6.161000e+02, 6.161333e+02], shape=(18485,))</pre></div></li><li class='xr-var-item'><div class='xr-var-name'><span class='xr-has-index'>space</span></div><div class='xr-var-dims'>(space)</div><div class='xr-var-dtype'>&lt;U1</div><div class='xr-var-preview xr-preview'>&#x27;x&#x27; &#x27;y&#x27;</div><input id='attrs-c12da517-893c-4daf-b824-610a068dcb8d' class='xr-var-attrs-in' type='checkbox' disabled><label for='attrs-c12da517-893c-4daf-b824-610a068dcb8d' title='Show/Hide attributes'><svg class='icon xr-icon-file-text2'><use xlink:href='#icon-file-text2'></use></svg></label><input id='data-1ddf69de-7031-4d07-a8ab-a6e26bc510db' class='xr-var-data-in' type='checkbox'><label for='data-1ddf69de-7031-4d07-a8ab-a6e26bc510db' title='Show/Hide data repr'><svg class='icon xr-icon-database'><use xlink:href='#icon-database'></use></svg></label><div class='xr-var-attrs'><dl class='xr-attrs'></dl></div><div class='xr-var-data'><pre>array([&#x27;x&#x27;, &#x27;y&#x27;], dtype=&#x27;&lt;U1&#x27;)</pre></div></li><li class='xr-var-item'><div class='xr-var-name'><span class='xr-has-index'>keypoints</span></div><div class='xr-var-dims'>(keypoints)</div><div class='xr-var-dtype'>&lt;U9</div><div class='xr-var-preview xr-preview'>&#x27;snout&#x27; &#x27;left_ear&#x27; ... &#x27;tail_end&#x27;</div><input id='attrs-17c71d87-b195-4c34-b43c-c6abf07d2ef9' class='xr-var-attrs-in' type='checkbox' disabled><label for='attrs-17c71d87-b195-4c34-b43c-c6abf07d2ef9' title='Show/Hide attributes'><svg class='icon xr-icon-file-text2'><use xlink:href='#icon-file-text2'></use></svg></label><input id='data-790ac73c-5bd8-46b4-b2ed-4da0ca4927be' class='xr-var-data-in' type='checkbox'><label for='data-790ac73c-5bd8-46b4-b2ed-4da0ca4927be' title='Show/Hide data repr'><svg class='icon xr-icon-database'><use xlink:href='#icon-database'></use></svg></label><div class='xr-var-attrs'><dl class='xr-attrs'></dl></div><div class='xr-var-data'><pre>array([&#x27;snout&#x27;, &#x27;left_ear&#x27;, &#x27;right_ear&#x27;, &#x27;centre&#x27;, &#x27;tail_base&#x27;, &#x27;tail_end&#x27;],
          dtype=&#x27;&lt;U9&#x27;)</pre></div></li><li class='xr-var-item'><div class='xr-var-name'><span class='xr-has-index'>individuals</span></div><div class='xr-var-dims'>(individuals)</div><div class='xr-var-dtype'>&lt;U12</div><div class='xr-var-preview xr-preview'>&#x27;individual_0&#x27;</div><input id='attrs-f4d831f3-0e86-4210-863d-fe2fa63a0758' class='xr-var-attrs-in' type='checkbox' disabled><label for='attrs-f4d831f3-0e86-4210-863d-fe2fa63a0758' title='Show/Hide attributes'><svg class='icon xr-icon-file-text2'><use xlink:href='#icon-file-text2'></use></svg></label><input id='data-140e8ddf-dd75-48c2-a9ed-21d67f84cf24' class='xr-var-data-in' type='checkbox'><label for='data-140e8ddf-dd75-48c2-a9ed-21d67f84cf24' title='Show/Hide data repr'><svg class='icon xr-icon-database'><use xlink:href='#icon-database'></use></svg></label><div class='xr-var-attrs'><dl class='xr-attrs'></dl></div><div class='xr-var-data'><pre>array([&#x27;individual_0&#x27;], dtype=&#x27;&lt;U12&#x27;)</pre></div></li></ul></div></li><li class='xr-section-item'><input id='section-1a9612ba-2f9d-4e24-9398-762294d84ea9' class='xr-section-summary-in' type='checkbox'  checked><label for='section-1a9612ba-2f9d-4e24-9398-762294d84ea9' class='xr-section-summary' >Data variables: <span>(2)</span></label><div class='xr-section-inline-details'></div><div class='xr-section-details'><ul class='xr-var-list'><li class='xr-var-item'><div class='xr-var-name'><span>position</span></div><div class='xr-var-dims'>(time, space, keypoints, individuals)</div><div class='xr-var-dtype'>float32</div><div class='xr-var-preview xr-preview'>nan nan nan ... 440.4 384.0 476.2</div><input id='attrs-27aea4c6-117c-461e-a0bf-061ca78a07ac' class='xr-var-attrs-in' type='checkbox' ><label for='attrs-27aea4c6-117c-461e-a0bf-061ca78a07ac' title='Show/Hide attributes'><svg class='icon xr-icon-file-text2'><use xlink:href='#icon-file-text2'></use></svg></label><input id='data-0ca46c41-b8c5-4d32-9d1e-070008437cd2' class='xr-var-data-in' type='checkbox'><label for='data-0ca46c41-b8c5-4d32-9d1e-070008437cd2' title='Show/Hide data repr'><svg class='icon xr-icon-database'><use xlink:href='#icon-database'></use></svg></label><div class='xr-var-attrs'><dl class='xr-attrs'><dt><span>log :</span></dt><dd>[{&#x27;operation&#x27;: &#x27;savgol_filter&#x27;, &#x27;datetime&#x27;: &#x27;2025-05-14 09:39:05.283147&#x27;, &#x27;arg_1&#x27;: 6, &#x27;print_report&#x27;: True}]</dd></dl></div><div class='xr-var-data'><pre>array([[[[      nan],
             [      nan],
             [      nan],
             [      nan],
             [      nan],
             [      nan]],

            [[      nan],
             [      nan],
             [      nan],
             [      nan],
             [      nan],
             [      nan]]],


           [[[      nan],
             [      nan],
             [      nan],
             [      nan],
             [      nan],
    ...
             [486.02914],
             [491.82062],
             [439.01932],
             [384.39636],
             [476.5229 ]]],


           [[[685.86224],
             [693.0002 ],
             [668.3964 ],
             [667.8464 ],
             [636.8503 ],
             [588.4095 ]],

            [[505.34033],
             [486.7021 ],
             [492.4088 ],
             [440.36227],
             [384.02908],
             [476.17532]]]], shape=(18485, 2, 6, 1), dtype=float32)</pre></div></li><li class='xr-var-item'><div class='xr-var-name'><span>confidence</span></div><div class='xr-var-dims'>(time, keypoints, individuals)</div><div class='xr-var-dtype'>float32</div><div class='xr-var-preview xr-preview'>nan nan nan ... 0.9336 0.7607</div><input id='attrs-62de8e6f-6771-4c22-9b6c-1aeb3b4ed329' class='xr-var-attrs-in' type='checkbox' disabled><label for='attrs-62de8e6f-6771-4c22-9b6c-1aeb3b4ed329' title='Show/Hide attributes'><svg class='icon xr-icon-file-text2'><use xlink:href='#icon-file-text2'></use></svg></label><input id='data-c98b796f-f2a0-455f-add1-bf60ee650c94' class='xr-var-data-in' type='checkbox'><label for='data-c98b796f-f2a0-455f-add1-bf60ee650c94' title='Show/Hide data repr'><svg class='icon xr-icon-database'><use xlink:href='#icon-database'></use></svg></label><div class='xr-var-attrs'><dl class='xr-attrs'></dl></div><div class='xr-var-data'><pre>array([[[       nan],
            [       nan],
            [       nan],
            [       nan],
            [       nan],
            [       nan]],

           [[       nan],
            [       nan],
            [       nan],
            [       nan],
            [       nan],
            [       nan]],

           [[       nan],
            [       nan],
            [       nan],
            [       nan],
            [       nan],
            [       nan]],
    ...
           [[0.9317396 ],
            [1.0026728 ],
            [1.025079  ],
            [0.92725545],
            [0.95202184],
            [0.7779419 ]],

           [[0.9193515 ],
            [1.0136327 ],
            [1.0336665 ],
            [0.93108493],
            [0.94561106],
            [0.7662804 ]],

           [[0.93820494],
            [1.0224991 ],
            [1.0452943 ],
            [0.9363993 ],
            [0.9335798 ],
            [0.76068705]]], shape=(18485, 6, 1), dtype=float32)</pre></div></li></ul></div></li><li class='xr-section-item'><input id='section-01ca6d29-ecc4-45b6-b2aa-7d9c3d009d8b' class='xr-section-summary-in' type='checkbox'  ><label for='section-01ca6d29-ecc4-45b6-b2aa-7d9c3d009d8b' class='xr-section-summary' >Indexes: <span>(4)</span></label><div class='xr-section-inline-details'></div><div class='xr-section-details'><ul class='xr-var-list'><li class='xr-var-item'><div class='xr-index-name'><div>time</div></div><div class='xr-index-preview'>PandasIndex</div><input type='checkbox' disabled/><label></label><input id='index-bc122e41-66e0-4cb6-8194-9abf721b3a86' class='xr-index-data-in' type='checkbox'/><label for='index-bc122e41-66e0-4cb6-8194-9abf721b3a86' title='Show/Hide index repr'><svg class='icon xr-icon-database'><use xlink:href='#icon-database'></use></svg></label><div class='xr-index-data'><pre>PandasIndex(Index([                0.0, 0.03333333333333333, 0.06666666666666667,
                           0.1, 0.13333333333333333, 0.16666666666666666,
                           0.2, 0.23333333333333334, 0.26666666666666666,
                           0.3,
           ...
             615.8333333333334,   615.8666666666667,               615.9,
             615.9333333333333,   615.9666666666667,               616.0,
             616.0333333333333,   616.0666666666667,               616.1,
             616.1333333333333],
          dtype=&#x27;float64&#x27;, name=&#x27;time&#x27;, length=18485))</pre></div></li><li class='xr-var-item'><div class='xr-index-name'><div>space</div></div><div class='xr-index-preview'>PandasIndex</div><input type='checkbox' disabled/><label></label><input id='index-24b6dfc9-f245-4cd0-a687-dcfee5059bf4' class='xr-index-data-in' type='checkbox'/><label for='index-24b6dfc9-f245-4cd0-a687-dcfee5059bf4' title='Show/Hide index repr'><svg class='icon xr-icon-database'><use xlink:href='#icon-database'></use></svg></label><div class='xr-index-data'><pre>PandasIndex(Index([&#x27;x&#x27;, &#x27;y&#x27;], dtype=&#x27;object&#x27;, name=&#x27;space&#x27;))</pre></div></li><li class='xr-var-item'><div class='xr-index-name'><div>keypoints</div></div><div class='xr-index-preview'>PandasIndex</div><input type='checkbox' disabled/><label></label><input id='index-cae6bb75-0486-4164-aae9-8cd3cf3341d4' class='xr-index-data-in' type='checkbox'/><label for='index-cae6bb75-0486-4164-aae9-8cd3cf3341d4' title='Show/Hide index repr'><svg class='icon xr-icon-database'><use xlink:href='#icon-database'></use></svg></label><div class='xr-index-data'><pre>PandasIndex(Index([&#x27;snout&#x27;, &#x27;left_ear&#x27;, &#x27;right_ear&#x27;, &#x27;centre&#x27;, &#x27;tail_base&#x27;, &#x27;tail_end&#x27;], dtype=&#x27;object&#x27;, name=&#x27;keypoints&#x27;))</pre></div></li><li class='xr-var-item'><div class='xr-index-name'><div>individuals</div></div><div class='xr-index-preview'>PandasIndex</div><input type='checkbox' disabled/><label></label><input id='index-aee9b996-2673-4013-b4f1-b9f74a7de2c1' class='xr-index-data-in' type='checkbox'/><label for='index-aee9b996-2673-4013-b4f1-b9f74a7de2c1' title='Show/Hide index repr'><svg class='icon xr-icon-database'><use xlink:href='#icon-database'></use></svg></label><div class='xr-index-data'><pre>PandasIndex(Index([&#x27;individual_0&#x27;], dtype=&#x27;object&#x27;, name=&#x27;individuals&#x27;))</pre></div></li></ul></div></li><li class='xr-section-item'><input id='section-ae0bdd99-449d-4abf-aef1-1fd3779adba7' class='xr-section-summary-in' type='checkbox'  checked><label for='section-ae0bdd99-449d-4abf-aef1-1fd3779adba7' class='xr-section-summary' >Attributes: <span>(6)</span></label><div class='xr-section-inline-details'></div><div class='xr-section-details'><dl class='xr-attrs'><dt><span>source_software :</span></dt><dd>SLEAP</dd><dt><span>ds_type :</span></dt><dd>poses</dd><dt><span>fps :</span></dt><dd>30.0</dd><dt><span>time_unit :</span></dt><dd>seconds</dd><dt><span>source_file :</span></dt><dd>/home/runner/.movement/data/poses/SLEAP_single-mouse_EPM.analysis.h5</dd><dt><span>frame_path :</span></dt><dd>/home/runner/.movement/data/frames/single-mouse_EPM_frame-20sec.png</dd></dl></div></li></ul></div></div>
    </div>
    <br />
    <br />

.. GENERATED FROM PYTHON SOURCE LINES 290-296

We see that the number of NaN values has increased after filtering. This is
for the same reason as with the rolling filter (in its default mode), i.e.
if there is at least one NaN value in the window, the output will be NaN.
Unlike the rolling filter, the Savitzky-Golay filter does not provide a
``min_periods`` parameter to control this behaviour. Let's visualise the
effects in the time and frequency domains.

.. GENERATED FROM PYTHON SOURCE LINES 296-300

.. code-block:: Python


    plot_raw_and_smooth_timeseries_and_psd(
        ds_mouse, ds_mouse_smooth, keypoint="snout", time_range=slice(0, 80)
    )



.. image-sg:: /examples/images/sphx_glr_smooth_004.png
   :alt: Time Domain, Frequency Domain
   :srcset: /examples/images/sphx_glr_smooth_004.png
   :class: sphx-glr-single-img





.. GENERATED FROM PYTHON SOURCE LINES 301-303

Once again, the power of high-frequency components has been reduced, but more
missing values have been introduced.

.. GENERATED FROM PYTHON SOURCE LINES 305-306

Now let's apply the same Savitzky-Golay filter to the wasp dataset.

.. GENERATED FROM PYTHON SOURCE LINES 306-312

.. code-block:: Python


    window = int(0.2 * ds_wasp.fps)
    ds_wasp_smooth.update(
        {"position": savgol_filter(ds_wasp.position, window, print_report=True)}
    )





.. rst-class:: sphx-glr-script-out

 .. code-block:: none


    Missing points (marked as NaN) in input
            Individual: individual_0
                    head: 0/1085 (0.0%)
                    stinger: 0/1085 (0.0%)

    Missing points (marked as NaN) in output
            Individual: individual_0
                    head: 0/1085 (0.0%)
                    stinger: 0/1085 (0.0%)


.. raw:: html

    <div class="output_subarea output_html rendered_html output_result">
    <div><svg style="position: absolute; width: 0; height: 0; overflow: hidden">
    <defs>
    <symbol id="icon-database" viewBox="0 0 32 32">
    <path d="M16 0c-8.837 0-16 2.239-16 5v4c0 2.761 7.163 5 16 5s16-2.239 16-5v-4c0-2.761-7.163-5-16-5z"></path>
    <path d="M16 17c-8.837 0-16-2.239-16-5v6c0 2.761 7.163 5 16 5s16-2.239 16-5v-6c0 2.761-7.163 5-16 5z"></path>
    <path d="M16 26c-8.837 0-16-2.239-16-5v6c0 2.761 7.163 5 16 5s16-2.239 16-5v-6c0 2.761-7.163 5-16 5z"></path>
    </symbol>
    <symbol id="icon-file-text2" viewBox="0 0 32 32">
    <path d="M28.681 7.159c-0.694-0.947-1.662-2.053-2.724-3.116s-2.169-2.030-3.116-2.724c-1.612-1.182-2.393-1.319-2.841-1.319h-15.5c-1.378 0-2.5 1.121-2.5 2.5v27c0 1.378 1.122 2.5 2.5 2.5h23c1.378 0 2.5-1.122 2.5-2.5v-19.5c0-0.448-0.137-1.23-1.319-2.841zM24.543 5.457c0.959 0.959 1.712 1.825 2.268 2.543h-4.811v-4.811c0.718 0.556 1.584 1.309 2.543 2.268zM28 29.5c0 0.271-0.229 0.5-0.5 0.5h-23c-0.271 0-0.5-0.229-0.5-0.5v-27c0-0.271 0.229-0.5 0.5-0.5 0 0 15.499-0 15.5 0v7c0 0.552 0.448 1 1 1h7v19.5z"></path>
    <path d="M23 26h-14c-0.552 0-1-0.448-1-1s0.448-1 1-1h14c0.552 0 1 0.448 1 1s-0.448 1-1 1z"></path>
    <path d="M23 22h-14c-0.552 0-1-0.448-1-1s0.448-1 1-1h14c0.552 0 1 0.448 1 1s-0.448 1-1 1z"></path>
    <path d="M23 18h-14c-0.552 0-1-0.448-1-1s0.448-1 1-1h14c0.552 0 1 0.448 1 1s-0.448 1-1 1z"></path>
    </symbol>
    </defs>
    </svg>
    <style>/* CSS stylesheet for displaying xarray objects in jupyterlab.
     *
     */

    :root {
      --xr-font-color0: var(--jp-content-font-color0, rgba(0, 0, 0, 1));
      --xr-font-color2: var(--jp-content-font-color2, rgba(0, 0, 0, 0.54));
      --xr-font-color3: var(--jp-content-font-color3, rgba(0, 0, 0, 0.38));
      --xr-border-color: var(--jp-border-color2, #e0e0e0);
      --xr-disabled-color: var(--jp-layout-color3, #bdbdbd);
      --xr-background-color: var(--jp-layout-color0, white);
      --xr-background-color-row-even: var(--jp-layout-color1, white);
      --xr-background-color-row-odd: var(--jp-layout-color2, #eeeeee);
    }

    html[theme="dark"],
    html[data-theme="dark"],
    body[data-theme="dark"],
    body.vscode-dark {
      --xr-font-color0: rgba(255, 255, 255, 1);
      --xr-font-color2: rgba(255, 255, 255, 0.54);
      --xr-font-color3: rgba(255, 255, 255, 0.38);
      --xr-border-color: #1f1f1f;
      --xr-disabled-color: #515151;
      --xr-background-color: #111111;
      --xr-background-color-row-even: #111111;
      --xr-background-color-row-odd: #313131;
    }

    .xr-wrap {
      display: block !important;
      min-width: 300px;
      max-width: 700px;
    }

    .xr-text-repr-fallback {
      /* fallback to plain text repr when CSS is not injected (untrusted notebook) */
      display: none;
    }

    .xr-header {
      padding-top: 6px;
      padding-bottom: 6px;
      margin-bottom: 4px;
      border-bottom: solid 1px var(--xr-border-color);
    }

    .xr-header > div,
    .xr-header > ul {
      display: inline;
      margin-top: 0;
      margin-bottom: 0;
    }

    .xr-obj-type,
    .xr-array-name {
      margin-left: 2px;
      margin-right: 10px;
    }

    .xr-obj-type {
      color: var(--xr-font-color2);
    }

    .xr-sections {
      padding-left: 0 !important;
      display: grid;
      grid-template-columns: 150px auto auto 1fr 0 20px 0 20px;
    }

    .xr-section-item {
      display: contents;
    }

    .xr-section-item input {
      display: inline-block;
      opacity: 0;
      height: 0;
    }

    .xr-section-item input + label {
      color: var(--xr-disabled-color);
    }

    .xr-section-item input:enabled + label {
      cursor: pointer;
      color: var(--xr-font-color2);
    }

    .xr-section-item input:focus + label {
      border: 2px solid var(--xr-font-color0);
    }

    .xr-section-item input:enabled + label:hover {
      color: var(--xr-font-color0);
    }

    .xr-section-summary {
      grid-column: 1;
      color: var(--xr-font-color2);
      font-weight: 500;
    }

    .xr-section-summary > span {
      display: inline-block;
      padding-left: 0.5em;
    }

    .xr-section-summary-in:disabled + label {
      color: var(--xr-font-color2);
    }

    .xr-section-summary-in + label:before {
      display: inline-block;
      content: "►";
      font-size: 11px;
      width: 15px;
      text-align: center;
    }

    .xr-section-summary-in:disabled + label:before {
      color: var(--xr-disabled-color);
    }

    .xr-section-summary-in:checked + label:before {
      content: "▼";
    }

    .xr-section-summary-in:checked + label > span {
      display: none;
    }

    .xr-section-summary,
    .xr-section-inline-details {
      padding-top: 4px;
      padding-bottom: 4px;
    }

    .xr-section-inline-details {
      grid-column: 2 / -1;
    }

    .xr-section-details {
      display: none;
      grid-column: 1 / -1;
      margin-bottom: 5px;
    }

    .xr-section-summary-in:checked ~ .xr-section-details {
      display: contents;
    }

    .xr-array-wrap {
      grid-column: 1 / -1;
      display: grid;
      grid-template-columns: 20px auto;
    }

    .xr-array-wrap > label {
      grid-column: 1;
      vertical-align: top;
    }

    .xr-preview {
      color: var(--xr-font-color3);
    }

    .xr-array-preview,
    .xr-array-data {
      padding: 0 5px !important;
      grid-column: 2;
    }

    .xr-array-data,
    .xr-array-in:checked ~ .xr-array-preview {
      display: none;
    }

    .xr-array-in:checked ~ .xr-array-data,
    .xr-array-preview {
      display: inline-block;
    }

    .xr-dim-list {
      display: inline-block !important;
      list-style: none;
      padding: 0 !important;
      margin: 0;
    }

    .xr-dim-list li {
      display: inline-block;
      padding: 0;
      margin: 0;
    }

    .xr-dim-list:before {
      content: "(";
    }

    .xr-dim-list:after {
      content: ")";
    }

    .xr-dim-list li:not(:last-child):after {
      content: ",";
      padding-right: 5px;
    }

    .xr-has-index {
      font-weight: bold;
    }

    .xr-var-list,
    .xr-var-item {
      display: contents;
    }

    .xr-var-item > div,
    .xr-var-item label,
    .xr-var-item > .xr-var-name span {
      background-color: var(--xr-background-color-row-even);
      margin-bottom: 0;
    }

    .xr-var-item > .xr-var-name:hover span {
      padding-right: 5px;
    }

    .xr-var-list > li:nth-child(odd) > div,
    .xr-var-list > li:nth-child(odd) > label,
    .xr-var-list > li:nth-child(odd) > .xr-var-name span {
      background-color: var(--xr-background-color-row-odd);
    }

    .xr-var-name {
      grid-column: 1;
    }

    .xr-var-dims {
      grid-column: 2;
    }

    .xr-var-dtype {
      grid-column: 3;
      text-align: right;
      color: var(--xr-font-color2);
    }

    .xr-var-preview {
      grid-column: 4;
    }

    .xr-index-preview {
      grid-column: 2 / 5;
      color: var(--xr-font-color2);
    }

    .xr-var-name,
    .xr-var-dims,
    .xr-var-dtype,
    .xr-preview,
    .xr-attrs dt {
      white-space: nowrap;
      overflow: hidden;
      text-overflow: ellipsis;
      padding-right: 10px;
    }

    .xr-var-name:hover,
    .xr-var-dims:hover,
    .xr-var-dtype:hover,
    .xr-attrs dt:hover {
      overflow: visible;
      width: auto;
      z-index: 1;
    }

    .xr-var-attrs,
    .xr-var-data,
    .xr-index-data {
      display: none;
      background-color: var(--xr-background-color) !important;
      padding-bottom: 5px !important;
    }

    .xr-var-attrs-in:checked ~ .xr-var-attrs,
    .xr-var-data-in:checked ~ .xr-var-data,
    .xr-index-data-in:checked ~ .xr-index-data {
      display: block;
    }

    .xr-var-data > table {
      float: right;
    }

    .xr-var-name span,
    .xr-var-data,
    .xr-index-name div,
    .xr-index-data,
    .xr-attrs {
      padding-left: 25px !important;
    }

    .xr-attrs,
    .xr-var-attrs,
    .xr-var-data,
    .xr-index-data {
      grid-column: 1 / -1;
    }

    dl.xr-attrs {
      padding: 0;
      margin: 0;
      display: grid;
      grid-template-columns: 125px auto;
    }

    .xr-attrs dt,
    .xr-attrs dd {
      padding: 0;
      margin: 0;
      float: left;
      padding-right: 10px;
      width: auto;
    }

    .xr-attrs dt {
      font-weight: normal;
      grid-column: 1;
    }

    .xr-attrs dt:hover span {
      display: inline-block;
      background: var(--xr-background-color);
      padding-right: 10px;
    }

    .xr-attrs dd {
      grid-column: 2;
      white-space: pre-wrap;
      word-break: break-all;
    }

    .xr-icon-database,
    .xr-icon-file-text2,
    .xr-no-icon {
      display: inline-block;
      vertical-align: middle;
      width: 1em;
      height: 1.5em !important;
      stroke-width: 0;
      stroke: currentColor;
      fill: currentColor;
    }
    </style><pre class='xr-text-repr-fallback'>&lt;xarray.Dataset&gt; Size: 61kB
    Dimensions:      (time: 1085, space: 2, keypoints: 2, individuals: 1)
    Coordinates:
      * time         (time) float64 9kB 0.0 0.025 0.05 0.075 ... 27.05 27.07 27.1
      * space        (space) &lt;U1 8B &#x27;x&#x27; &#x27;y&#x27;
      * keypoints    (keypoints) &lt;U7 56B &#x27;head&#x27; &#x27;stinger&#x27;
      * individuals  (individuals) &lt;U12 48B &#x27;individual_0&#x27;
    Data variables:
        position     (time, space, keypoints, individuals) float64 35kB 1.086e+03...
        confidence   (time, keypoints, individuals) float64 17kB 0.05305 ... 0.0
    Attributes:
        source_software:  DeepLabCut
        ds_type:          poses
        fps:              40.0
        time_unit:        seconds
        source_file:      /home/runner/.movement/data/poses/DLC_single-wasp.predi...
        frame_path:       /home/runner/.movement/data/frames/single-wasp_frame-10...</pre><div class='xr-wrap' style='display:none'><div class='xr-header'><div class='xr-obj-type'>xarray.Dataset</div></div><ul class='xr-sections'><li class='xr-section-item'><input id='section-97343db7-7fae-4aea-b57d-600c77bc6a8d' class='xr-section-summary-in' type='checkbox' disabled ><label for='section-97343db7-7fae-4aea-b57d-600c77bc6a8d' class='xr-section-summary'  title='Expand/collapse section'>Dimensions:</label><div class='xr-section-inline-details'><ul class='xr-dim-list'><li><span class='xr-has-index'>time</span>: 1085</li><li><span class='xr-has-index'>space</span>: 2</li><li><span class='xr-has-index'>keypoints</span>: 2</li><li><span class='xr-has-index'>individuals</span>: 1</li></ul></div><div class='xr-section-details'></div></li><li class='xr-section-item'><input id='section-095b8b3d-057b-4db5-8c73-ead647574574' class='xr-section-summary-in' type='checkbox'  checked><label for='section-095b8b3d-057b-4db5-8c73-ead647574574' class='xr-section-summary' >Coordinates: <span>(4)</span></label><div class='xr-section-inline-details'></div><div class='xr-section-details'><ul class='xr-var-list'><li class='xr-var-item'><div class='xr-var-name'><span class='xr-has-index'>time</span></div><div class='xr-var-dims'>(time)</div><div class='xr-var-dtype'>float64</div><div class='xr-var-preview xr-preview'>0.0 0.025 0.05 ... 27.05 27.07 27.1</div><input id='attrs-d539e532-1e49-42c7-b25e-af5a02072abf' class='xr-var-attrs-in' type='checkbox' disabled><label for='attrs-d539e532-1e49-42c7-b25e-af5a02072abf' title='Show/Hide attributes'><svg class='icon xr-icon-file-text2'><use xlink:href='#icon-file-text2'></use></svg></label><input id='data-867937a4-1702-48c8-a98d-94b0d86fd091' class='xr-var-data-in' type='checkbox'><label for='data-867937a4-1702-48c8-a98d-94b0d86fd091' title='Show/Hide data repr'><svg class='icon xr-icon-database'><use xlink:href='#icon-database'></use></svg></label><div class='xr-var-attrs'><dl class='xr-attrs'></dl></div><div class='xr-var-data'><pre>array([0.0000e+00, 2.5000e-02, 5.0000e-02, ..., 2.7050e+01, 2.7075e+01,
           2.7100e+01], shape=(1085,))</pre></div></li><li class='xr-var-item'><div class='xr-var-name'><span class='xr-has-index'>space</span></div><div class='xr-var-dims'>(space)</div><div class='xr-var-dtype'>&lt;U1</div><div class='xr-var-preview xr-preview'>&#x27;x&#x27; &#x27;y&#x27;</div><input id='attrs-e47ffd55-ab94-4397-9a4e-84b1b848cc5a' class='xr-var-attrs-in' type='checkbox' disabled><label for='attrs-e47ffd55-ab94-4397-9a4e-84b1b848cc5a' title='Show/Hide attributes'><svg class='icon xr-icon-file-text2'><use xlink:href='#icon-file-text2'></use></svg></label><input id='data-64df34cd-27d5-42e1-bcee-5ce8d4b76180' class='xr-var-data-in' type='checkbox'><label for='data-64df34cd-27d5-42e1-bcee-5ce8d4b76180' title='Show/Hide data repr'><svg class='icon xr-icon-database'><use xlink:href='#icon-database'></use></svg></label><div class='xr-var-attrs'><dl class='xr-attrs'></dl></div><div class='xr-var-data'><pre>array([&#x27;x&#x27;, &#x27;y&#x27;], dtype=&#x27;&lt;U1&#x27;)</pre></div></li><li class='xr-var-item'><div class='xr-var-name'><span class='xr-has-index'>keypoints</span></div><div class='xr-var-dims'>(keypoints)</div><div class='xr-var-dtype'>&lt;U7</div><div class='xr-var-preview xr-preview'>&#x27;head&#x27; &#x27;stinger&#x27;</div><input id='attrs-fba85ae5-91ed-4e84-9d39-4485b4cf1b2a' class='xr-var-attrs-in' type='checkbox' disabled><label for='attrs-fba85ae5-91ed-4e84-9d39-4485b4cf1b2a' title='Show/Hide attributes'><svg class='icon xr-icon-file-text2'><use xlink:href='#icon-file-text2'></use></svg></label><input id='data-f35dbcd6-275a-43d7-8c53-d7539b93e5c0' class='xr-var-data-in' type='checkbox'><label for='data-f35dbcd6-275a-43d7-8c53-d7539b93e5c0' title='Show/Hide data repr'><svg class='icon xr-icon-database'><use xlink:href='#icon-database'></use></svg></label><div class='xr-var-attrs'><dl class='xr-attrs'></dl></div><div class='xr-var-data'><pre>array([&#x27;head&#x27;, &#x27;stinger&#x27;], dtype=&#x27;&lt;U7&#x27;)</pre></div></li><li class='xr-var-item'><div class='xr-var-name'><span class='xr-has-index'>individuals</span></div><div class='xr-var-dims'>(individuals)</div><div class='xr-var-dtype'>&lt;U12</div><div class='xr-var-preview xr-preview'>&#x27;individual_0&#x27;</div><input id='attrs-48d8a517-5aad-44e7-ae5c-a0c364602ccb' class='xr-var-attrs-in' type='checkbox' disabled><label for='attrs-48d8a517-5aad-44e7-ae5c-a0c364602ccb' title='Show/Hide attributes'><svg class='icon xr-icon-file-text2'><use xlink:href='#icon-file-text2'></use></svg></label><input id='data-10235da2-33cc-486e-9910-1088ab8e3262' class='xr-var-data-in' type='checkbox'><label for='data-10235da2-33cc-486e-9910-1088ab8e3262' title='Show/Hide data repr'><svg class='icon xr-icon-database'><use xlink:href='#icon-database'></use></svg></label><div class='xr-var-attrs'><dl class='xr-attrs'></dl></div><div class='xr-var-data'><pre>array([&#x27;individual_0&#x27;], dtype=&#x27;&lt;U12&#x27;)</pre></div></li></ul></div></li><li class='xr-section-item'><input id='section-42ffb60d-4eda-4502-bce7-c8db0c350e1b' class='xr-section-summary-in' type='checkbox'  checked><label for='section-42ffb60d-4eda-4502-bce7-c8db0c350e1b' class='xr-section-summary' >Data variables: <span>(2)</span></label><div class='xr-section-inline-details'></div><div class='xr-section-details'><ul class='xr-var-list'><li class='xr-var-item'><div class='xr-var-name'><span>position</span></div><div class='xr-var-dims'>(time, space, keypoints, individuals)</div><div class='xr-var-dtype'>float64</div><div class='xr-var-preview xr-preview'>1.086e+03 1.084e+03 ... 0.0 0.0</div><input id='attrs-41ca11fe-925d-46e1-9a75-83a92dbe1f8e' class='xr-var-attrs-in' type='checkbox' ><label for='attrs-41ca11fe-925d-46e1-9a75-83a92dbe1f8e' title='Show/Hide attributes'><svg class='icon xr-icon-file-text2'><use xlink:href='#icon-file-text2'></use></svg></label><input id='data-9bbe350f-356c-408e-a122-03cd7511d9db' class='xr-var-data-in' type='checkbox'><label for='data-9bbe350f-356c-408e-a122-03cd7511d9db' title='Show/Hide data repr'><svg class='icon xr-icon-database'><use xlink:href='#icon-database'></use></svg></label><div class='xr-var-attrs'><dl class='xr-attrs'><dt><span>log :</span></dt><dd>[{&#x27;operation&#x27;: &#x27;savgol_filter&#x27;, &#x27;datetime&#x27;: &#x27;2025-05-14 09:39:05.518333&#x27;, &#x27;arg_1&#x27;: 8, &#x27;print_report&#x27;: True}]</dd></dl></div><div class='xr-var-data'><pre>array([[[[1086.21587626],
             [1084.39068604]],

            [[ 421.48088328],
             [ 420.21653112]]],


           [[[1085.91406323],
             [1083.25480725]],

            [[ 421.67755381],
             [ 422.10508746]]],


           [[[1085.62648446],
             [1082.09089007]],

            [[ 421.90293339],
             [ 423.7017152 ]]],

    ...

           [[[   0.        ],
             [   0.        ]],

            [[   0.        ],
             [   0.        ]]],


           [[[   0.        ],
             [   0.        ]],

            [[   0.        ],
             [   0.        ]]],


           [[[   0.        ],
             [   0.        ]],

            [[   0.        ],
             [   0.        ]]]], shape=(1085, 2, 2, 1))</pre></div></li><li class='xr-var-item'><div class='xr-var-name'><span>confidence</span></div><div class='xr-var-dims'>(time, keypoints, individuals)</div><div class='xr-var-dtype'>float64</div><div class='xr-var-preview xr-preview'>0.05305 0.07366 0.03532 ... 0.0 0.0</div><input id='attrs-2a732852-4313-49d9-86ad-392817adbc9a' class='xr-var-attrs-in' type='checkbox' disabled><label for='attrs-2a732852-4313-49d9-86ad-392817adbc9a' title='Show/Hide attributes'><svg class='icon xr-icon-file-text2'><use xlink:href='#icon-file-text2'></use></svg></label><input id='data-09f02c82-ceec-4011-afb3-54e4f253c7d2' class='xr-var-data-in' type='checkbox'><label for='data-09f02c82-ceec-4011-afb3-54e4f253c7d2' title='Show/Hide data repr'><svg class='icon xr-icon-database'><use xlink:href='#icon-database'></use></svg></label><div class='xr-var-attrs'><dl class='xr-attrs'></dl></div><div class='xr-var-data'><pre>array([[[0.05305099],
            [0.07366323]],

           [[0.03531652],
            [0.03293059]],

           [[0.01706707],
            [0.01022208]],

           ...,

           [[0.        ],
            [0.        ]],

           [[0.        ],
            [0.        ]],

           [[0.        ],
            [0.        ]]], shape=(1085, 2, 1))</pre></div></li></ul></div></li><li class='xr-section-item'><input id='section-0f858b6c-a5b8-4bd4-9709-df1574263ba5' class='xr-section-summary-in' type='checkbox'  ><label for='section-0f858b6c-a5b8-4bd4-9709-df1574263ba5' class='xr-section-summary' >Indexes: <span>(4)</span></label><div class='xr-section-inline-details'></div><div class='xr-section-details'><ul class='xr-var-list'><li class='xr-var-item'><div class='xr-index-name'><div>time</div></div><div class='xr-index-preview'>PandasIndex</div><input type='checkbox' disabled/><label></label><input id='index-7c1b58db-e46b-470e-8585-35343e081e89' class='xr-index-data-in' type='checkbox'/><label for='index-7c1b58db-e46b-470e-8585-35343e081e89' title='Show/Hide index repr'><svg class='icon xr-icon-database'><use xlink:href='#icon-database'></use></svg></label><div class='xr-index-data'><pre>PandasIndex(Index([   0.0,  0.025,   0.05,  0.075,    0.1,  0.125,   0.15,  0.175,    0.2,
            0.225,
           ...
           26.875,   26.9, 26.925,  26.95, 26.975,   27.0, 27.025,  27.05, 27.075,
             27.1],
          dtype=&#x27;float64&#x27;, name=&#x27;time&#x27;, length=1085))</pre></div></li><li class='xr-var-item'><div class='xr-index-name'><div>space</div></div><div class='xr-index-preview'>PandasIndex</div><input type='checkbox' disabled/><label></label><input id='index-c95550a8-3a71-4ac4-b2a9-7949fd256ee6' class='xr-index-data-in' type='checkbox'/><label for='index-c95550a8-3a71-4ac4-b2a9-7949fd256ee6' title='Show/Hide index repr'><svg class='icon xr-icon-database'><use xlink:href='#icon-database'></use></svg></label><div class='xr-index-data'><pre>PandasIndex(Index([&#x27;x&#x27;, &#x27;y&#x27;], dtype=&#x27;object&#x27;, name=&#x27;space&#x27;))</pre></div></li><li class='xr-var-item'><div class='xr-index-name'><div>keypoints</div></div><div class='xr-index-preview'>PandasIndex</div><input type='checkbox' disabled/><label></label><input id='index-adf9f2db-84af-4c20-9f36-0693359071bf' class='xr-index-data-in' type='checkbox'/><label for='index-adf9f2db-84af-4c20-9f36-0693359071bf' title='Show/Hide index repr'><svg class='icon xr-icon-database'><use xlink:href='#icon-database'></use></svg></label><div class='xr-index-data'><pre>PandasIndex(Index([&#x27;head&#x27;, &#x27;stinger&#x27;], dtype=&#x27;object&#x27;, name=&#x27;keypoints&#x27;))</pre></div></li><li class='xr-var-item'><div class='xr-index-name'><div>individuals</div></div><div class='xr-index-preview'>PandasIndex</div><input type='checkbox' disabled/><label></label><input id='index-182a7428-03ec-4ce9-8016-32fc369131ad' class='xr-index-data-in' type='checkbox'/><label for='index-182a7428-03ec-4ce9-8016-32fc369131ad' title='Show/Hide index repr'><svg class='icon xr-icon-database'><use xlink:href='#icon-database'></use></svg></label><div class='xr-index-data'><pre>PandasIndex(Index([&#x27;individual_0&#x27;], dtype=&#x27;object&#x27;, name=&#x27;individuals&#x27;))</pre></div></li></ul></div></li><li class='xr-section-item'><input id='section-9b328d6f-5f00-4a4c-a7b2-873af6c90696' class='xr-section-summary-in' type='checkbox'  checked><label for='section-9b328d6f-5f00-4a4c-a7b2-873af6c90696' class='xr-section-summary' >Attributes: <span>(6)</span></label><div class='xr-section-inline-details'></div><div class='xr-section-details'><dl class='xr-attrs'><dt><span>source_software :</span></dt><dd>DeepLabCut</dd><dt><span>ds_type :</span></dt><dd>poses</dd><dt><span>fps :</span></dt><dd>40.0</dd><dt><span>time_unit :</span></dt><dd>seconds</dd><dt><span>source_file :</span></dt><dd>/home/runner/.movement/data/poses/DLC_single-wasp.predictions.h5</dd><dt><span>frame_path :</span></dt><dd>/home/runner/.movement/data/frames/single-wasp_frame-10sec.png</dd></dl></div></li></ul></div></div>
    </div>
    <br />
    <br />

.. GENERATED FROM PYTHON SOURCE LINES 313-316

.. code-block:: Python

    plot_raw_and_smooth_timeseries_and_psd(
        ds_wasp, ds_wasp_smooth, keypoint="stinger"
    )



.. image-sg:: /examples/images/sphx_glr_smooth_005.png
   :alt: Time Domain, Frequency Domain
   :srcset: /examples/images/sphx_glr_smooth_005.png
   :class: sphx-glr-single-img





.. GENERATED FROM PYTHON SOURCE LINES 317-325

This example shows two important limitations of the Savitzky-Golay filter.
First, the filter can introduce artefacts around sharp boundaries. For
example, focus on what happens around the sudden drop in position
during the final second. Second, the PSD appears to have large periodic
drops at certain frequencies. Both of these effects vary with the
choice of ``window`` and ``polyorder``. You can read more about these
and other limitations of the Savitzky-Golay filter in
`this paper <https://pubs.acs.org/doi/10.1021/acsmeasuresciau.1c00054>`_.

.. GENERATED FROM PYTHON SOURCE LINES 328-336

Combining multiple smoothing filters
------------------------------------
We can also combine multiple smoothing filters by applying them
sequentially. For example, we can first apply the rolling median filter with
a small ``window`` to remove "spikes" and then apply the Savitzky-Golay
filter with a larger ``window`` to further smooth the data.
Between the two filters, we can interpolate over small gaps to avoid the
excessive proliferation of NaN values. Let's try this on the mouse dataset.

.. GENERATED FROM PYTHON SOURCE LINES 336-360

.. code-block:: Python


    # First, we will apply the rolling median filter.
    window = int(0.1 * ds_mouse.fps)
    ds_mouse_smooth.update(
        {
            "position": rolling_filter(
                ds_mouse.position, window, min_periods=2, statistic="median"
            )
        }
    )

    # Next, let's linearly interpolate over gaps smaller
    # than 1 second (30 frames).
    ds_mouse_smooth.update(
        {"position": interpolate_over_time(ds_mouse_smooth.position, max_gap=30)}
    )

    # Finally, let's apply the Savitzky-Golay filter
    # over a 0.4-second window (12 frames).
    window = int(0.4 * ds_mouse.fps)
    ds_mouse_smooth.update(
        {"position": savgol_filter(ds_mouse_smooth.position, window)}
    )






.. raw:: html

    <div class="output_subarea output_html rendered_html output_result">
    <div><svg style="position: absolute; width: 0; height: 0; overflow: hidden">
    <defs>
    <symbol id="icon-database" viewBox="0 0 32 32">
    <path d="M16 0c-8.837 0-16 2.239-16 5v4c0 2.761 7.163 5 16 5s16-2.239 16-5v-4c0-2.761-7.163-5-16-5z"></path>
    <path d="M16 17c-8.837 0-16-2.239-16-5v6c0 2.761 7.163 5 16 5s16-2.239 16-5v-6c0 2.761-7.163 5-16 5z"></path>
    <path d="M16 26c-8.837 0-16-2.239-16-5v6c0 2.761 7.163 5 16 5s16-2.239 16-5v-6c0 2.761-7.163 5-16 5z"></path>
    </symbol>
    <symbol id="icon-file-text2" viewBox="0 0 32 32">
    <path d="M28.681 7.159c-0.694-0.947-1.662-2.053-2.724-3.116s-2.169-2.030-3.116-2.724c-1.612-1.182-2.393-1.319-2.841-1.319h-15.5c-1.378 0-2.5 1.121-2.5 2.5v27c0 1.378 1.122 2.5 2.5 2.5h23c1.378 0 2.5-1.122 2.5-2.5v-19.5c0-0.448-0.137-1.23-1.319-2.841zM24.543 5.457c0.959 0.959 1.712 1.825 2.268 2.543h-4.811v-4.811c0.718 0.556 1.584 1.309 2.543 2.268zM28 29.5c0 0.271-0.229 0.5-0.5 0.5h-23c-0.271 0-0.5-0.229-0.5-0.5v-27c0-0.271 0.229-0.5 0.5-0.5 0 0 15.499-0 15.5 0v7c0 0.552 0.448 1 1 1h7v19.5z"></path>
    <path d="M23 26h-14c-0.552 0-1-0.448-1-1s0.448-1 1-1h14c0.552 0 1 0.448 1 1s-0.448 1-1 1z"></path>
    <path d="M23 22h-14c-0.552 0-1-0.448-1-1s0.448-1 1-1h14c0.552 0 1 0.448 1 1s-0.448 1-1 1z"></path>
    <path d="M23 18h-14c-0.552 0-1-0.448-1-1s0.448-1 1-1h14c0.552 0 1 0.448 1 1s-0.448 1-1 1z"></path>
    </symbol>
    </defs>
    </svg>
    <style>/* CSS stylesheet for displaying xarray objects in jupyterlab.
     *
     */

    :root {
      --xr-font-color0: var(--jp-content-font-color0, rgba(0, 0, 0, 1));
      --xr-font-color2: var(--jp-content-font-color2, rgba(0, 0, 0, 0.54));
      --xr-font-color3: var(--jp-content-font-color3, rgba(0, 0, 0, 0.38));
      --xr-border-color: var(--jp-border-color2, #e0e0e0);
      --xr-disabled-color: var(--jp-layout-color3, #bdbdbd);
      --xr-background-color: var(--jp-layout-color0, white);
      --xr-background-color-row-even: var(--jp-layout-color1, white);
      --xr-background-color-row-odd: var(--jp-layout-color2, #eeeeee);
    }

    html[theme="dark"],
    html[data-theme="dark"],
    body[data-theme="dark"],
    body.vscode-dark {
      --xr-font-color0: rgba(255, 255, 255, 1);
      --xr-font-color2: rgba(255, 255, 255, 0.54);
      --xr-font-color3: rgba(255, 255, 255, 0.38);
      --xr-border-color: #1f1f1f;
      --xr-disabled-color: #515151;
      --xr-background-color: #111111;
      --xr-background-color-row-even: #111111;
      --xr-background-color-row-odd: #313131;
    }

    .xr-wrap {
      display: block !important;
      min-width: 300px;
      max-width: 700px;
    }

    .xr-text-repr-fallback {
      /* fallback to plain text repr when CSS is not injected (untrusted notebook) */
      display: none;
    }

    .xr-header {
      padding-top: 6px;
      padding-bottom: 6px;
      margin-bottom: 4px;
      border-bottom: solid 1px var(--xr-border-color);
    }

    .xr-header > div,
    .xr-header > ul {
      display: inline;
      margin-top: 0;
      margin-bottom: 0;
    }

    .xr-obj-type,
    .xr-array-name {
      margin-left: 2px;
      margin-right: 10px;
    }

    .xr-obj-type {
      color: var(--xr-font-color2);
    }

    .xr-sections {
      padding-left: 0 !important;
      display: grid;
      grid-template-columns: 150px auto auto 1fr 0 20px 0 20px;
    }

    .xr-section-item {
      display: contents;
    }

    .xr-section-item input {
      display: inline-block;
      opacity: 0;
      height: 0;
    }

    .xr-section-item input + label {
      color: var(--xr-disabled-color);
    }

    .xr-section-item input:enabled + label {
      cursor: pointer;
      color: var(--xr-font-color2);
    }

    .xr-section-item input:focus + label {
      border: 2px solid var(--xr-font-color0);
    }

    .xr-section-item input:enabled + label:hover {
      color: var(--xr-font-color0);
    }

    .xr-section-summary {
      grid-column: 1;
      color: var(--xr-font-color2);
      font-weight: 500;
    }

    .xr-section-summary > span {
      display: inline-block;
      padding-left: 0.5em;
    }

    .xr-section-summary-in:disabled + label {
      color: var(--xr-font-color2);
    }

    .xr-section-summary-in + label:before {
      display: inline-block;
      content: "►";
      font-size: 11px;
      width: 15px;
      text-align: center;
    }

    .xr-section-summary-in:disabled + label:before {
      color: var(--xr-disabled-color);
    }

    .xr-section-summary-in:checked + label:before {
      content: "▼";
    }

    .xr-section-summary-in:checked + label > span {
      display: none;
    }

    .xr-section-summary,
    .xr-section-inline-details {
      padding-top: 4px;
      padding-bottom: 4px;
    }

    .xr-section-inline-details {
      grid-column: 2 / -1;
    }

    .xr-section-details {
      display: none;
      grid-column: 1 / -1;
      margin-bottom: 5px;
    }

    .xr-section-summary-in:checked ~ .xr-section-details {
      display: contents;
    }

    .xr-array-wrap {
      grid-column: 1 / -1;
      display: grid;
      grid-template-columns: 20px auto;
    }

    .xr-array-wrap > label {
      grid-column: 1;
      vertical-align: top;
    }

    .xr-preview {
      color: var(--xr-font-color3);
    }

    .xr-array-preview,
    .xr-array-data {
      padding: 0 5px !important;
      grid-column: 2;
    }

    .xr-array-data,
    .xr-array-in:checked ~ .xr-array-preview {
      display: none;
    }

    .xr-array-in:checked ~ .xr-array-data,
    .xr-array-preview {
      display: inline-block;
    }

    .xr-dim-list {
      display: inline-block !important;
      list-style: none;
      padding: 0 !important;
      margin: 0;
    }

    .xr-dim-list li {
      display: inline-block;
      padding: 0;
      margin: 0;
    }

    .xr-dim-list:before {
      content: "(";
    }

    .xr-dim-list:after {
      content: ")";
    }

    .xr-dim-list li:not(:last-child):after {
      content: ",";
      padding-right: 5px;
    }

    .xr-has-index {
      font-weight: bold;
    }

    .xr-var-list,
    .xr-var-item {
      display: contents;
    }

    .xr-var-item > div,
    .xr-var-item label,
    .xr-var-item > .xr-var-name span {
      background-color: var(--xr-background-color-row-even);
      margin-bottom: 0;
    }

    .xr-var-item > .xr-var-name:hover span {
      padding-right: 5px;
    }

    .xr-var-list > li:nth-child(odd) > div,
    .xr-var-list > li:nth-child(odd) > label,
    .xr-var-list > li:nth-child(odd) > .xr-var-name span {
      background-color: var(--xr-background-color-row-odd);
    }

    .xr-var-name {
      grid-column: 1;
    }

    .xr-var-dims {
      grid-column: 2;
    }

    .xr-var-dtype {
      grid-column: 3;
      text-align: right;
      color: var(--xr-font-color2);
    }

    .xr-var-preview {
      grid-column: 4;
    }

    .xr-index-preview {
      grid-column: 2 / 5;
      color: var(--xr-font-color2);
    }

    .xr-var-name,
    .xr-var-dims,
    .xr-var-dtype,
    .xr-preview,
    .xr-attrs dt {
      white-space: nowrap;
      overflow: hidden;
      text-overflow: ellipsis;
      padding-right: 10px;
    }

    .xr-var-name:hover,
    .xr-var-dims:hover,
    .xr-var-dtype:hover,
    .xr-attrs dt:hover {
      overflow: visible;
      width: auto;
      z-index: 1;
    }

    .xr-var-attrs,
    .xr-var-data,
    .xr-index-data {
      display: none;
      background-color: var(--xr-background-color) !important;
      padding-bottom: 5px !important;
    }

    .xr-var-attrs-in:checked ~ .xr-var-attrs,
    .xr-var-data-in:checked ~ .xr-var-data,
    .xr-index-data-in:checked ~ .xr-index-data {
      display: block;
    }

    .xr-var-data > table {
      float: right;
    }

    .xr-var-name span,
    .xr-var-data,
    .xr-index-name div,
    .xr-index-data,
    .xr-attrs {
      padding-left: 25px !important;
    }

    .xr-attrs,
    .xr-var-attrs,
    .xr-var-data,
    .xr-index-data {
      grid-column: 1 / -1;
    }

    dl.xr-attrs {
      padding: 0;
      margin: 0;
      display: grid;
      grid-template-columns: 125px auto;
    }

    .xr-attrs dt,
    .xr-attrs dd {
      padding: 0;
      margin: 0;
      float: left;
      padding-right: 10px;
      width: auto;
    }

    .xr-attrs dt {
      font-weight: normal;
      grid-column: 1;
    }

    .xr-attrs dt:hover span {
      display: inline-block;
      background: var(--xr-background-color);
      padding-right: 10px;
    }

    .xr-attrs dd {
      grid-column: 2;
      white-space: pre-wrap;
      word-break: break-all;
    }

    .xr-icon-database,
    .xr-icon-file-text2,
    .xr-no-icon {
      display: inline-block;
      vertical-align: middle;
      width: 1em;
      height: 1.5em !important;
      stroke-width: 0;
      stroke: currentColor;
      fill: currentColor;
    }
    </style><pre class='xr-text-repr-fallback'>&lt;xarray.Dataset&gt; Size: 1MB
    Dimensions:      (time: 18485, space: 2, keypoints: 6, individuals: 1)
    Coordinates:
      * time         (time) float64 148kB 0.0 0.03333 0.06667 ... 616.1 616.1 616.1
      * space        (space) &lt;U1 8B &#x27;x&#x27; &#x27;y&#x27;
      * keypoints    (keypoints) &lt;U9 216B &#x27;snout&#x27; &#x27;left_ear&#x27; ... &#x27;tail_end&#x27;
      * individuals  (individuals) &lt;U12 48B &#x27;individual_0&#x27;
    Data variables:
        position     (time, space, keypoints, individuals) float32 887kB nan ... ...
        confidence   (time, keypoints, individuals) float32 444kB nan nan ... 0.7607
    Attributes:
        source_software:  SLEAP
        ds_type:          poses
        fps:              30.0
        time_unit:        seconds
        source_file:      /home/runner/.movement/data/poses/SLEAP_single-mouse_EP...
        frame_path:       /home/runner/.movement/data/frames/single-mouse_EPM_fra...</pre><div class='xr-wrap' style='display:none'><div class='xr-header'><div class='xr-obj-type'>xarray.Dataset</div></div><ul class='xr-sections'><li class='xr-section-item'><input id='section-1f38a74d-02fd-4f36-8ed2-7b0b439b3089' class='xr-section-summary-in' type='checkbox' disabled ><label for='section-1f38a74d-02fd-4f36-8ed2-7b0b439b3089' class='xr-section-summary'  title='Expand/collapse section'>Dimensions:</label><div class='xr-section-inline-details'><ul class='xr-dim-list'><li><span class='xr-has-index'>time</span>: 18485</li><li><span class='xr-has-index'>space</span>: 2</li><li><span class='xr-has-index'>keypoints</span>: 6</li><li><span class='xr-has-index'>individuals</span>: 1</li></ul></div><div class='xr-section-details'></div></li><li class='xr-section-item'><input id='section-47b5e51e-2470-40a2-91bb-fce98f4a1812' class='xr-section-summary-in' type='checkbox'  checked><label for='section-47b5e51e-2470-40a2-91bb-fce98f4a1812' class='xr-section-summary' >Coordinates: <span>(4)</span></label><div class='xr-section-inline-details'></div><div class='xr-section-details'><ul class='xr-var-list'><li class='xr-var-item'><div class='xr-var-name'><span class='xr-has-index'>time</span></div><div class='xr-var-dims'>(time)</div><div class='xr-var-dtype'>float64</div><div class='xr-var-preview xr-preview'>0.0 0.03333 0.06667 ... 616.1 616.1</div><input id='attrs-a12ab689-c3fb-405a-a6e6-04f0e408583e' class='xr-var-attrs-in' type='checkbox' disabled><label for='attrs-a12ab689-c3fb-405a-a6e6-04f0e408583e' title='Show/Hide attributes'><svg class='icon xr-icon-file-text2'><use xlink:href='#icon-file-text2'></use></svg></label><input id='data-942b86d5-c5b7-4508-8b12-1f3e4b95f350' class='xr-var-data-in' type='checkbox'><label for='data-942b86d5-c5b7-4508-8b12-1f3e4b95f350' title='Show/Hide data repr'><svg class='icon xr-icon-database'><use xlink:href='#icon-database'></use></svg></label><div class='xr-var-attrs'><dl class='xr-attrs'></dl></div><div class='xr-var-data'><pre>array([0.000000e+00, 3.333333e-02, 6.666667e-02, ..., 6.160667e+02,
           6.161000e+02, 6.161333e+02], shape=(18485,))</pre></div></li><li class='xr-var-item'><div class='xr-var-name'><span class='xr-has-index'>space</span></div><div class='xr-var-dims'>(space)</div><div class='xr-var-dtype'>&lt;U1</div><div class='xr-var-preview xr-preview'>&#x27;x&#x27; &#x27;y&#x27;</div><input id='attrs-b6761d70-3536-4ddc-bea5-fe542dae769c' class='xr-var-attrs-in' type='checkbox' disabled><label for='attrs-b6761d70-3536-4ddc-bea5-fe542dae769c' title='Show/Hide attributes'><svg class='icon xr-icon-file-text2'><use xlink:href='#icon-file-text2'></use></svg></label><input id='data-66a76e92-1f0e-4918-b194-8d4aa6233950' class='xr-var-data-in' type='checkbox'><label for='data-66a76e92-1f0e-4918-b194-8d4aa6233950' title='Show/Hide data repr'><svg class='icon xr-icon-database'><use xlink:href='#icon-database'></use></svg></label><div class='xr-var-attrs'><dl class='xr-attrs'></dl></div><div class='xr-var-data'><pre>array([&#x27;x&#x27;, &#x27;y&#x27;], dtype=&#x27;&lt;U1&#x27;)</pre></div></li><li class='xr-var-item'><div class='xr-var-name'><span class='xr-has-index'>keypoints</span></div><div class='xr-var-dims'>(keypoints)</div><div class='xr-var-dtype'>&lt;U9</div><div class='xr-var-preview xr-preview'>&#x27;snout&#x27; &#x27;left_ear&#x27; ... &#x27;tail_end&#x27;</div><input id='attrs-adba33b0-3e1d-4988-a4f9-0f7587486a86' class='xr-var-attrs-in' type='checkbox' disabled><label for='attrs-adba33b0-3e1d-4988-a4f9-0f7587486a86' title='Show/Hide attributes'><svg class='icon xr-icon-file-text2'><use xlink:href='#icon-file-text2'></use></svg></label><input id='data-2d4645ce-c079-4b52-86f0-c5ec4358735c' class='xr-var-data-in' type='checkbox'><label for='data-2d4645ce-c079-4b52-86f0-c5ec4358735c' title='Show/Hide data repr'><svg class='icon xr-icon-database'><use xlink:href='#icon-database'></use></svg></label><div class='xr-var-attrs'><dl class='xr-attrs'></dl></div><div class='xr-var-data'><pre>array([&#x27;snout&#x27;, &#x27;left_ear&#x27;, &#x27;right_ear&#x27;, &#x27;centre&#x27;, &#x27;tail_base&#x27;, &#x27;tail_end&#x27;],
          dtype=&#x27;&lt;U9&#x27;)</pre></div></li><li class='xr-var-item'><div class='xr-var-name'><span class='xr-has-index'>individuals</span></div><div class='xr-var-dims'>(individuals)</div><div class='xr-var-dtype'>&lt;U12</div><div class='xr-var-preview xr-preview'>&#x27;individual_0&#x27;</div><input id='attrs-5141c390-6f69-460d-8ca1-525023a74ebe' class='xr-var-attrs-in' type='checkbox' disabled><label for='attrs-5141c390-6f69-460d-8ca1-525023a74ebe' title='Show/Hide attributes'><svg class='icon xr-icon-file-text2'><use xlink:href='#icon-file-text2'></use></svg></label><input id='data-c3088c58-d51c-4404-b7e3-c948ae0f8009' class='xr-var-data-in' type='checkbox'><label for='data-c3088c58-d51c-4404-b7e3-c948ae0f8009' title='Show/Hide data repr'><svg class='icon xr-icon-database'><use xlink:href='#icon-database'></use></svg></label><div class='xr-var-attrs'><dl class='xr-attrs'></dl></div><div class='xr-var-data'><pre>array([&#x27;individual_0&#x27;], dtype=&#x27;&lt;U12&#x27;)</pre></div></li></ul></div></li><li class='xr-section-item'><input id='section-1467f4a6-694a-4c2b-970b-3edc1bd830b3' class='xr-section-summary-in' type='checkbox'  checked><label for='section-1467f4a6-694a-4c2b-970b-3edc1bd830b3' class='xr-section-summary' >Data variables: <span>(2)</span></label><div class='xr-section-inline-details'></div><div class='xr-section-details'><ul class='xr-var-list'><li class='xr-var-item'><div class='xr-var-name'><span>position</span></div><div class='xr-var-dims'>(time, space, keypoints, individuals)</div><div class='xr-var-dtype'>float32</div><div class='xr-var-preview xr-preview'>nan nan nan ... 439.8 384.9 476.4</div><input id='attrs-27921e8e-3d54-45ae-8ec3-bb32d9d515b1' class='xr-var-attrs-in' type='checkbox' ><label for='attrs-27921e8e-3d54-45ae-8ec3-bb32d9d515b1' title='Show/Hide attributes'><svg class='icon xr-icon-file-text2'><use xlink:href='#icon-file-text2'></use></svg></label><input id='data-b41fd92c-c5e4-4fce-adf3-cabb33fe1ddd' class='xr-var-data-in' type='checkbox'><label for='data-b41fd92c-c5e4-4fce-adf3-cabb33fe1ddd' title='Show/Hide data repr'><svg class='icon xr-icon-database'><use xlink:href='#icon-database'></use></svg></label><div class='xr-var-attrs'><dl class='xr-attrs'><dt><span>log :</span></dt><dd>[{&#x27;operation&#x27;: &#x27;rolling_filter&#x27;, &#x27;datetime&#x27;: &#x27;2025-05-14 09:39:05.757617&#x27;, &#x27;arg_1&#x27;: 3, &#x27;min_periods&#x27;: 2, &#x27;statistic&#x27;: &#x27;median&#x27;}, {&#x27;operation&#x27;: &#x27;interpolate_over_time&#x27;, &#x27;datetime&#x27;: &#x27;2025-05-14 09:39:05.780967&#x27;, &#x27;max_gap&#x27;: 30}, {&#x27;operation&#x27;: &#x27;savgol_filter&#x27;, &#x27;datetime&#x27;: &#x27;2025-05-14 09:39:05.784921&#x27;, &#x27;arg_1&#x27;: 12}]</dd></dl></div><div class='xr-var-data'><pre>array([[[[      nan],
             [      nan],
             [      nan],
             [      nan],
             [      nan],
             [      nan]],

            [[      nan],
             [      nan],
             [      nan],
             [      nan],
             [      nan],
             [      nan]]],


           [[[      nan],
             [      nan],
             [      nan],
             [      nan],
             [      nan],
    ...
             [484.99295],
             [491.70206],
             [439.1004 ],
             [384.04898],
             [476.4877 ]]],


           [[[687.1241 ],
             [691.6779 ],
             [667.5868 ],
             [667.8876 ],
             [636.8564 ],
             [588.4856 ]],

            [[507.36728],
             [485.9541 ],
             [492.4988 ],
             [439.8272 ],
             [384.89087],
             [476.4103 ]]]], shape=(18485, 2, 6, 1), dtype=float32)</pre></div></li><li class='xr-var-item'><div class='xr-var-name'><span>confidence</span></div><div class='xr-var-dims'>(time, keypoints, individuals)</div><div class='xr-var-dtype'>float32</div><div class='xr-var-preview xr-preview'>nan nan nan ... 0.9336 0.7607</div><input id='attrs-fabcfcff-f2e0-4b61-ad20-f870b3521898' class='xr-var-attrs-in' type='checkbox' disabled><label for='attrs-fabcfcff-f2e0-4b61-ad20-f870b3521898' title='Show/Hide attributes'><svg class='icon xr-icon-file-text2'><use xlink:href='#icon-file-text2'></use></svg></label><input id='data-8c8c8467-69b6-4fd3-9655-3979a0de1358' class='xr-var-data-in' type='checkbox'><label for='data-8c8c8467-69b6-4fd3-9655-3979a0de1358' title='Show/Hide data repr'><svg class='icon xr-icon-database'><use xlink:href='#icon-database'></use></svg></label><div class='xr-var-attrs'><dl class='xr-attrs'></dl></div><div class='xr-var-data'><pre>array([[[       nan],
            [       nan],
            [       nan],
            [       nan],
            [       nan],
            [       nan]],

           [[       nan],
            [       nan],
            [       nan],
            [       nan],
            [       nan],
            [       nan]],

           [[       nan],
            [       nan],
            [       nan],
            [       nan],
            [       nan],
            [       nan]],
    ...
           [[0.9317396 ],
            [1.0026728 ],
            [1.025079  ],
            [0.92725545],
            [0.95202184],
            [0.7779419 ]],

           [[0.9193515 ],
            [1.0136327 ],
            [1.0336665 ],
            [0.93108493],
            [0.94561106],
            [0.7662804 ]],

           [[0.93820494],
            [1.0224991 ],
            [1.0452943 ],
            [0.9363993 ],
            [0.9335798 ],
            [0.76068705]]], shape=(18485, 6, 1), dtype=float32)</pre></div></li></ul></div></li><li class='xr-section-item'><input id='section-c3c1459f-ff82-4b0d-abdd-2d28c0c3032d' class='xr-section-summary-in' type='checkbox'  ><label for='section-c3c1459f-ff82-4b0d-abdd-2d28c0c3032d' class='xr-section-summary' >Indexes: <span>(4)</span></label><div class='xr-section-inline-details'></div><div class='xr-section-details'><ul class='xr-var-list'><li class='xr-var-item'><div class='xr-index-name'><div>time</div></div><div class='xr-index-preview'>PandasIndex</div><input type='checkbox' disabled/><label></label><input id='index-d24f8e89-7a8b-4aa8-b94f-c2672d1cc2e9' class='xr-index-data-in' type='checkbox'/><label for='index-d24f8e89-7a8b-4aa8-b94f-c2672d1cc2e9' title='Show/Hide index repr'><svg class='icon xr-icon-database'><use xlink:href='#icon-database'></use></svg></label><div class='xr-index-data'><pre>PandasIndex(Index([                0.0, 0.03333333333333333, 0.06666666666666667,
                           0.1, 0.13333333333333333, 0.16666666666666666,
                           0.2, 0.23333333333333334, 0.26666666666666666,
                           0.3,
           ...
             615.8333333333334,   615.8666666666667,               615.9,
             615.9333333333333,   615.9666666666667,               616.0,
             616.0333333333333,   616.0666666666667,               616.1,
             616.1333333333333],
          dtype=&#x27;float64&#x27;, name=&#x27;time&#x27;, length=18485))</pre></div></li><li class='xr-var-item'><div class='xr-index-name'><div>space</div></div><div class='xr-index-preview'>PandasIndex</div><input type='checkbox' disabled/><label></label><input id='index-d6a3c2e0-3522-4c4a-b0ab-c3893bfccca4' class='xr-index-data-in' type='checkbox'/><label for='index-d6a3c2e0-3522-4c4a-b0ab-c3893bfccca4' title='Show/Hide index repr'><svg class='icon xr-icon-database'><use xlink:href='#icon-database'></use></svg></label><div class='xr-index-data'><pre>PandasIndex(Index([&#x27;x&#x27;, &#x27;y&#x27;], dtype=&#x27;object&#x27;, name=&#x27;space&#x27;))</pre></div></li><li class='xr-var-item'><div class='xr-index-name'><div>keypoints</div></div><div class='xr-index-preview'>PandasIndex</div><input type='checkbox' disabled/><label></label><input id='index-c7256670-620d-4de1-8e70-4b61cd73579c' class='xr-index-data-in' type='checkbox'/><label for='index-c7256670-620d-4de1-8e70-4b61cd73579c' title='Show/Hide index repr'><svg class='icon xr-icon-database'><use xlink:href='#icon-database'></use></svg></label><div class='xr-index-data'><pre>PandasIndex(Index([&#x27;snout&#x27;, &#x27;left_ear&#x27;, &#x27;right_ear&#x27;, &#x27;centre&#x27;, &#x27;tail_base&#x27;, &#x27;tail_end&#x27;], dtype=&#x27;object&#x27;, name=&#x27;keypoints&#x27;))</pre></div></li><li class='xr-var-item'><div class='xr-index-name'><div>individuals</div></div><div class='xr-index-preview'>PandasIndex</div><input type='checkbox' disabled/><label></label><input id='index-1a3ec26c-3fb5-4ab8-a2e0-499cc9cab692' class='xr-index-data-in' type='checkbox'/><label for='index-1a3ec26c-3fb5-4ab8-a2e0-499cc9cab692' title='Show/Hide index repr'><svg class='icon xr-icon-database'><use xlink:href='#icon-database'></use></svg></label><div class='xr-index-data'><pre>PandasIndex(Index([&#x27;individual_0&#x27;], dtype=&#x27;object&#x27;, name=&#x27;individuals&#x27;))</pre></div></li></ul></div></li><li class='xr-section-item'><input id='section-2d450a6b-5a8a-4c23-b001-b9236ed36d5f' class='xr-section-summary-in' type='checkbox'  checked><label for='section-2d450a6b-5a8a-4c23-b001-b9236ed36d5f' class='xr-section-summary' >Attributes: <span>(6)</span></label><div class='xr-section-inline-details'></div><div class='xr-section-details'><dl class='xr-attrs'><dt><span>source_software :</span></dt><dd>SLEAP</dd><dt><span>ds_type :</span></dt><dd>poses</dd><dt><span>fps :</span></dt><dd>30.0</dd><dt><span>time_unit :</span></dt><dd>seconds</dd><dt><span>source_file :</span></dt><dd>/home/runner/.movement/data/poses/SLEAP_single-mouse_EPM.analysis.h5</dd><dt><span>frame_path :</span></dt><dd>/home/runner/.movement/data/frames/single-mouse_EPM_frame-20sec.png</dd></dl></div></li></ul></div></div>
    </div>
    <br />
    <br />

.. GENERATED FROM PYTHON SOURCE LINES 361-364

A record of all applied operations is stored in the ``log`` attribute of the
``ds_mouse_smooth.position`` data array. Let's inspect it to summarise
what we've done.

.. GENERATED FROM PYTHON SOURCE LINES 364-368

.. code-block:: Python


    for entry in ds_mouse_smooth.position.log:
        print(entry)





.. rst-class:: sphx-glr-script-out

 .. code-block:: none

    {'operation': 'rolling_filter', 'datetime': '2025-05-14 09:39:05.757617', 'arg_1': 3, 'min_periods': 2, 'statistic': 'median'}
    {'operation': 'interpolate_over_time', 'datetime': '2025-05-14 09:39:05.780967', 'max_gap': 30}
    {'operation': 'savgol_filter', 'datetime': '2025-05-14 09:39:05.784921', 'arg_1': 12}




.. GENERATED FROM PYTHON SOURCE LINES 369-371

Now let's visualise the difference between the raw data and the final
smoothed result.

.. GENERATED FROM PYTHON SOURCE LINES 371-379

.. code-block:: Python


    plot_raw_and_smooth_timeseries_and_psd(
        ds_mouse,
        ds_mouse_smooth,
        keypoint="snout",
        time_range=slice(0, 80),
    )




.. image-sg:: /examples/images/sphx_glr_smooth_006.png
   :alt: Time Domain, Frequency Domain
   :srcset: /examples/images/sphx_glr_smooth_006.png
   :class: sphx-glr-single-img





.. GENERATED FROM PYTHON SOURCE LINES 380-382

Feel free to play around with the parameters of the applied filters and to
also look at other keypoints and time ranges.

.. GENERATED FROM PYTHON SOURCE LINES 384-388

.. seealso::
  :ref:`examples/filter_and_interpolate:Filtering multiple data variables`
  in the
  :ref:`sphx_glr_examples_filter_and_interpolate.py` example.


.. rst-class:: sphx-glr-timing

   **Total running time of the script:** (0 minutes 1.597 seconds)


.. _sphx_glr_download_examples_smooth.py:

.. only:: html

  .. container:: sphx-glr-footer sphx-glr-footer-example

    .. container:: binder-badge

      .. image:: images/binder_badge_logo.svg
        :target: https://mybinder.org/v2/gh/neuroinformatics-unit/movement/gh-pages?filepath=notebooks/examples/smooth.ipynb
        :alt: Launch binder
        :width: 150 px

    .. container:: sphx-glr-download sphx-glr-download-jupyter

      :download:`Download Jupyter notebook: smooth.ipynb <smooth.ipynb>`

    .. container:: sphx-glr-download sphx-glr-download-python

      :download:`Download Python source code: smooth.py <smooth.py>`

    .. container:: sphx-glr-download sphx-glr-download-zip

      :download:`Download zipped: smooth.zip <smooth.zip>`


.. only:: html

 .. rst-class:: sphx-glr-signature

    `Gallery generated by Sphinx-Gallery <https://sphinx-gallery.github.io>`_
