
.. DO NOT EDIT.
.. THIS FILE WAS AUTOMATICALLY GENERATED BY SPHINX-GALLERY.
.. TO MAKE CHANGES, EDIT THE SOURCE PYTHON FILE:
.. "examples/smooth.py"
.. LINE NUMBERS ARE GIVEN BELOW.

.. only:: html

    .. note::
        :class: sphx-glr-download-link-note

        :ref:`Go to the end <sphx_glr_download_examples_smooth.py>`
        to download the full example code. or to run this example in your browser via Binder

.. rst-class:: sphx-glr-example-title

.. _sphx_glr_examples_smooth.py:

Smooth pose tracks
=====================

Smooth pose tracks using the rolling median and Savitzky-Golay filters.

.. GENERATED FROM PYTHON SOURCE LINES 8-10

Imports
-------

.. GENERATED FROM PYTHON SOURCE LINES 10-21

.. code-block:: Python


    import matplotlib.pyplot as plt
    from scipy.signal import welch

    from movement import sample_data
    from movement.filtering import (
        interpolate_over_time,
        rolling_filter,
        savgol_filter,
    )








.. GENERATED FROM PYTHON SOURCE LINES 22-28

Load a sample dataset
---------------------
Let's load a sample dataset and print it to inspect its contents.
Note that if you are running this notebook interactively, you can simply
type the variable name (here ``ds_wasp``) in a cell to get an interactive
display of the dataset's contents.

.. GENERATED FROM PYTHON SOURCE LINES 28-32

.. code-block:: Python


    ds_wasp = sample_data.fetch_dataset("DLC_single-wasp.predictions.h5")
    print(ds_wasp)





.. rst-class:: sphx-glr-script-out

 .. code-block:: none

    <xarray.Dataset> Size: 61kB
    Dimensions:      (time: 1085, space: 2, keypoints: 2, individuals: 1)
    Coordinates:
      * time         (time) float64 9kB 0.0 0.025 0.05 0.075 ... 27.05 27.07 27.1
      * space        (space) <U1 8B 'x' 'y'
      * keypoints    (keypoints) <U7 56B 'head' 'stinger'
      * individuals  (individuals) <U12 48B 'individual_0'
    Data variables:
        position     (time, space, keypoints, individuals) float64 35kB 1.086e+03...
        confidence   (time, keypoints, individuals) float64 17kB 0.05305 ... 0.0
    Attributes:
        source_software:  DeepLabCut
        ds_type:          poses
        fps:              40.0
        time_unit:        seconds
        source_file:      /home/runner/.movement/data/poses/DLC_single-wasp.predi...
        frame_path:       /home/runner/.movement/data/frames/single-wasp_frame-10...




.. GENERATED FROM PYTHON SOURCE LINES 33-37

We see that the dataset contains the 2D pose tracks and confidence scores
for a single wasp, generated with DeepLabCut. The wasp is tracked at two
keypoints: "head" and "stinger" in a video that was recorded at 40 fps and
lasts for approximately 27 seconds.

.. GENERATED FROM PYTHON SOURCE LINES 39-47

Define a plotting function
--------------------------
Let's define a plotting function to help us visualise the effects of
smoothing both in the time and frequency domains.
The function takes as inputs two datasets containing raw and smooth data
respectively, and plots the position time series and power spectral density
(PSD) for a given individual and keypoint. The function also allows you to
specify the spatial coordinate (``x`` or ``y``) and a time range to focus on.

.. GENERATED FROM PYTHON SOURCE LINES 47-115

.. code-block:: Python



    def plot_raw_and_smooth_timeseries_and_psd(
        ds_raw,
        ds_smooth,
        individual=None,
        keypoint="stinger",
        space="x",
        time_range=None,
    ):
        # If no individual is specified, use the first one
        if individual is None:
            individual = ds_raw.individuals[0]
        # If no time range is specified, plot the entire time series
        if time_range is None:
            time_range = slice(0, ds_raw.time[-1])

        selection = {
            "time": time_range,
            "individuals": individual,
            "keypoints": keypoint,
            "space": space,
        }

        fig, ax = plt.subplots(2, 1, figsize=(10, 6))

        for ds, color, label in zip(
            [ds_raw, ds_smooth], ["k", "r"], ["raw", "smooth"], strict=False
        ):
            # plot position time series
            pos = ds.position.sel(**selection)
            ax[0].plot(
                pos.time,
                pos,
                color=color,
                lw=2,
                alpha=0.7,
                label=f"{label} {space}",
            )

            # interpolate data to remove NaNs in the PSD calculation
            pos_interp = interpolate_over_time(pos, fill_value="extrapolate")

            # compute and plot the PSD
            freq, psd = welch(pos_interp, fs=ds.fps, nperseg=256)
            ax[1].semilogy(
                freq,
                psd,
                color=color,
                lw=2,
                alpha=0.7,
                label=f"{label} {space}",
            )

        ax[0].set_ylabel(f"{space} position (px)")
        ax[0].set_xlabel("Time (s)")
        ax[0].set_title("Time Domain")
        ax[0].legend()

        ax[1].set_ylabel("PSD (px$^2$/Hz)")
        ax[1].set_xlabel("Frequency (Hz)")
        ax[1].set_title("Frequency Domain")
        ax[1].legend()

        plt.tight_layout()
        fig.show()









.. GENERATED FROM PYTHON SOURCE LINES 116-131

Smoothing with a rolling median filter
--------------------------------------
Using the :func:`movement.filtering.rolling_filter` function on the
``position`` data variable, we can apply a rolling median filter
over a 0.1-second window (4 frames) to the wasp dataset.
As the ``window`` parameter is defined in *number of observations*,
we can simply multiply the desired time window by the frame rate
of the video. We will also create a copy of the dataset to avoid
modifying the original data.

Here we use the default ``statistic="median"`` option, which is a sensible
choice for smoothing time-series data while being robust to outliers.
You can also use the ``rolling_filter`` function to compute the rolling
mean, maximum, and minimum values (instead of the median), by
setting ``statistic`` to ``"mean"``, ``"max"``, or ``"min"``, respectively.

.. GENERATED FROM PYTHON SOURCE LINES 131-142

.. code-block:: Python


    window = int(0.1 * ds_wasp.fps)
    ds_wasp_smooth = ds_wasp.copy()
    ds_wasp_smooth.update(
        {
            "position": rolling_filter(
                ds_wasp.position, window, statistic="median", print_report=True
            )
        }
    )





.. rst-class:: sphx-glr-script-out

 .. code-block:: none

    No missing points (marked as NaN) in input.
    No missing points (marked as NaN) in output.


.. raw:: html

    <div class="output_subarea output_html rendered_html output_result">
    <div><svg style="position: absolute; width: 0; height: 0; overflow: hidden">
    <defs>
    <symbol id="icon-database" viewBox="0 0 32 32">
    <path d="M16 0c-8.837 0-16 2.239-16 5v4c0 2.761 7.163 5 16 5s16-2.239 16-5v-4c0-2.761-7.163-5-16-5z"></path>
    <path d="M16 17c-8.837 0-16-2.239-16-5v6c0 2.761 7.163 5 16 5s16-2.239 16-5v-6c0 2.761-7.163 5-16 5z"></path>
    <path d="M16 26c-8.837 0-16-2.239-16-5v6c0 2.761 7.163 5 16 5s16-2.239 16-5v-6c0 2.761-7.163 5-16 5z"></path>
    </symbol>
    <symbol id="icon-file-text2" viewBox="0 0 32 32">
    <path d="M28.681 7.159c-0.694-0.947-1.662-2.053-2.724-3.116s-2.169-2.030-3.116-2.724c-1.612-1.182-2.393-1.319-2.841-1.319h-15.5c-1.378 0-2.5 1.121-2.5 2.5v27c0 1.378 1.122 2.5 2.5 2.5h23c1.378 0 2.5-1.122 2.5-2.5v-19.5c0-0.448-0.137-1.23-1.319-2.841zM24.543 5.457c0.959 0.959 1.712 1.825 2.268 2.543h-4.811v-4.811c0.718 0.556 1.584 1.309 2.543 2.268zM28 29.5c0 0.271-0.229 0.5-0.5 0.5h-23c-0.271 0-0.5-0.229-0.5-0.5v-27c0-0.271 0.229-0.5 0.5-0.5 0 0 15.499-0 15.5 0v7c0 0.552 0.448 1 1 1h7v19.5z"></path>
    <path d="M23 26h-14c-0.552 0-1-0.448-1-1s0.448-1 1-1h14c0.552 0 1 0.448 1 1s-0.448 1-1 1z"></path>
    <path d="M23 22h-14c-0.552 0-1-0.448-1-1s0.448-1 1-1h14c0.552 0 1 0.448 1 1s-0.448 1-1 1z"></path>
    <path d="M23 18h-14c-0.552 0-1-0.448-1-1s0.448-1 1-1h14c0.552 0 1 0.448 1 1s-0.448 1-1 1z"></path>
    </symbol>
    </defs>
    </svg>
    <style>/* CSS stylesheet for displaying xarray objects in jupyterlab.
     *
     */

    :root {
      --xr-font-color0: var(
        --jp-content-font-color0,
        var(--pst-color-text-base rgba(0, 0, 0, 1))
      );
      --xr-font-color2: var(
        --jp-content-font-color2,
        var(--pst-color-text-base, rgba(0, 0, 0, 0.54))
      );
      --xr-font-color3: var(
        --jp-content-font-color3,
        var(--pst-color-text-base, rgba(0, 0, 0, 0.38))
      );
      --xr-border-color: var(
        --jp-border-color2,
        hsl(from var(--pst-color-on-background, white) h s calc(l - 10))
      );
      --xr-disabled-color: var(
        --jp-layout-color3,
        hsl(from var(--pst-color-on-background, white) h s calc(l - 40))
      );
      --xr-background-color: var(
        --jp-layout-color0,
        var(--pst-color-on-background, white)
      );
      --xr-background-color-row-even: var(
        --jp-layout-color1,
        hsl(from var(--pst-color-on-background, white) h s calc(l - 5))
      );
      --xr-background-color-row-odd: var(
        --jp-layout-color2,
        hsl(from var(--pst-color-on-background, white) h s calc(l - 15))
      );
    }

    html[theme="dark"],
    html[data-theme="dark"],
    body[data-theme="dark"],
    body.vscode-dark {
      --xr-font-color0: var(
        --jp-content-font-color0,
        var(--pst-color-text-base, rgba(255, 255, 255, 1))
      );
      --xr-font-color2: var(
        --jp-content-font-color2,
        var(--pst-color-text-base, rgba(255, 255, 255, 0.54))
      );
      --xr-font-color3: var(
        --jp-content-font-color3,
        var(--pst-color-text-base, rgba(255, 255, 255, 0.38))
      );
      --xr-border-color: var(
        --jp-border-color2,
        hsl(from var(--pst-color-on-background, #111111) h s calc(l + 10))
      );
      --xr-disabled-color: var(
        --jp-layout-color3,
        hsl(from var(--pst-color-on-background, #111111) h s calc(l + 40))
      );
      --xr-background-color: var(
        --jp-layout-color0,
        var(--pst-color-on-background, #111111)
      );
      --xr-background-color-row-even: var(
        --jp-layout-color1,
        hsl(from var(--pst-color-on-background, #111111) h s calc(l + 5))
      );
      --xr-background-color-row-odd: var(
        --jp-layout-color2,
        hsl(from var(--pst-color-on-background, #111111) h s calc(l + 15))
      );
    }

    .xr-wrap {
      display: block !important;
      min-width: 300px;
      max-width: 700px;
    }

    .xr-text-repr-fallback {
      /* fallback to plain text repr when CSS is not injected (untrusted notebook) */
      display: none;
    }

    .xr-header {
      padding-top: 6px;
      padding-bottom: 6px;
      margin-bottom: 4px;
      border-bottom: solid 1px var(--xr-border-color);
    }

    .xr-header > div,
    .xr-header > ul {
      display: inline;
      margin-top: 0;
      margin-bottom: 0;
    }

    .xr-obj-type,
    .xr-array-name {
      margin-left: 2px;
      margin-right: 10px;
    }

    .xr-obj-type {
      color: var(--xr-font-color2);
    }

    .xr-sections {
      padding-left: 0 !important;
      display: grid;
      grid-template-columns: 150px auto auto 1fr 0 20px 0 20px;
    }

    .xr-section-item {
      display: contents;
    }

    .xr-section-item input {
      display: inline-block;
      opacity: 0;
      height: 0;
    }

    .xr-section-item input + label {
      color: var(--xr-disabled-color);
      border: 2px solid transparent !important;
    }

    .xr-section-item input:enabled + label {
      cursor: pointer;
      color: var(--xr-font-color2);
    }

    .xr-section-item input:focus + label {
      border: 2px solid var(--xr-font-color0) !important;
    }

    .xr-section-item input:enabled + label:hover {
      color: var(--xr-font-color0);
    }

    .xr-section-summary {
      grid-column: 1;
      color: var(--xr-font-color2);
      font-weight: 500;
    }

    .xr-section-summary > span {
      display: inline-block;
      padding-left: 0.5em;
    }

    .xr-section-summary-in:disabled + label {
      color: var(--xr-font-color2);
    }

    .xr-section-summary-in + label:before {
      display: inline-block;
      content: "►";
      font-size: 11px;
      width: 15px;
      text-align: center;
    }

    .xr-section-summary-in:disabled + label:before {
      color: var(--xr-disabled-color);
    }

    .xr-section-summary-in:checked + label:before {
      content: "▼";
    }

    .xr-section-summary-in:checked + label > span {
      display: none;
    }

    .xr-section-summary,
    .xr-section-inline-details {
      padding-top: 4px;
      padding-bottom: 4px;
    }

    .xr-section-inline-details {
      grid-column: 2 / -1;
    }

    .xr-section-details {
      display: none;
      grid-column: 1 / -1;
      margin-bottom: 5px;
    }

    .xr-section-summary-in:checked ~ .xr-section-details {
      display: contents;
    }

    .xr-array-wrap {
      grid-column: 1 / -1;
      display: grid;
      grid-template-columns: 20px auto;
    }

    .xr-array-wrap > label {
      grid-column: 1;
      vertical-align: top;
    }

    .xr-preview {
      color: var(--xr-font-color3);
    }

    .xr-array-preview,
    .xr-array-data {
      padding: 0 5px !important;
      grid-column: 2;
    }

    .xr-array-data,
    .xr-array-in:checked ~ .xr-array-preview {
      display: none;
    }

    .xr-array-in:checked ~ .xr-array-data,
    .xr-array-preview {
      display: inline-block;
    }

    .xr-dim-list {
      display: inline-block !important;
      list-style: none;
      padding: 0 !important;
      margin: 0;
    }

    .xr-dim-list li {
      display: inline-block;
      padding: 0;
      margin: 0;
    }

    .xr-dim-list:before {
      content: "(";
    }

    .xr-dim-list:after {
      content: ")";
    }

    .xr-dim-list li:not(:last-child):after {
      content: ",";
      padding-right: 5px;
    }

    .xr-has-index {
      font-weight: bold;
    }

    .xr-var-list,
    .xr-var-item {
      display: contents;
    }

    .xr-var-item > div,
    .xr-var-item label,
    .xr-var-item > .xr-var-name span {
      background-color: var(--xr-background-color-row-even);
      border-color: var(--xr-background-color-row-odd);
      margin-bottom: 0;
      padding-top: 2px;
    }

    .xr-var-item > .xr-var-name:hover span {
      padding-right: 5px;
    }

    .xr-var-list > li:nth-child(odd) > div,
    .xr-var-list > li:nth-child(odd) > label,
    .xr-var-list > li:nth-child(odd) > .xr-var-name span {
      background-color: var(--xr-background-color-row-odd);
      border-color: var(--xr-background-color-row-even);
    }

    .xr-var-name {
      grid-column: 1;
    }

    .xr-var-dims {
      grid-column: 2;
    }

    .xr-var-dtype {
      grid-column: 3;
      text-align: right;
      color: var(--xr-font-color2);
    }

    .xr-var-preview {
      grid-column: 4;
    }

    .xr-index-preview {
      grid-column: 2 / 5;
      color: var(--xr-font-color2);
    }

    .xr-var-name,
    .xr-var-dims,
    .xr-var-dtype,
    .xr-preview,
    .xr-attrs dt {
      white-space: nowrap;
      overflow: hidden;
      text-overflow: ellipsis;
      padding-right: 10px;
    }

    .xr-var-name:hover,
    .xr-var-dims:hover,
    .xr-var-dtype:hover,
    .xr-attrs dt:hover {
      overflow: visible;
      width: auto;
      z-index: 1;
    }

    .xr-var-attrs,
    .xr-var-data,
    .xr-index-data {
      display: none;
      border-top: 2px dotted var(--xr-background-color);
      padding-bottom: 20px !important;
      padding-top: 10px !important;
    }

    .xr-var-attrs-in + label,
    .xr-var-data-in + label,
    .xr-index-data-in + label {
      padding: 0 1px;
    }

    .xr-var-attrs-in:checked ~ .xr-var-attrs,
    .xr-var-data-in:checked ~ .xr-var-data,
    .xr-index-data-in:checked ~ .xr-index-data {
      display: block;
    }

    .xr-var-data > table {
      float: right;
    }

    .xr-var-data > pre,
    .xr-index-data > pre,
    .xr-var-data > table > tbody > tr {
      background-color: transparent !important;
    }

    .xr-var-name span,
    .xr-var-data,
    .xr-index-name div,
    .xr-index-data,
    .xr-attrs {
      padding-left: 25px !important;
    }

    .xr-attrs,
    .xr-var-attrs,
    .xr-var-data,
    .xr-index-data {
      grid-column: 1 / -1;
    }

    dl.xr-attrs {
      padding: 0;
      margin: 0;
      display: grid;
      grid-template-columns: 125px auto;
    }

    .xr-attrs dt,
    .xr-attrs dd {
      padding: 0;
      margin: 0;
      float: left;
      padding-right: 10px;
      width: auto;
    }

    .xr-attrs dt {
      font-weight: normal;
      grid-column: 1;
    }

    .xr-attrs dt:hover span {
      display: inline-block;
      background: var(--xr-background-color);
      padding-right: 10px;
    }

    .xr-attrs dd {
      grid-column: 2;
      white-space: pre-wrap;
      word-break: break-all;
    }

    .xr-icon-database,
    .xr-icon-file-text2,
    .xr-no-icon {
      display: inline-block;
      vertical-align: middle;
      width: 1em;
      height: 1.5em !important;
      stroke-width: 0;
      stroke: currentColor;
      fill: currentColor;
    }

    .xr-var-attrs-in:checked + label > .xr-icon-file-text2,
    .xr-var-data-in:checked + label > .xr-icon-database,
    .xr-index-data-in:checked + label > .xr-icon-database {
      color: var(--xr-font-color0);
      filter: drop-shadow(1px 1px 5px var(--xr-font-color2));
      stroke-width: 0.8px;
    }
    </style><pre class='xr-text-repr-fallback'>&lt;xarray.Dataset&gt; Size: 61kB
    Dimensions:      (time: 1085, space: 2, keypoints: 2, individuals: 1)
    Coordinates:
      * time         (time) float64 9kB 0.0 0.025 0.05 0.075 ... 27.05 27.07 27.1
      * space        (space) &lt;U1 8B &#x27;x&#x27; &#x27;y&#x27;
      * keypoints    (keypoints) &lt;U7 56B &#x27;head&#x27; &#x27;stinger&#x27;
      * individuals  (individuals) &lt;U12 48B &#x27;individual_0&#x27;
    Data variables:
        position     (time, space, keypoints, individuals) float64 35kB 1.086e+03...
        confidence   (time, keypoints, individuals) float64 17kB 0.05305 ... 0.0
    Attributes:
        source_software:  DeepLabCut
        ds_type:          poses
        fps:              40.0
        time_unit:        seconds
        source_file:      /home/runner/.movement/data/poses/DLC_single-wasp.predi...
        frame_path:       /home/runner/.movement/data/frames/single-wasp_frame-10...</pre><div class='xr-wrap' style='display:none'><div class='xr-header'><div class='xr-obj-type'>xarray.Dataset</div></div><ul class='xr-sections'><li class='xr-section-item'><input id='section-e0049491-9fcf-4e31-aad8-46a587577dae' class='xr-section-summary-in' type='checkbox' disabled ><label for='section-e0049491-9fcf-4e31-aad8-46a587577dae' class='xr-section-summary'  title='Expand/collapse section'>Dimensions:</label><div class='xr-section-inline-details'><ul class='xr-dim-list'><li><span class='xr-has-index'>time</span>: 1085</li><li><span class='xr-has-index'>space</span>: 2</li><li><span class='xr-has-index'>keypoints</span>: 2</li><li><span class='xr-has-index'>individuals</span>: 1</li></ul></div><div class='xr-section-details'></div></li><li class='xr-section-item'><input id='section-9ade4c79-7b91-4dd0-8d05-8db508b1706c' class='xr-section-summary-in' type='checkbox'  checked><label for='section-9ade4c79-7b91-4dd0-8d05-8db508b1706c' class='xr-section-summary' >Coordinates: <span>(4)</span></label><div class='xr-section-inline-details'></div><div class='xr-section-details'><ul class='xr-var-list'><li class='xr-var-item'><div class='xr-var-name'><span class='xr-has-index'>time</span></div><div class='xr-var-dims'>(time)</div><div class='xr-var-dtype'>float64</div><div class='xr-var-preview xr-preview'>0.0 0.025 0.05 ... 27.05 27.07 27.1</div><input id='attrs-b9383173-867f-42d2-9cea-7cd3ddb5a177' class='xr-var-attrs-in' type='checkbox' disabled><label for='attrs-b9383173-867f-42d2-9cea-7cd3ddb5a177' title='Show/Hide attributes'><svg class='icon xr-icon-file-text2'><use xlink:href='#icon-file-text2'></use></svg></label><input id='data-434cfc60-f5b9-43af-bab7-cab0efc58c53' class='xr-var-data-in' type='checkbox'><label for='data-434cfc60-f5b9-43af-bab7-cab0efc58c53' title='Show/Hide data repr'><svg class='icon xr-icon-database'><use xlink:href='#icon-database'></use></svg></label><div class='xr-var-attrs'><dl class='xr-attrs'></dl></div><div class='xr-var-data'><pre>array([0.0000e+00, 2.5000e-02, 5.0000e-02, ..., 2.7050e+01, 2.7075e+01,
           2.7100e+01], shape=(1085,))</pre></div></li><li class='xr-var-item'><div class='xr-var-name'><span class='xr-has-index'>space</span></div><div class='xr-var-dims'>(space)</div><div class='xr-var-dtype'>&lt;U1</div><div class='xr-var-preview xr-preview'>&#x27;x&#x27; &#x27;y&#x27;</div><input id='attrs-264c45e2-90db-4131-a939-c69890c28724' class='xr-var-attrs-in' type='checkbox' disabled><label for='attrs-264c45e2-90db-4131-a939-c69890c28724' title='Show/Hide attributes'><svg class='icon xr-icon-file-text2'><use xlink:href='#icon-file-text2'></use></svg></label><input id='data-35a9f388-cc0d-4e70-aa79-10c499a387a3' class='xr-var-data-in' type='checkbox'><label for='data-35a9f388-cc0d-4e70-aa79-10c499a387a3' title='Show/Hide data repr'><svg class='icon xr-icon-database'><use xlink:href='#icon-database'></use></svg></label><div class='xr-var-attrs'><dl class='xr-attrs'></dl></div><div class='xr-var-data'><pre>array([&#x27;x&#x27;, &#x27;y&#x27;], dtype=&#x27;&lt;U1&#x27;)</pre></div></li><li class='xr-var-item'><div class='xr-var-name'><span class='xr-has-index'>keypoints</span></div><div class='xr-var-dims'>(keypoints)</div><div class='xr-var-dtype'>&lt;U7</div><div class='xr-var-preview xr-preview'>&#x27;head&#x27; &#x27;stinger&#x27;</div><input id='attrs-c92983bc-ee7b-4142-afdf-b89d2822dda5' class='xr-var-attrs-in' type='checkbox' disabled><label for='attrs-c92983bc-ee7b-4142-afdf-b89d2822dda5' title='Show/Hide attributes'><svg class='icon xr-icon-file-text2'><use xlink:href='#icon-file-text2'></use></svg></label><input id='data-f9070896-b29b-4075-946b-87ed3db41fe1' class='xr-var-data-in' type='checkbox'><label for='data-f9070896-b29b-4075-946b-87ed3db41fe1' title='Show/Hide data repr'><svg class='icon xr-icon-database'><use xlink:href='#icon-database'></use></svg></label><div class='xr-var-attrs'><dl class='xr-attrs'></dl></div><div class='xr-var-data'><pre>array([&#x27;head&#x27;, &#x27;stinger&#x27;], dtype=&#x27;&lt;U7&#x27;)</pre></div></li><li class='xr-var-item'><div class='xr-var-name'><span class='xr-has-index'>individuals</span></div><div class='xr-var-dims'>(individuals)</div><div class='xr-var-dtype'>&lt;U12</div><div class='xr-var-preview xr-preview'>&#x27;individual_0&#x27;</div><input id='attrs-68492999-54e4-4d1a-886c-08d9ff0d68eb' class='xr-var-attrs-in' type='checkbox' disabled><label for='attrs-68492999-54e4-4d1a-886c-08d9ff0d68eb' title='Show/Hide attributes'><svg class='icon xr-icon-file-text2'><use xlink:href='#icon-file-text2'></use></svg></label><input id='data-d0a497c8-d577-4443-a945-e90d908384e2' class='xr-var-data-in' type='checkbox'><label for='data-d0a497c8-d577-4443-a945-e90d908384e2' title='Show/Hide data repr'><svg class='icon xr-icon-database'><use xlink:href='#icon-database'></use></svg></label><div class='xr-var-attrs'><dl class='xr-attrs'></dl></div><div class='xr-var-data'><pre>array([&#x27;individual_0&#x27;], dtype=&#x27;&lt;U12&#x27;)</pre></div></li></ul></div></li><li class='xr-section-item'><input id='section-083f2db2-d8c5-4bba-af39-dcd2e0f55b21' class='xr-section-summary-in' type='checkbox'  checked><label for='section-083f2db2-d8c5-4bba-af39-dcd2e0f55b21' class='xr-section-summary' >Data variables: <span>(2)</span></label><div class='xr-section-inline-details'></div><div class='xr-section-details'><ul class='xr-var-list'><li class='xr-var-item'><div class='xr-var-name'><span>position</span></div><div class='xr-var-dims'>(time, space, keypoints, individuals)</div><div class='xr-var-dtype'>float64</div><div class='xr-var-preview xr-preview'>1.086e+03 1.083e+03 ... 0.0 0.0</div><input id='attrs-4467c5c2-5a3a-45bd-86ca-33b81a558b97' class='xr-var-attrs-in' type='checkbox' ><label for='attrs-4467c5c2-5a3a-45bd-86ca-33b81a558b97' title='Show/Hide attributes'><svg class='icon xr-icon-file-text2'><use xlink:href='#icon-file-text2'></use></svg></label><input id='data-09cf248c-39ae-4d28-b948-32d90b12bd11' class='xr-var-data-in' type='checkbox'><label for='data-09cf248c-39ae-4d28-b948-32d90b12bd11' title='Show/Hide data repr'><svg class='icon xr-icon-database'><use xlink:href='#icon-database'></use></svg></label><div class='xr-var-attrs'><dl class='xr-attrs'><dt><span>log :</span></dt><dd>[
      {
        &quot;operation&quot;: &quot;rolling_filter&quot;,
        &quot;datetime&quot;: &quot;2025-07-22 16:47:39.357214&quot;,
        &quot;window&quot;: &quot;4&quot;,
        &quot;statistic&quot;: &quot;&#x27;median&#x27;&quot;,
        &quot;min_periods&quot;: &quot;None&quot;,
        &quot;print_report&quot;: &quot;True&quot;
      }
    ]</dd></dl></div><div class='xr-var-data'><pre>array([[[[1086.02038574],
             [1083.36999512]],

            [[ 421.54428101],
             [ 421.45770264]]],


           [[[1086.02038574],
             [1083.36999512]],

            [[ 421.54428101],
             [ 421.45770264]]],


           [[[1085.78253174],
             [1083.15985107]],

            [[ 421.67584229],
             [ 421.53366089]]],

    ...

           [[[   0.        ],
             [   0.        ]],

            [[   0.        ],
             [   0.        ]]],


           [[[   0.        ],
             [   0.        ]],

            [[   0.        ],
             [   0.        ]]],


           [[[   0.        ],
             [   0.        ]],

            [[   0.        ],
             [   0.        ]]]], shape=(1085, 2, 2, 1))</pre></div></li><li class='xr-var-item'><div class='xr-var-name'><span>confidence</span></div><div class='xr-var-dims'>(time, keypoints, individuals)</div><div class='xr-var-dtype'>float64</div><div class='xr-var-preview xr-preview'>0.05305 0.07366 0.03532 ... 0.0 0.0</div><input id='attrs-95baad56-c605-4397-8fd1-863754c1e265' class='xr-var-attrs-in' type='checkbox' disabled><label for='attrs-95baad56-c605-4397-8fd1-863754c1e265' title='Show/Hide attributes'><svg class='icon xr-icon-file-text2'><use xlink:href='#icon-file-text2'></use></svg></label><input id='data-e93ccede-3893-4c12-b0a9-85187d4f0f1b' class='xr-var-data-in' type='checkbox'><label for='data-e93ccede-3893-4c12-b0a9-85187d4f0f1b' title='Show/Hide data repr'><svg class='icon xr-icon-database'><use xlink:href='#icon-database'></use></svg></label><div class='xr-var-attrs'><dl class='xr-attrs'></dl></div><div class='xr-var-data'><pre>array([[[0.05305099],
            [0.07366323]],

           [[0.03531652],
            [0.03293059]],

           [[0.01706707],
            [0.01022208]],

           ...,

           [[0.        ],
            [0.        ]],

           [[0.        ],
            [0.        ]],

           [[0.        ],
            [0.        ]]], shape=(1085, 2, 1))</pre></div></li></ul></div></li><li class='xr-section-item'><input id='section-c319c932-160b-4dc3-80e2-27a3dde829b0' class='xr-section-summary-in' type='checkbox'  ><label for='section-c319c932-160b-4dc3-80e2-27a3dde829b0' class='xr-section-summary' >Indexes: <span>(4)</span></label><div class='xr-section-inline-details'></div><div class='xr-section-details'><ul class='xr-var-list'><li class='xr-var-item'><div class='xr-index-name'><div>time</div></div><div class='xr-index-preview'>PandasIndex</div><input type='checkbox' disabled/><label></label><input id='index-19bd8fb0-e78a-48a2-aa25-2cbcdbbda313' class='xr-index-data-in' type='checkbox'/><label for='index-19bd8fb0-e78a-48a2-aa25-2cbcdbbda313' title='Show/Hide index repr'><svg class='icon xr-icon-database'><use xlink:href='#icon-database'></use></svg></label><div class='xr-index-data'><pre>PandasIndex(Index([   0.0,  0.025,   0.05,  0.075,    0.1,  0.125,   0.15,  0.175,    0.2,
            0.225,
           ...
           26.875,   26.9, 26.925,  26.95, 26.975,   27.0, 27.025,  27.05, 27.075,
             27.1],
          dtype=&#x27;float64&#x27;, name=&#x27;time&#x27;, length=1085))</pre></div></li><li class='xr-var-item'><div class='xr-index-name'><div>space</div></div><div class='xr-index-preview'>PandasIndex</div><input type='checkbox' disabled/><label></label><input id='index-fb8767d2-e74f-49ed-9aed-d9f8d27db6f4' class='xr-index-data-in' type='checkbox'/><label for='index-fb8767d2-e74f-49ed-9aed-d9f8d27db6f4' title='Show/Hide index repr'><svg class='icon xr-icon-database'><use xlink:href='#icon-database'></use></svg></label><div class='xr-index-data'><pre>PandasIndex(Index([&#x27;x&#x27;, &#x27;y&#x27;], dtype=&#x27;object&#x27;, name=&#x27;space&#x27;))</pre></div></li><li class='xr-var-item'><div class='xr-index-name'><div>keypoints</div></div><div class='xr-index-preview'>PandasIndex</div><input type='checkbox' disabled/><label></label><input id='index-b5be0661-45f4-435c-8def-04faea9c897f' class='xr-index-data-in' type='checkbox'/><label for='index-b5be0661-45f4-435c-8def-04faea9c897f' title='Show/Hide index repr'><svg class='icon xr-icon-database'><use xlink:href='#icon-database'></use></svg></label><div class='xr-index-data'><pre>PandasIndex(Index([&#x27;head&#x27;, &#x27;stinger&#x27;], dtype=&#x27;object&#x27;, name=&#x27;keypoints&#x27;))</pre></div></li><li class='xr-var-item'><div class='xr-index-name'><div>individuals</div></div><div class='xr-index-preview'>PandasIndex</div><input type='checkbox' disabled/><label></label><input id='index-ec2eb55e-9718-4809-bea1-eb9446481ecf' class='xr-index-data-in' type='checkbox'/><label for='index-ec2eb55e-9718-4809-bea1-eb9446481ecf' title='Show/Hide index repr'><svg class='icon xr-icon-database'><use xlink:href='#icon-database'></use></svg></label><div class='xr-index-data'><pre>PandasIndex(Index([&#x27;individual_0&#x27;], dtype=&#x27;object&#x27;, name=&#x27;individuals&#x27;))</pre></div></li></ul></div></li><li class='xr-section-item'><input id='section-fb3a7d07-a768-40ec-b540-804c1212afea' class='xr-section-summary-in' type='checkbox'  checked><label for='section-fb3a7d07-a768-40ec-b540-804c1212afea' class='xr-section-summary' >Attributes: <span>(6)</span></label><div class='xr-section-inline-details'></div><div class='xr-section-details'><dl class='xr-attrs'><dt><span>source_software :</span></dt><dd>DeepLabCut</dd><dt><span>ds_type :</span></dt><dd>poses</dd><dt><span>fps :</span></dt><dd>40.0</dd><dt><span>time_unit :</span></dt><dd>seconds</dd><dt><span>source_file :</span></dt><dd>/home/runner/.movement/data/poses/DLC_single-wasp.predictions.h5</dd><dt><span>frame_path :</span></dt><dd>/home/runner/.movement/data/frames/single-wasp_frame-10sec.png</dd></dl></div></li></ul></div></div>
    </div>
    <br />
    <br />

.. GENERATED FROM PYTHON SOURCE LINES 143-146

We see from the printed report that the dataset has no missing values
neither before nor after smoothing. Let's visualise the effects of applying
the rolling median filter in the time and frequency domains.

.. GENERATED FROM PYTHON SOURCE LINES 146-151

.. code-block:: Python


    plot_raw_and_smooth_timeseries_and_psd(
        ds_wasp, ds_wasp_smooth, keypoint="stinger"
    )




.. image-sg:: /examples/images/sphx_glr_smooth_001.png
   :alt: Time Domain, Frequency Domain
   :srcset: /examples/images/sphx_glr_smooth_001.png
   :class: sphx-glr-single-img





.. GENERATED FROM PYTHON SOURCE LINES 152-162

We see that applying the filter has removed the "spikes" present around the
14 second mark in the raw data. However, it has not dealt with the big shift
occurring during the final second. In the frequency domain, we can see that
the filter has reduced the power in the high-frequency components, without
affecting the low frequency components.

This shows what the rolling median is good for: removing brief "spikes"
(e.g. a keypoint abruptly jumping to a different location for a frame or two)
and high-frequency "jitter" (often present due to pose estimation
working on a per-frame basis).

.. GENERATED FROM PYTHON SOURCE LINES 164-171

Choosing parameters for the rolling filter
^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
We can control the behaviour of the rolling filter
via three parameters: ``window``, ``min_periods`` and ``statistic`` which was
mentioned above.
To better understand the effect of these parameters, let's use a
dataset that contains missing values.

.. GENERATED FROM PYTHON SOURCE LINES 171-175

.. code-block:: Python


    ds_mouse = sample_data.fetch_dataset("SLEAP_single-mouse_EPM.analysis.h5")
    print(ds_mouse)





.. rst-class:: sphx-glr-script-out

 .. code-block:: none

    <xarray.Dataset> Size: 1MB
    Dimensions:      (time: 18485, space: 2, keypoints: 6, individuals: 1)
    Coordinates:
      * time         (time) float64 148kB 0.0 0.03333 0.06667 ... 616.1 616.1 616.1
      * space        (space) <U1 8B 'x' 'y'
      * keypoints    (keypoints) <U9 216B 'snout' 'left_ear' ... 'tail_end'
      * individuals  (individuals) <U4 16B 'id_0'
    Data variables:
        position     (time, space, keypoints, individuals) float32 887kB nan ... ...
        confidence   (time, keypoints, individuals) float32 444kB nan nan ... 0.7607
    Attributes:
        source_software:  SLEAP
        ds_type:          poses
        fps:              30.0
        time_unit:        seconds
        source_file:      /home/runner/.movement/data/poses/SLEAP_single-mouse_EP...
        frame_path:       /home/runner/.movement/data/frames/single-mouse_EPM_fra...




.. GENERATED FROM PYTHON SOURCE LINES 176-182

The dataset contains a single mouse with six keypoints tracked in
2D space. The video was recorded at 30 fps and lasts for ~616 seconds. We can
see that there are some missing values, indicated as "nan" in the
printed dataset.
Let's apply the rolling median filter over a 0.1-second window (3 frames)
to the dataset.

.. GENERATED FROM PYTHON SOURCE LINES 182-193

.. code-block:: Python


    window = int(0.1 * ds_mouse.fps)
    ds_mouse_smooth = ds_mouse.copy()
    ds_mouse_smooth.update(
        {
            "position": rolling_filter(
                ds_mouse.position, window, statistic="median", print_report=True
            )
        }
    )





.. rst-class:: sphx-glr-script-out

 .. code-block:: none

    Missing points (marked as NaN) in input:

    keypoints                  snout           left_ear          right_ear             centre          tail_base            tail_end
    individuals                                                                                                                     
    id_0         4494/18485 (24.31%)  513/18485 (2.78%)  533/18485 (2.88%)  490/18485 (2.65%)  704/18485 (3.81%)  2496/18485 (13.5%)
    Missing points (marked as NaN) in output:

    keypoints                  snout           left_ear          right_ear             centre          tail_base             tail_end
    individuals                                                                                                                      
    id_0         5106/18485 (27.62%)  678/18485 (3.67%)  695/18485 (3.76%)  640/18485 (3.46%)  913/18485 (4.94%)  3103/18485 (16.79%)


.. raw:: html

    <div class="output_subarea output_html rendered_html output_result">
    <div><svg style="position: absolute; width: 0; height: 0; overflow: hidden">
    <defs>
    <symbol id="icon-database" viewBox="0 0 32 32">
    <path d="M16 0c-8.837 0-16 2.239-16 5v4c0 2.761 7.163 5 16 5s16-2.239 16-5v-4c0-2.761-7.163-5-16-5z"></path>
    <path d="M16 17c-8.837 0-16-2.239-16-5v6c0 2.761 7.163 5 16 5s16-2.239 16-5v-6c0 2.761-7.163 5-16 5z"></path>
    <path d="M16 26c-8.837 0-16-2.239-16-5v6c0 2.761 7.163 5 16 5s16-2.239 16-5v-6c0 2.761-7.163 5-16 5z"></path>
    </symbol>
    <symbol id="icon-file-text2" viewBox="0 0 32 32">
    <path d="M28.681 7.159c-0.694-0.947-1.662-2.053-2.724-3.116s-2.169-2.030-3.116-2.724c-1.612-1.182-2.393-1.319-2.841-1.319h-15.5c-1.378 0-2.5 1.121-2.5 2.5v27c0 1.378 1.122 2.5 2.5 2.5h23c1.378 0 2.5-1.122 2.5-2.5v-19.5c0-0.448-0.137-1.23-1.319-2.841zM24.543 5.457c0.959 0.959 1.712 1.825 2.268 2.543h-4.811v-4.811c0.718 0.556 1.584 1.309 2.543 2.268zM28 29.5c0 0.271-0.229 0.5-0.5 0.5h-23c-0.271 0-0.5-0.229-0.5-0.5v-27c0-0.271 0.229-0.5 0.5-0.5 0 0 15.499-0 15.5 0v7c0 0.552 0.448 1 1 1h7v19.5z"></path>
    <path d="M23 26h-14c-0.552 0-1-0.448-1-1s0.448-1 1-1h14c0.552 0 1 0.448 1 1s-0.448 1-1 1z"></path>
    <path d="M23 22h-14c-0.552 0-1-0.448-1-1s0.448-1 1-1h14c0.552 0 1 0.448 1 1s-0.448 1-1 1z"></path>
    <path d="M23 18h-14c-0.552 0-1-0.448-1-1s0.448-1 1-1h14c0.552 0 1 0.448 1 1s-0.448 1-1 1z"></path>
    </symbol>
    </defs>
    </svg>
    <style>/* CSS stylesheet for displaying xarray objects in jupyterlab.
     *
     */

    :root {
      --xr-font-color0: var(
        --jp-content-font-color0,
        var(--pst-color-text-base rgba(0, 0, 0, 1))
      );
      --xr-font-color2: var(
        --jp-content-font-color2,
        var(--pst-color-text-base, rgba(0, 0, 0, 0.54))
      );
      --xr-font-color3: var(
        --jp-content-font-color3,
        var(--pst-color-text-base, rgba(0, 0, 0, 0.38))
      );
      --xr-border-color: var(
        --jp-border-color2,
        hsl(from var(--pst-color-on-background, white) h s calc(l - 10))
      );
      --xr-disabled-color: var(
        --jp-layout-color3,
        hsl(from var(--pst-color-on-background, white) h s calc(l - 40))
      );
      --xr-background-color: var(
        --jp-layout-color0,
        var(--pst-color-on-background, white)
      );
      --xr-background-color-row-even: var(
        --jp-layout-color1,
        hsl(from var(--pst-color-on-background, white) h s calc(l - 5))
      );
      --xr-background-color-row-odd: var(
        --jp-layout-color2,
        hsl(from var(--pst-color-on-background, white) h s calc(l - 15))
      );
    }

    html[theme="dark"],
    html[data-theme="dark"],
    body[data-theme="dark"],
    body.vscode-dark {
      --xr-font-color0: var(
        --jp-content-font-color0,
        var(--pst-color-text-base, rgba(255, 255, 255, 1))
      );
      --xr-font-color2: var(
        --jp-content-font-color2,
        var(--pst-color-text-base, rgba(255, 255, 255, 0.54))
      );
      --xr-font-color3: var(
        --jp-content-font-color3,
        var(--pst-color-text-base, rgba(255, 255, 255, 0.38))
      );
      --xr-border-color: var(
        --jp-border-color2,
        hsl(from var(--pst-color-on-background, #111111) h s calc(l + 10))
      );
      --xr-disabled-color: var(
        --jp-layout-color3,
        hsl(from var(--pst-color-on-background, #111111) h s calc(l + 40))
      );
      --xr-background-color: var(
        --jp-layout-color0,
        var(--pst-color-on-background, #111111)
      );
      --xr-background-color-row-even: var(
        --jp-layout-color1,
        hsl(from var(--pst-color-on-background, #111111) h s calc(l + 5))
      );
      --xr-background-color-row-odd: var(
        --jp-layout-color2,
        hsl(from var(--pst-color-on-background, #111111) h s calc(l + 15))
      );
    }

    .xr-wrap {
      display: block !important;
      min-width: 300px;
      max-width: 700px;
    }

    .xr-text-repr-fallback {
      /* fallback to plain text repr when CSS is not injected (untrusted notebook) */
      display: none;
    }

    .xr-header {
      padding-top: 6px;
      padding-bottom: 6px;
      margin-bottom: 4px;
      border-bottom: solid 1px var(--xr-border-color);
    }

    .xr-header > div,
    .xr-header > ul {
      display: inline;
      margin-top: 0;
      margin-bottom: 0;
    }

    .xr-obj-type,
    .xr-array-name {
      margin-left: 2px;
      margin-right: 10px;
    }

    .xr-obj-type {
      color: var(--xr-font-color2);
    }

    .xr-sections {
      padding-left: 0 !important;
      display: grid;
      grid-template-columns: 150px auto auto 1fr 0 20px 0 20px;
    }

    .xr-section-item {
      display: contents;
    }

    .xr-section-item input {
      display: inline-block;
      opacity: 0;
      height: 0;
    }

    .xr-section-item input + label {
      color: var(--xr-disabled-color);
      border: 2px solid transparent !important;
    }

    .xr-section-item input:enabled + label {
      cursor: pointer;
      color: var(--xr-font-color2);
    }

    .xr-section-item input:focus + label {
      border: 2px solid var(--xr-font-color0) !important;
    }

    .xr-section-item input:enabled + label:hover {
      color: var(--xr-font-color0);
    }

    .xr-section-summary {
      grid-column: 1;
      color: var(--xr-font-color2);
      font-weight: 500;
    }

    .xr-section-summary > span {
      display: inline-block;
      padding-left: 0.5em;
    }

    .xr-section-summary-in:disabled + label {
      color: var(--xr-font-color2);
    }

    .xr-section-summary-in + label:before {
      display: inline-block;
      content: "►";
      font-size: 11px;
      width: 15px;
      text-align: center;
    }

    .xr-section-summary-in:disabled + label:before {
      color: var(--xr-disabled-color);
    }

    .xr-section-summary-in:checked + label:before {
      content: "▼";
    }

    .xr-section-summary-in:checked + label > span {
      display: none;
    }

    .xr-section-summary,
    .xr-section-inline-details {
      padding-top: 4px;
      padding-bottom: 4px;
    }

    .xr-section-inline-details {
      grid-column: 2 / -1;
    }

    .xr-section-details {
      display: none;
      grid-column: 1 / -1;
      margin-bottom: 5px;
    }

    .xr-section-summary-in:checked ~ .xr-section-details {
      display: contents;
    }

    .xr-array-wrap {
      grid-column: 1 / -1;
      display: grid;
      grid-template-columns: 20px auto;
    }

    .xr-array-wrap > label {
      grid-column: 1;
      vertical-align: top;
    }

    .xr-preview {
      color: var(--xr-font-color3);
    }

    .xr-array-preview,
    .xr-array-data {
      padding: 0 5px !important;
      grid-column: 2;
    }

    .xr-array-data,
    .xr-array-in:checked ~ .xr-array-preview {
      display: none;
    }

    .xr-array-in:checked ~ .xr-array-data,
    .xr-array-preview {
      display: inline-block;
    }

    .xr-dim-list {
      display: inline-block !important;
      list-style: none;
      padding: 0 !important;
      margin: 0;
    }

    .xr-dim-list li {
      display: inline-block;
      padding: 0;
      margin: 0;
    }

    .xr-dim-list:before {
      content: "(";
    }

    .xr-dim-list:after {
      content: ")";
    }

    .xr-dim-list li:not(:last-child):after {
      content: ",";
      padding-right: 5px;
    }

    .xr-has-index {
      font-weight: bold;
    }

    .xr-var-list,
    .xr-var-item {
      display: contents;
    }

    .xr-var-item > div,
    .xr-var-item label,
    .xr-var-item > .xr-var-name span {
      background-color: var(--xr-background-color-row-even);
      border-color: var(--xr-background-color-row-odd);
      margin-bottom: 0;
      padding-top: 2px;
    }

    .xr-var-item > .xr-var-name:hover span {
      padding-right: 5px;
    }

    .xr-var-list > li:nth-child(odd) > div,
    .xr-var-list > li:nth-child(odd) > label,
    .xr-var-list > li:nth-child(odd) > .xr-var-name span {
      background-color: var(--xr-background-color-row-odd);
      border-color: var(--xr-background-color-row-even);
    }

    .xr-var-name {
      grid-column: 1;
    }

    .xr-var-dims {
      grid-column: 2;
    }

    .xr-var-dtype {
      grid-column: 3;
      text-align: right;
      color: var(--xr-font-color2);
    }

    .xr-var-preview {
      grid-column: 4;
    }

    .xr-index-preview {
      grid-column: 2 / 5;
      color: var(--xr-font-color2);
    }

    .xr-var-name,
    .xr-var-dims,
    .xr-var-dtype,
    .xr-preview,
    .xr-attrs dt {
      white-space: nowrap;
      overflow: hidden;
      text-overflow: ellipsis;
      padding-right: 10px;
    }

    .xr-var-name:hover,
    .xr-var-dims:hover,
    .xr-var-dtype:hover,
    .xr-attrs dt:hover {
      overflow: visible;
      width: auto;
      z-index: 1;
    }

    .xr-var-attrs,
    .xr-var-data,
    .xr-index-data {
      display: none;
      border-top: 2px dotted var(--xr-background-color);
      padding-bottom: 20px !important;
      padding-top: 10px !important;
    }

    .xr-var-attrs-in + label,
    .xr-var-data-in + label,
    .xr-index-data-in + label {
      padding: 0 1px;
    }

    .xr-var-attrs-in:checked ~ .xr-var-attrs,
    .xr-var-data-in:checked ~ .xr-var-data,
    .xr-index-data-in:checked ~ .xr-index-data {
      display: block;
    }

    .xr-var-data > table {
      float: right;
    }

    .xr-var-data > pre,
    .xr-index-data > pre,
    .xr-var-data > table > tbody > tr {
      background-color: transparent !important;
    }

    .xr-var-name span,
    .xr-var-data,
    .xr-index-name div,
    .xr-index-data,
    .xr-attrs {
      padding-left: 25px !important;
    }

    .xr-attrs,
    .xr-var-attrs,
    .xr-var-data,
    .xr-index-data {
      grid-column: 1 / -1;
    }

    dl.xr-attrs {
      padding: 0;
      margin: 0;
      display: grid;
      grid-template-columns: 125px auto;
    }

    .xr-attrs dt,
    .xr-attrs dd {
      padding: 0;
      margin: 0;
      float: left;
      padding-right: 10px;
      width: auto;
    }

    .xr-attrs dt {
      font-weight: normal;
      grid-column: 1;
    }

    .xr-attrs dt:hover span {
      display: inline-block;
      background: var(--xr-background-color);
      padding-right: 10px;
    }

    .xr-attrs dd {
      grid-column: 2;
      white-space: pre-wrap;
      word-break: break-all;
    }

    .xr-icon-database,
    .xr-icon-file-text2,
    .xr-no-icon {
      display: inline-block;
      vertical-align: middle;
      width: 1em;
      height: 1.5em !important;
      stroke-width: 0;
      stroke: currentColor;
      fill: currentColor;
    }

    .xr-var-attrs-in:checked + label > .xr-icon-file-text2,
    .xr-var-data-in:checked + label > .xr-icon-database,
    .xr-index-data-in:checked + label > .xr-icon-database {
      color: var(--xr-font-color0);
      filter: drop-shadow(1px 1px 5px var(--xr-font-color2));
      stroke-width: 0.8px;
    }
    </style><pre class='xr-text-repr-fallback'>&lt;xarray.Dataset&gt; Size: 1MB
    Dimensions:      (time: 18485, space: 2, keypoints: 6, individuals: 1)
    Coordinates:
      * time         (time) float64 148kB 0.0 0.03333 0.06667 ... 616.1 616.1 616.1
      * space        (space) &lt;U1 8B &#x27;x&#x27; &#x27;y&#x27;
      * keypoints    (keypoints) &lt;U9 216B &#x27;snout&#x27; &#x27;left_ear&#x27; ... &#x27;tail_end&#x27;
      * individuals  (individuals) &lt;U4 16B &#x27;id_0&#x27;
    Data variables:
        position     (time, space, keypoints, individuals) float32 887kB nan ... ...
        confidence   (time, keypoints, individuals) float32 444kB nan nan ... 0.7607
    Attributes:
        source_software:  SLEAP
        ds_type:          poses
        fps:              30.0
        time_unit:        seconds
        source_file:      /home/runner/.movement/data/poses/SLEAP_single-mouse_EP...
        frame_path:       /home/runner/.movement/data/frames/single-mouse_EPM_fra...</pre><div class='xr-wrap' style='display:none'><div class='xr-header'><div class='xr-obj-type'>xarray.Dataset</div></div><ul class='xr-sections'><li class='xr-section-item'><input id='section-37390388-ee7b-4aa7-9928-97d829250039' class='xr-section-summary-in' type='checkbox' disabled ><label for='section-37390388-ee7b-4aa7-9928-97d829250039' class='xr-section-summary'  title='Expand/collapse section'>Dimensions:</label><div class='xr-section-inline-details'><ul class='xr-dim-list'><li><span class='xr-has-index'>time</span>: 18485</li><li><span class='xr-has-index'>space</span>: 2</li><li><span class='xr-has-index'>keypoints</span>: 6</li><li><span class='xr-has-index'>individuals</span>: 1</li></ul></div><div class='xr-section-details'></div></li><li class='xr-section-item'><input id='section-d056d7bf-5b91-4609-883f-65853d156dec' class='xr-section-summary-in' type='checkbox'  checked><label for='section-d056d7bf-5b91-4609-883f-65853d156dec' class='xr-section-summary' >Coordinates: <span>(4)</span></label><div class='xr-section-inline-details'></div><div class='xr-section-details'><ul class='xr-var-list'><li class='xr-var-item'><div class='xr-var-name'><span class='xr-has-index'>time</span></div><div class='xr-var-dims'>(time)</div><div class='xr-var-dtype'>float64</div><div class='xr-var-preview xr-preview'>0.0 0.03333 0.06667 ... 616.1 616.1</div><input id='attrs-c7d701a3-2d40-4135-81c2-f6f1b4be9e23' class='xr-var-attrs-in' type='checkbox' disabled><label for='attrs-c7d701a3-2d40-4135-81c2-f6f1b4be9e23' title='Show/Hide attributes'><svg class='icon xr-icon-file-text2'><use xlink:href='#icon-file-text2'></use></svg></label><input id='data-f9ce372f-ad2f-4b2f-ae82-62113229ce96' class='xr-var-data-in' type='checkbox'><label for='data-f9ce372f-ad2f-4b2f-ae82-62113229ce96' title='Show/Hide data repr'><svg class='icon xr-icon-database'><use xlink:href='#icon-database'></use></svg></label><div class='xr-var-attrs'><dl class='xr-attrs'></dl></div><div class='xr-var-data'><pre>array([0.000000e+00, 3.333333e-02, 6.666667e-02, ..., 6.160667e+02,
           6.161000e+02, 6.161333e+02], shape=(18485,))</pre></div></li><li class='xr-var-item'><div class='xr-var-name'><span class='xr-has-index'>space</span></div><div class='xr-var-dims'>(space)</div><div class='xr-var-dtype'>&lt;U1</div><div class='xr-var-preview xr-preview'>&#x27;x&#x27; &#x27;y&#x27;</div><input id='attrs-cd039650-d0f8-4026-865f-2a9b3e99da4e' class='xr-var-attrs-in' type='checkbox' disabled><label for='attrs-cd039650-d0f8-4026-865f-2a9b3e99da4e' title='Show/Hide attributes'><svg class='icon xr-icon-file-text2'><use xlink:href='#icon-file-text2'></use></svg></label><input id='data-aa825a4b-99ae-4fdb-928c-a883c01abace' class='xr-var-data-in' type='checkbox'><label for='data-aa825a4b-99ae-4fdb-928c-a883c01abace' title='Show/Hide data repr'><svg class='icon xr-icon-database'><use xlink:href='#icon-database'></use></svg></label><div class='xr-var-attrs'><dl class='xr-attrs'></dl></div><div class='xr-var-data'><pre>array([&#x27;x&#x27;, &#x27;y&#x27;], dtype=&#x27;&lt;U1&#x27;)</pre></div></li><li class='xr-var-item'><div class='xr-var-name'><span class='xr-has-index'>keypoints</span></div><div class='xr-var-dims'>(keypoints)</div><div class='xr-var-dtype'>&lt;U9</div><div class='xr-var-preview xr-preview'>&#x27;snout&#x27; &#x27;left_ear&#x27; ... &#x27;tail_end&#x27;</div><input id='attrs-b5ecd3a0-9b58-4794-8420-12614fe8acfb' class='xr-var-attrs-in' type='checkbox' disabled><label for='attrs-b5ecd3a0-9b58-4794-8420-12614fe8acfb' title='Show/Hide attributes'><svg class='icon xr-icon-file-text2'><use xlink:href='#icon-file-text2'></use></svg></label><input id='data-1bc90c70-028e-42dc-bb5c-ef33b1ae2529' class='xr-var-data-in' type='checkbox'><label for='data-1bc90c70-028e-42dc-bb5c-ef33b1ae2529' title='Show/Hide data repr'><svg class='icon xr-icon-database'><use xlink:href='#icon-database'></use></svg></label><div class='xr-var-attrs'><dl class='xr-attrs'></dl></div><div class='xr-var-data'><pre>array([&#x27;snout&#x27;, &#x27;left_ear&#x27;, &#x27;right_ear&#x27;, &#x27;centre&#x27;, &#x27;tail_base&#x27;, &#x27;tail_end&#x27;],
          dtype=&#x27;&lt;U9&#x27;)</pre></div></li><li class='xr-var-item'><div class='xr-var-name'><span class='xr-has-index'>individuals</span></div><div class='xr-var-dims'>(individuals)</div><div class='xr-var-dtype'>&lt;U4</div><div class='xr-var-preview xr-preview'>&#x27;id_0&#x27;</div><input id='attrs-546f48a5-b65d-4c45-a58d-bd0aabd62d9c' class='xr-var-attrs-in' type='checkbox' disabled><label for='attrs-546f48a5-b65d-4c45-a58d-bd0aabd62d9c' title='Show/Hide attributes'><svg class='icon xr-icon-file-text2'><use xlink:href='#icon-file-text2'></use></svg></label><input id='data-e1f11f25-97e8-4fa6-85c3-5bdaf9f41578' class='xr-var-data-in' type='checkbox'><label for='data-e1f11f25-97e8-4fa6-85c3-5bdaf9f41578' title='Show/Hide data repr'><svg class='icon xr-icon-database'><use xlink:href='#icon-database'></use></svg></label><div class='xr-var-attrs'><dl class='xr-attrs'></dl></div><div class='xr-var-data'><pre>array([&#x27;id_0&#x27;], dtype=&#x27;&lt;U4&#x27;)</pre></div></li></ul></div></li><li class='xr-section-item'><input id='section-7d976886-e25d-4e2c-bbba-b4af3bd35e40' class='xr-section-summary-in' type='checkbox'  checked><label for='section-7d976886-e25d-4e2c-bbba-b4af3bd35e40' class='xr-section-summary' >Data variables: <span>(2)</span></label><div class='xr-section-inline-details'></div><div class='xr-section-details'><ul class='xr-var-list'><li class='xr-var-item'><div class='xr-var-name'><span>position</span></div><div class='xr-var-dims'>(time, space, keypoints, individuals)</div><div class='xr-var-dtype'>float32</div><div class='xr-var-preview xr-preview'>nan nan nan ... 440.0 384.0 476.3</div><input id='attrs-8626f21b-9068-452a-a744-39359469bdc0' class='xr-var-attrs-in' type='checkbox' ><label for='attrs-8626f21b-9068-452a-a744-39359469bdc0' title='Show/Hide attributes'><svg class='icon xr-icon-file-text2'><use xlink:href='#icon-file-text2'></use></svg></label><input id='data-2f62dbea-0525-48aa-aca0-f3aa09f8ea01' class='xr-var-data-in' type='checkbox'><label for='data-2f62dbea-0525-48aa-aca0-f3aa09f8ea01' title='Show/Hide data repr'><svg class='icon xr-icon-database'><use xlink:href='#icon-database'></use></svg></label><div class='xr-var-attrs'><dl class='xr-attrs'><dt><span>log :</span></dt><dd>[
      {
        &quot;operation&quot;: &quot;rolling_filter&quot;,
        &quot;datetime&quot;: &quot;2025-07-22 16:47:39.667073&quot;,
        &quot;window&quot;: &quot;3&quot;,
        &quot;statistic&quot;: &quot;&#x27;median&#x27;&quot;,
        &quot;min_periods&quot;: &quot;None&quot;,
        &quot;print_report&quot;: &quot;True&quot;
      }
    ]</dd></dl></div><div class='xr-var-data'><pre>array([[[[      nan],
             [      nan],
             [      nan],
             [      nan],
             [      nan],
             [      nan]],

            [[      nan],
             [      nan],
             [      nan],
             [      nan],
             [      nan],
             [      nan]]],


           [[[      nan],
             [      nan],
             [      nan],
             [      nan],
             [      nan],
    ...
             [484.86316],
             [492.0457 ],
             [439.9774 ],
             [384.10602],
             [476.33466]]],


           [[[688.18134],
             [692.3218 ],
             [668.4878 ],
             [667.9094 ],
             [636.8362 ],
             [588.56854]],

            [[507.72455],
             [484.5658 ],
             [492.0457 ],
             [439.9774 ],
             [384.02936],
             [476.33466]]]], shape=(18485, 2, 6, 1), dtype=float32)</pre></div></li><li class='xr-var-item'><div class='xr-var-name'><span>confidence</span></div><div class='xr-var-dims'>(time, keypoints, individuals)</div><div class='xr-var-dtype'>float32</div><div class='xr-var-preview xr-preview'>nan nan nan ... 0.9336 0.7607</div><input id='attrs-9f88f329-3081-4e12-b98d-33d3f081e7b0' class='xr-var-attrs-in' type='checkbox' disabled><label for='attrs-9f88f329-3081-4e12-b98d-33d3f081e7b0' title='Show/Hide attributes'><svg class='icon xr-icon-file-text2'><use xlink:href='#icon-file-text2'></use></svg></label><input id='data-e4bf813e-69c8-49ab-9498-086a3b94c84e' class='xr-var-data-in' type='checkbox'><label for='data-e4bf813e-69c8-49ab-9498-086a3b94c84e' title='Show/Hide data repr'><svg class='icon xr-icon-database'><use xlink:href='#icon-database'></use></svg></label><div class='xr-var-attrs'><dl class='xr-attrs'></dl></div><div class='xr-var-data'><pre>array([[[       nan],
            [       nan],
            [       nan],
            [       nan],
            [       nan],
            [       nan]],

           [[       nan],
            [       nan],
            [       nan],
            [       nan],
            [       nan],
            [       nan]],

           [[       nan],
            [       nan],
            [       nan],
            [       nan],
            [       nan],
            [       nan]],
    ...
           [[0.9317396 ],
            [1.0026728 ],
            [1.025079  ],
            [0.92725545],
            [0.95202184],
            [0.7779419 ]],

           [[0.9193515 ],
            [1.0136327 ],
            [1.0336665 ],
            [0.93108493],
            [0.94561106],
            [0.7662804 ]],

           [[0.93820494],
            [1.0224991 ],
            [1.0452943 ],
            [0.9363993 ],
            [0.9335798 ],
            [0.76068705]]], shape=(18485, 6, 1), dtype=float32)</pre></div></li></ul></div></li><li class='xr-section-item'><input id='section-3e33c82f-2763-48ed-ac11-a9106fc03dd5' class='xr-section-summary-in' type='checkbox'  ><label for='section-3e33c82f-2763-48ed-ac11-a9106fc03dd5' class='xr-section-summary' >Indexes: <span>(4)</span></label><div class='xr-section-inline-details'></div><div class='xr-section-details'><ul class='xr-var-list'><li class='xr-var-item'><div class='xr-index-name'><div>time</div></div><div class='xr-index-preview'>PandasIndex</div><input type='checkbox' disabled/><label></label><input id='index-0dfa4c77-cb9c-41bf-984f-3a67ad3746e3' class='xr-index-data-in' type='checkbox'/><label for='index-0dfa4c77-cb9c-41bf-984f-3a67ad3746e3' title='Show/Hide index repr'><svg class='icon xr-icon-database'><use xlink:href='#icon-database'></use></svg></label><div class='xr-index-data'><pre>PandasIndex(Index([                0.0, 0.03333333333333333, 0.06666666666666667,
                           0.1, 0.13333333333333333, 0.16666666666666666,
                           0.2, 0.23333333333333334, 0.26666666666666666,
                           0.3,
           ...
             615.8333333333334,   615.8666666666667,               615.9,
             615.9333333333333,   615.9666666666667,               616.0,
             616.0333333333333,   616.0666666666667,               616.1,
             616.1333333333333],
          dtype=&#x27;float64&#x27;, name=&#x27;time&#x27;, length=18485))</pre></div></li><li class='xr-var-item'><div class='xr-index-name'><div>space</div></div><div class='xr-index-preview'>PandasIndex</div><input type='checkbox' disabled/><label></label><input id='index-6b6c3a44-d1ee-46ec-8499-2fa6e1364f65' class='xr-index-data-in' type='checkbox'/><label for='index-6b6c3a44-d1ee-46ec-8499-2fa6e1364f65' title='Show/Hide index repr'><svg class='icon xr-icon-database'><use xlink:href='#icon-database'></use></svg></label><div class='xr-index-data'><pre>PandasIndex(Index([&#x27;x&#x27;, &#x27;y&#x27;], dtype=&#x27;object&#x27;, name=&#x27;space&#x27;))</pre></div></li><li class='xr-var-item'><div class='xr-index-name'><div>keypoints</div></div><div class='xr-index-preview'>PandasIndex</div><input type='checkbox' disabled/><label></label><input id='index-0154707a-b71d-4b17-9ead-42519411a913' class='xr-index-data-in' type='checkbox'/><label for='index-0154707a-b71d-4b17-9ead-42519411a913' title='Show/Hide index repr'><svg class='icon xr-icon-database'><use xlink:href='#icon-database'></use></svg></label><div class='xr-index-data'><pre>PandasIndex(Index([&#x27;snout&#x27;, &#x27;left_ear&#x27;, &#x27;right_ear&#x27;, &#x27;centre&#x27;, &#x27;tail_base&#x27;, &#x27;tail_end&#x27;], dtype=&#x27;object&#x27;, name=&#x27;keypoints&#x27;))</pre></div></li><li class='xr-var-item'><div class='xr-index-name'><div>individuals</div></div><div class='xr-index-preview'>PandasIndex</div><input type='checkbox' disabled/><label></label><input id='index-381857e3-e7a1-41af-bb3c-0062f8240ed3' class='xr-index-data-in' type='checkbox'/><label for='index-381857e3-e7a1-41af-bb3c-0062f8240ed3' title='Show/Hide index repr'><svg class='icon xr-icon-database'><use xlink:href='#icon-database'></use></svg></label><div class='xr-index-data'><pre>PandasIndex(Index([&#x27;id_0&#x27;], dtype=&#x27;object&#x27;, name=&#x27;individuals&#x27;))</pre></div></li></ul></div></li><li class='xr-section-item'><input id='section-945d5311-ac9b-472f-929c-4a46ffa1bcb8' class='xr-section-summary-in' type='checkbox'  checked><label for='section-945d5311-ac9b-472f-929c-4a46ffa1bcb8' class='xr-section-summary' >Attributes: <span>(6)</span></label><div class='xr-section-inline-details'></div><div class='xr-section-details'><dl class='xr-attrs'><dt><span>source_software :</span></dt><dd>SLEAP</dd><dt><span>ds_type :</span></dt><dd>poses</dd><dt><span>fps :</span></dt><dd>30.0</dd><dt><span>time_unit :</span></dt><dd>seconds</dd><dt><span>source_file :</span></dt><dd>/home/runner/.movement/data/poses/SLEAP_single-mouse_EPM.analysis.h5</dd><dt><span>frame_path :</span></dt><dd>/home/runner/.movement/data/frames/single-mouse_EPM_frame-20sec.png</dd></dl></div></li></ul></div></div>
    </div>
    <br />
    <br />

.. GENERATED FROM PYTHON SOURCE LINES 194-205

The report informs us that the raw data contains NaN values, most of which
occur at the ``snout`` and ``tail_end`` keypoints. After filtering, the
number of NaNs has increased. This is because the default behaviour of the
rolling filter is to propagate NaN values, i.e. if any value in the rolling
window is NaN, the output will also be NaN.

To modify this behaviour, you can set the value of the ``min_periods``
parameter to an integer value. This parameter determines the minimum number
of non-NaN values required in the window for the output to be non-NaN.
For example, setting ``min_periods=2`` means that two non-NaN values in the
window are sufficient for the median to be calculated. Let's try this.

.. GENERATED FROM PYTHON SOURCE LINES 205-218

.. code-block:: Python


    ds_mouse_smooth.update(
        {
            "position": rolling_filter(
                ds_mouse.position,
                window,
                min_periods=2,
                statistic="median",
                print_report=True,
            )
        }
    )





.. rst-class:: sphx-glr-script-out

 .. code-block:: none

    Missing points (marked as NaN) in input:

    keypoints                  snout           left_ear          right_ear             centre          tail_base            tail_end
    individuals                                                                                                                     
    id_0         4494/18485 (24.31%)  513/18485 (2.78%)  533/18485 (2.88%)  490/18485 (2.65%)  704/18485 (3.81%)  2496/18485 (13.5%)
    Missing points (marked as NaN) in output:

    keypoints                 snout           left_ear          right_ear             centre          tail_base             tail_end
    individuals                                                                                                                     
    id_0         4455/18485 (24.1%)  487/18485 (2.63%)  507/18485 (2.74%)  465/18485 (2.52%)  673/18485 (3.64%)  2428/18485 (13.13%)


.. raw:: html

    <div class="output_subarea output_html rendered_html output_result">
    <div><svg style="position: absolute; width: 0; height: 0; overflow: hidden">
    <defs>
    <symbol id="icon-database" viewBox="0 0 32 32">
    <path d="M16 0c-8.837 0-16 2.239-16 5v4c0 2.761 7.163 5 16 5s16-2.239 16-5v-4c0-2.761-7.163-5-16-5z"></path>
    <path d="M16 17c-8.837 0-16-2.239-16-5v6c0 2.761 7.163 5 16 5s16-2.239 16-5v-6c0 2.761-7.163 5-16 5z"></path>
    <path d="M16 26c-8.837 0-16-2.239-16-5v6c0 2.761 7.163 5 16 5s16-2.239 16-5v-6c0 2.761-7.163 5-16 5z"></path>
    </symbol>
    <symbol id="icon-file-text2" viewBox="0 0 32 32">
    <path d="M28.681 7.159c-0.694-0.947-1.662-2.053-2.724-3.116s-2.169-2.030-3.116-2.724c-1.612-1.182-2.393-1.319-2.841-1.319h-15.5c-1.378 0-2.5 1.121-2.5 2.5v27c0 1.378 1.122 2.5 2.5 2.5h23c1.378 0 2.5-1.122 2.5-2.5v-19.5c0-0.448-0.137-1.23-1.319-2.841zM24.543 5.457c0.959 0.959 1.712 1.825 2.268 2.543h-4.811v-4.811c0.718 0.556 1.584 1.309 2.543 2.268zM28 29.5c0 0.271-0.229 0.5-0.5 0.5h-23c-0.271 0-0.5-0.229-0.5-0.5v-27c0-0.271 0.229-0.5 0.5-0.5 0 0 15.499-0 15.5 0v7c0 0.552 0.448 1 1 1h7v19.5z"></path>
    <path d="M23 26h-14c-0.552 0-1-0.448-1-1s0.448-1 1-1h14c0.552 0 1 0.448 1 1s-0.448 1-1 1z"></path>
    <path d="M23 22h-14c-0.552 0-1-0.448-1-1s0.448-1 1-1h14c0.552 0 1 0.448 1 1s-0.448 1-1 1z"></path>
    <path d="M23 18h-14c-0.552 0-1-0.448-1-1s0.448-1 1-1h14c0.552 0 1 0.448 1 1s-0.448 1-1 1z"></path>
    </symbol>
    </defs>
    </svg>
    <style>/* CSS stylesheet for displaying xarray objects in jupyterlab.
     *
     */

    :root {
      --xr-font-color0: var(
        --jp-content-font-color0,
        var(--pst-color-text-base rgba(0, 0, 0, 1))
      );
      --xr-font-color2: var(
        --jp-content-font-color2,
        var(--pst-color-text-base, rgba(0, 0, 0, 0.54))
      );
      --xr-font-color3: var(
        --jp-content-font-color3,
        var(--pst-color-text-base, rgba(0, 0, 0, 0.38))
      );
      --xr-border-color: var(
        --jp-border-color2,
        hsl(from var(--pst-color-on-background, white) h s calc(l - 10))
      );
      --xr-disabled-color: var(
        --jp-layout-color3,
        hsl(from var(--pst-color-on-background, white) h s calc(l - 40))
      );
      --xr-background-color: var(
        --jp-layout-color0,
        var(--pst-color-on-background, white)
      );
      --xr-background-color-row-even: var(
        --jp-layout-color1,
        hsl(from var(--pst-color-on-background, white) h s calc(l - 5))
      );
      --xr-background-color-row-odd: var(
        --jp-layout-color2,
        hsl(from var(--pst-color-on-background, white) h s calc(l - 15))
      );
    }

    html[theme="dark"],
    html[data-theme="dark"],
    body[data-theme="dark"],
    body.vscode-dark {
      --xr-font-color0: var(
        --jp-content-font-color0,
        var(--pst-color-text-base, rgba(255, 255, 255, 1))
      );
      --xr-font-color2: var(
        --jp-content-font-color2,
        var(--pst-color-text-base, rgba(255, 255, 255, 0.54))
      );
      --xr-font-color3: var(
        --jp-content-font-color3,
        var(--pst-color-text-base, rgba(255, 255, 255, 0.38))
      );
      --xr-border-color: var(
        --jp-border-color2,
        hsl(from var(--pst-color-on-background, #111111) h s calc(l + 10))
      );
      --xr-disabled-color: var(
        --jp-layout-color3,
        hsl(from var(--pst-color-on-background, #111111) h s calc(l + 40))
      );
      --xr-background-color: var(
        --jp-layout-color0,
        var(--pst-color-on-background, #111111)
      );
      --xr-background-color-row-even: var(
        --jp-layout-color1,
        hsl(from var(--pst-color-on-background, #111111) h s calc(l + 5))
      );
      --xr-background-color-row-odd: var(
        --jp-layout-color2,
        hsl(from var(--pst-color-on-background, #111111) h s calc(l + 15))
      );
    }

    .xr-wrap {
      display: block !important;
      min-width: 300px;
      max-width: 700px;
    }

    .xr-text-repr-fallback {
      /* fallback to plain text repr when CSS is not injected (untrusted notebook) */
      display: none;
    }

    .xr-header {
      padding-top: 6px;
      padding-bottom: 6px;
      margin-bottom: 4px;
      border-bottom: solid 1px var(--xr-border-color);
    }

    .xr-header > div,
    .xr-header > ul {
      display: inline;
      margin-top: 0;
      margin-bottom: 0;
    }

    .xr-obj-type,
    .xr-array-name {
      margin-left: 2px;
      margin-right: 10px;
    }

    .xr-obj-type {
      color: var(--xr-font-color2);
    }

    .xr-sections {
      padding-left: 0 !important;
      display: grid;
      grid-template-columns: 150px auto auto 1fr 0 20px 0 20px;
    }

    .xr-section-item {
      display: contents;
    }

    .xr-section-item input {
      display: inline-block;
      opacity: 0;
      height: 0;
    }

    .xr-section-item input + label {
      color: var(--xr-disabled-color);
      border: 2px solid transparent !important;
    }

    .xr-section-item input:enabled + label {
      cursor: pointer;
      color: var(--xr-font-color2);
    }

    .xr-section-item input:focus + label {
      border: 2px solid var(--xr-font-color0) !important;
    }

    .xr-section-item input:enabled + label:hover {
      color: var(--xr-font-color0);
    }

    .xr-section-summary {
      grid-column: 1;
      color: var(--xr-font-color2);
      font-weight: 500;
    }

    .xr-section-summary > span {
      display: inline-block;
      padding-left: 0.5em;
    }

    .xr-section-summary-in:disabled + label {
      color: var(--xr-font-color2);
    }

    .xr-section-summary-in + label:before {
      display: inline-block;
      content: "►";
      font-size: 11px;
      width: 15px;
      text-align: center;
    }

    .xr-section-summary-in:disabled + label:before {
      color: var(--xr-disabled-color);
    }

    .xr-section-summary-in:checked + label:before {
      content: "▼";
    }

    .xr-section-summary-in:checked + label > span {
      display: none;
    }

    .xr-section-summary,
    .xr-section-inline-details {
      padding-top: 4px;
      padding-bottom: 4px;
    }

    .xr-section-inline-details {
      grid-column: 2 / -1;
    }

    .xr-section-details {
      display: none;
      grid-column: 1 / -1;
      margin-bottom: 5px;
    }

    .xr-section-summary-in:checked ~ .xr-section-details {
      display: contents;
    }

    .xr-array-wrap {
      grid-column: 1 / -1;
      display: grid;
      grid-template-columns: 20px auto;
    }

    .xr-array-wrap > label {
      grid-column: 1;
      vertical-align: top;
    }

    .xr-preview {
      color: var(--xr-font-color3);
    }

    .xr-array-preview,
    .xr-array-data {
      padding: 0 5px !important;
      grid-column: 2;
    }

    .xr-array-data,
    .xr-array-in:checked ~ .xr-array-preview {
      display: none;
    }

    .xr-array-in:checked ~ .xr-array-data,
    .xr-array-preview {
      display: inline-block;
    }

    .xr-dim-list {
      display: inline-block !important;
      list-style: none;
      padding: 0 !important;
      margin: 0;
    }

    .xr-dim-list li {
      display: inline-block;
      padding: 0;
      margin: 0;
    }

    .xr-dim-list:before {
      content: "(";
    }

    .xr-dim-list:after {
      content: ")";
    }

    .xr-dim-list li:not(:last-child):after {
      content: ",";
      padding-right: 5px;
    }

    .xr-has-index {
      font-weight: bold;
    }

    .xr-var-list,
    .xr-var-item {
      display: contents;
    }

    .xr-var-item > div,
    .xr-var-item label,
    .xr-var-item > .xr-var-name span {
      background-color: var(--xr-background-color-row-even);
      border-color: var(--xr-background-color-row-odd);
      margin-bottom: 0;
      padding-top: 2px;
    }

    .xr-var-item > .xr-var-name:hover span {
      padding-right: 5px;
    }

    .xr-var-list > li:nth-child(odd) > div,
    .xr-var-list > li:nth-child(odd) > label,
    .xr-var-list > li:nth-child(odd) > .xr-var-name span {
      background-color: var(--xr-background-color-row-odd);
      border-color: var(--xr-background-color-row-even);
    }

    .xr-var-name {
      grid-column: 1;
    }

    .xr-var-dims {
      grid-column: 2;
    }

    .xr-var-dtype {
      grid-column: 3;
      text-align: right;
      color: var(--xr-font-color2);
    }

    .xr-var-preview {
      grid-column: 4;
    }

    .xr-index-preview {
      grid-column: 2 / 5;
      color: var(--xr-font-color2);
    }

    .xr-var-name,
    .xr-var-dims,
    .xr-var-dtype,
    .xr-preview,
    .xr-attrs dt {
      white-space: nowrap;
      overflow: hidden;
      text-overflow: ellipsis;
      padding-right: 10px;
    }

    .xr-var-name:hover,
    .xr-var-dims:hover,
    .xr-var-dtype:hover,
    .xr-attrs dt:hover {
      overflow: visible;
      width: auto;
      z-index: 1;
    }

    .xr-var-attrs,
    .xr-var-data,
    .xr-index-data {
      display: none;
      border-top: 2px dotted var(--xr-background-color);
      padding-bottom: 20px !important;
      padding-top: 10px !important;
    }

    .xr-var-attrs-in + label,
    .xr-var-data-in + label,
    .xr-index-data-in + label {
      padding: 0 1px;
    }

    .xr-var-attrs-in:checked ~ .xr-var-attrs,
    .xr-var-data-in:checked ~ .xr-var-data,
    .xr-index-data-in:checked ~ .xr-index-data {
      display: block;
    }

    .xr-var-data > table {
      float: right;
    }

    .xr-var-data > pre,
    .xr-index-data > pre,
    .xr-var-data > table > tbody > tr {
      background-color: transparent !important;
    }

    .xr-var-name span,
    .xr-var-data,
    .xr-index-name div,
    .xr-index-data,
    .xr-attrs {
      padding-left: 25px !important;
    }

    .xr-attrs,
    .xr-var-attrs,
    .xr-var-data,
    .xr-index-data {
      grid-column: 1 / -1;
    }

    dl.xr-attrs {
      padding: 0;
      margin: 0;
      display: grid;
      grid-template-columns: 125px auto;
    }

    .xr-attrs dt,
    .xr-attrs dd {
      padding: 0;
      margin: 0;
      float: left;
      padding-right: 10px;
      width: auto;
    }

    .xr-attrs dt {
      font-weight: normal;
      grid-column: 1;
    }

    .xr-attrs dt:hover span {
      display: inline-block;
      background: var(--xr-background-color);
      padding-right: 10px;
    }

    .xr-attrs dd {
      grid-column: 2;
      white-space: pre-wrap;
      word-break: break-all;
    }

    .xr-icon-database,
    .xr-icon-file-text2,
    .xr-no-icon {
      display: inline-block;
      vertical-align: middle;
      width: 1em;
      height: 1.5em !important;
      stroke-width: 0;
      stroke: currentColor;
      fill: currentColor;
    }

    .xr-var-attrs-in:checked + label > .xr-icon-file-text2,
    .xr-var-data-in:checked + label > .xr-icon-database,
    .xr-index-data-in:checked + label > .xr-icon-database {
      color: var(--xr-font-color0);
      filter: drop-shadow(1px 1px 5px var(--xr-font-color2));
      stroke-width: 0.8px;
    }
    </style><pre class='xr-text-repr-fallback'>&lt;xarray.Dataset&gt; Size: 1MB
    Dimensions:      (time: 18485, space: 2, keypoints: 6, individuals: 1)
    Coordinates:
      * time         (time) float64 148kB 0.0 0.03333 0.06667 ... 616.1 616.1 616.1
      * space        (space) &lt;U1 8B &#x27;x&#x27; &#x27;y&#x27;
      * keypoints    (keypoints) &lt;U9 216B &#x27;snout&#x27; &#x27;left_ear&#x27; ... &#x27;tail_end&#x27;
      * individuals  (individuals) &lt;U4 16B &#x27;id_0&#x27;
    Data variables:
        position     (time, space, keypoints, individuals) float32 887kB nan ... ...
        confidence   (time, keypoints, individuals) float32 444kB nan nan ... 0.7607
    Attributes:
        source_software:  SLEAP
        ds_type:          poses
        fps:              30.0
        time_unit:        seconds
        source_file:      /home/runner/.movement/data/poses/SLEAP_single-mouse_EP...
        frame_path:       /home/runner/.movement/data/frames/single-mouse_EPM_fra...</pre><div class='xr-wrap' style='display:none'><div class='xr-header'><div class='xr-obj-type'>xarray.Dataset</div></div><ul class='xr-sections'><li class='xr-section-item'><input id='section-0889519c-31a2-49f0-ab1f-cd37611c6094' class='xr-section-summary-in' type='checkbox' disabled ><label for='section-0889519c-31a2-49f0-ab1f-cd37611c6094' class='xr-section-summary'  title='Expand/collapse section'>Dimensions:</label><div class='xr-section-inline-details'><ul class='xr-dim-list'><li><span class='xr-has-index'>time</span>: 18485</li><li><span class='xr-has-index'>space</span>: 2</li><li><span class='xr-has-index'>keypoints</span>: 6</li><li><span class='xr-has-index'>individuals</span>: 1</li></ul></div><div class='xr-section-details'></div></li><li class='xr-section-item'><input id='section-47f7f76a-e47e-4f6a-82f3-9b88f02db261' class='xr-section-summary-in' type='checkbox'  checked><label for='section-47f7f76a-e47e-4f6a-82f3-9b88f02db261' class='xr-section-summary' >Coordinates: <span>(4)</span></label><div class='xr-section-inline-details'></div><div class='xr-section-details'><ul class='xr-var-list'><li class='xr-var-item'><div class='xr-var-name'><span class='xr-has-index'>time</span></div><div class='xr-var-dims'>(time)</div><div class='xr-var-dtype'>float64</div><div class='xr-var-preview xr-preview'>0.0 0.03333 0.06667 ... 616.1 616.1</div><input id='attrs-f7c74ce1-b68b-4084-88c4-bc0b456b09b8' class='xr-var-attrs-in' type='checkbox' disabled><label for='attrs-f7c74ce1-b68b-4084-88c4-bc0b456b09b8' title='Show/Hide attributes'><svg class='icon xr-icon-file-text2'><use xlink:href='#icon-file-text2'></use></svg></label><input id='data-276b30e8-4bef-40ad-bc9e-84da7fd949d2' class='xr-var-data-in' type='checkbox'><label for='data-276b30e8-4bef-40ad-bc9e-84da7fd949d2' title='Show/Hide data repr'><svg class='icon xr-icon-database'><use xlink:href='#icon-database'></use></svg></label><div class='xr-var-attrs'><dl class='xr-attrs'></dl></div><div class='xr-var-data'><pre>array([0.000000e+00, 3.333333e-02, 6.666667e-02, ..., 6.160667e+02,
           6.161000e+02, 6.161333e+02], shape=(18485,))</pre></div></li><li class='xr-var-item'><div class='xr-var-name'><span class='xr-has-index'>space</span></div><div class='xr-var-dims'>(space)</div><div class='xr-var-dtype'>&lt;U1</div><div class='xr-var-preview xr-preview'>&#x27;x&#x27; &#x27;y&#x27;</div><input id='attrs-e00d55e4-7bde-4f84-950c-01da24becfd5' class='xr-var-attrs-in' type='checkbox' disabled><label for='attrs-e00d55e4-7bde-4f84-950c-01da24becfd5' title='Show/Hide attributes'><svg class='icon xr-icon-file-text2'><use xlink:href='#icon-file-text2'></use></svg></label><input id='data-de429f80-8b70-4a90-878e-f979c4d99437' class='xr-var-data-in' type='checkbox'><label for='data-de429f80-8b70-4a90-878e-f979c4d99437' title='Show/Hide data repr'><svg class='icon xr-icon-database'><use xlink:href='#icon-database'></use></svg></label><div class='xr-var-attrs'><dl class='xr-attrs'></dl></div><div class='xr-var-data'><pre>array([&#x27;x&#x27;, &#x27;y&#x27;], dtype=&#x27;&lt;U1&#x27;)</pre></div></li><li class='xr-var-item'><div class='xr-var-name'><span class='xr-has-index'>keypoints</span></div><div class='xr-var-dims'>(keypoints)</div><div class='xr-var-dtype'>&lt;U9</div><div class='xr-var-preview xr-preview'>&#x27;snout&#x27; &#x27;left_ear&#x27; ... &#x27;tail_end&#x27;</div><input id='attrs-a0d7c8a1-a5b9-431f-86b3-3d021dd17605' class='xr-var-attrs-in' type='checkbox' disabled><label for='attrs-a0d7c8a1-a5b9-431f-86b3-3d021dd17605' title='Show/Hide attributes'><svg class='icon xr-icon-file-text2'><use xlink:href='#icon-file-text2'></use></svg></label><input id='data-9192cf1b-31b0-45c3-a26a-594afa678671' class='xr-var-data-in' type='checkbox'><label for='data-9192cf1b-31b0-45c3-a26a-594afa678671' title='Show/Hide data repr'><svg class='icon xr-icon-database'><use xlink:href='#icon-database'></use></svg></label><div class='xr-var-attrs'><dl class='xr-attrs'></dl></div><div class='xr-var-data'><pre>array([&#x27;snout&#x27;, &#x27;left_ear&#x27;, &#x27;right_ear&#x27;, &#x27;centre&#x27;, &#x27;tail_base&#x27;, &#x27;tail_end&#x27;],
          dtype=&#x27;&lt;U9&#x27;)</pre></div></li><li class='xr-var-item'><div class='xr-var-name'><span class='xr-has-index'>individuals</span></div><div class='xr-var-dims'>(individuals)</div><div class='xr-var-dtype'>&lt;U4</div><div class='xr-var-preview xr-preview'>&#x27;id_0&#x27;</div><input id='attrs-5a92100f-4b95-48f2-9305-b36756c5d5c9' class='xr-var-attrs-in' type='checkbox' disabled><label for='attrs-5a92100f-4b95-48f2-9305-b36756c5d5c9' title='Show/Hide attributes'><svg class='icon xr-icon-file-text2'><use xlink:href='#icon-file-text2'></use></svg></label><input id='data-9f3a810c-ace7-412d-835e-757baa5fe32b' class='xr-var-data-in' type='checkbox'><label for='data-9f3a810c-ace7-412d-835e-757baa5fe32b' title='Show/Hide data repr'><svg class='icon xr-icon-database'><use xlink:href='#icon-database'></use></svg></label><div class='xr-var-attrs'><dl class='xr-attrs'></dl></div><div class='xr-var-data'><pre>array([&#x27;id_0&#x27;], dtype=&#x27;&lt;U4&#x27;)</pre></div></li></ul></div></li><li class='xr-section-item'><input id='section-a0b732db-d56f-491b-8e32-43c2063771ea' class='xr-section-summary-in' type='checkbox'  checked><label for='section-a0b732db-d56f-491b-8e32-43c2063771ea' class='xr-section-summary' >Data variables: <span>(2)</span></label><div class='xr-section-inline-details'></div><div class='xr-section-details'><ul class='xr-var-list'><li class='xr-var-item'><div class='xr-var-name'><span>position</span></div><div class='xr-var-dims'>(time, space, keypoints, individuals)</div><div class='xr-var-dtype'>float32</div><div class='xr-var-preview xr-preview'>nan nan nan ... 440.0 384.0 476.3</div><input id='attrs-fb00e671-5748-4cf3-ae4b-2ba08ec20aa1' class='xr-var-attrs-in' type='checkbox' ><label for='attrs-fb00e671-5748-4cf3-ae4b-2ba08ec20aa1' title='Show/Hide attributes'><svg class='icon xr-icon-file-text2'><use xlink:href='#icon-file-text2'></use></svg></label><input id='data-5998ba5b-8d15-465e-9c62-714ab6fdae9b' class='xr-var-data-in' type='checkbox'><label for='data-5998ba5b-8d15-465e-9c62-714ab6fdae9b' title='Show/Hide data repr'><svg class='icon xr-icon-database'><use xlink:href='#icon-database'></use></svg></label><div class='xr-var-attrs'><dl class='xr-attrs'><dt><span>log :</span></dt><dd>[
      {
        &quot;operation&quot;: &quot;rolling_filter&quot;,
        &quot;datetime&quot;: &quot;2025-07-22 16:47:39.695466&quot;,
        &quot;window&quot;: &quot;3&quot;,
        &quot;statistic&quot;: &quot;&#x27;median&#x27;&quot;,
        &quot;min_periods&quot;: &quot;2&quot;,
        &quot;print_report&quot;: &quot;True&quot;
      }
    ]</dd></dl></div><div class='xr-var-data'><pre>array([[[[      nan],
             [      nan],
             [      nan],
             [      nan],
             [      nan],
             [      nan]],

            [[      nan],
             [      nan],
             [      nan],
             [      nan],
             [      nan],
             [      nan]]],


           [[[      nan],
             [      nan],
             [      nan],
             [      nan],
             [      nan],
    ...
             [484.86316],
             [492.0457 ],
             [439.9774 ],
             [384.10602],
             [476.33466]]],


           [[[688.18134],
             [692.3218 ],
             [668.4878 ],
             [667.9094 ],
             [636.8362 ],
             [588.56854]],

            [[507.72455],
             [484.5658 ],
             [492.0457 ],
             [439.9774 ],
             [384.02936],
             [476.33466]]]], shape=(18485, 2, 6, 1), dtype=float32)</pre></div></li><li class='xr-var-item'><div class='xr-var-name'><span>confidence</span></div><div class='xr-var-dims'>(time, keypoints, individuals)</div><div class='xr-var-dtype'>float32</div><div class='xr-var-preview xr-preview'>nan nan nan ... 0.9336 0.7607</div><input id='attrs-b22ab71e-a5bf-45b9-97bc-5e0af8f80e14' class='xr-var-attrs-in' type='checkbox' disabled><label for='attrs-b22ab71e-a5bf-45b9-97bc-5e0af8f80e14' title='Show/Hide attributes'><svg class='icon xr-icon-file-text2'><use xlink:href='#icon-file-text2'></use></svg></label><input id='data-6da36da7-7f99-4e48-9d9a-b4d2f58f6756' class='xr-var-data-in' type='checkbox'><label for='data-6da36da7-7f99-4e48-9d9a-b4d2f58f6756' title='Show/Hide data repr'><svg class='icon xr-icon-database'><use xlink:href='#icon-database'></use></svg></label><div class='xr-var-attrs'><dl class='xr-attrs'></dl></div><div class='xr-var-data'><pre>array([[[       nan],
            [       nan],
            [       nan],
            [       nan],
            [       nan],
            [       nan]],

           [[       nan],
            [       nan],
            [       nan],
            [       nan],
            [       nan],
            [       nan]],

           [[       nan],
            [       nan],
            [       nan],
            [       nan],
            [       nan],
            [       nan]],
    ...
           [[0.9317396 ],
            [1.0026728 ],
            [1.025079  ],
            [0.92725545],
            [0.95202184],
            [0.7779419 ]],

           [[0.9193515 ],
            [1.0136327 ],
            [1.0336665 ],
            [0.93108493],
            [0.94561106],
            [0.7662804 ]],

           [[0.93820494],
            [1.0224991 ],
            [1.0452943 ],
            [0.9363993 ],
            [0.9335798 ],
            [0.76068705]]], shape=(18485, 6, 1), dtype=float32)</pre></div></li></ul></div></li><li class='xr-section-item'><input id='section-d7414bf7-dd3c-4942-a5cb-17abe1d7106a' class='xr-section-summary-in' type='checkbox'  ><label for='section-d7414bf7-dd3c-4942-a5cb-17abe1d7106a' class='xr-section-summary' >Indexes: <span>(4)</span></label><div class='xr-section-inline-details'></div><div class='xr-section-details'><ul class='xr-var-list'><li class='xr-var-item'><div class='xr-index-name'><div>time</div></div><div class='xr-index-preview'>PandasIndex</div><input type='checkbox' disabled/><label></label><input id='index-a70be23a-2f0d-46bc-9b9d-6f8f17020a44' class='xr-index-data-in' type='checkbox'/><label for='index-a70be23a-2f0d-46bc-9b9d-6f8f17020a44' title='Show/Hide index repr'><svg class='icon xr-icon-database'><use xlink:href='#icon-database'></use></svg></label><div class='xr-index-data'><pre>PandasIndex(Index([                0.0, 0.03333333333333333, 0.06666666666666667,
                           0.1, 0.13333333333333333, 0.16666666666666666,
                           0.2, 0.23333333333333334, 0.26666666666666666,
                           0.3,
           ...
             615.8333333333334,   615.8666666666667,               615.9,
             615.9333333333333,   615.9666666666667,               616.0,
             616.0333333333333,   616.0666666666667,               616.1,
             616.1333333333333],
          dtype=&#x27;float64&#x27;, name=&#x27;time&#x27;, length=18485))</pre></div></li><li class='xr-var-item'><div class='xr-index-name'><div>space</div></div><div class='xr-index-preview'>PandasIndex</div><input type='checkbox' disabled/><label></label><input id='index-3af70e33-e895-40d2-8452-480245d14fe6' class='xr-index-data-in' type='checkbox'/><label for='index-3af70e33-e895-40d2-8452-480245d14fe6' title='Show/Hide index repr'><svg class='icon xr-icon-database'><use xlink:href='#icon-database'></use></svg></label><div class='xr-index-data'><pre>PandasIndex(Index([&#x27;x&#x27;, &#x27;y&#x27;], dtype=&#x27;object&#x27;, name=&#x27;space&#x27;))</pre></div></li><li class='xr-var-item'><div class='xr-index-name'><div>keypoints</div></div><div class='xr-index-preview'>PandasIndex</div><input type='checkbox' disabled/><label></label><input id='index-2dd48c41-2f12-423e-b558-5b28d19146b4' class='xr-index-data-in' type='checkbox'/><label for='index-2dd48c41-2f12-423e-b558-5b28d19146b4' title='Show/Hide index repr'><svg class='icon xr-icon-database'><use xlink:href='#icon-database'></use></svg></label><div class='xr-index-data'><pre>PandasIndex(Index([&#x27;snout&#x27;, &#x27;left_ear&#x27;, &#x27;right_ear&#x27;, &#x27;centre&#x27;, &#x27;tail_base&#x27;, &#x27;tail_end&#x27;], dtype=&#x27;object&#x27;, name=&#x27;keypoints&#x27;))</pre></div></li><li class='xr-var-item'><div class='xr-index-name'><div>individuals</div></div><div class='xr-index-preview'>PandasIndex</div><input type='checkbox' disabled/><label></label><input id='index-d7ce043a-ae41-4bad-b5e9-e81fdfc85051' class='xr-index-data-in' type='checkbox'/><label for='index-d7ce043a-ae41-4bad-b5e9-e81fdfc85051' title='Show/Hide index repr'><svg class='icon xr-icon-database'><use xlink:href='#icon-database'></use></svg></label><div class='xr-index-data'><pre>PandasIndex(Index([&#x27;id_0&#x27;], dtype=&#x27;object&#x27;, name=&#x27;individuals&#x27;))</pre></div></li></ul></div></li><li class='xr-section-item'><input id='section-b4dbfff5-0c87-4da2-9584-800aa5aaf541' class='xr-section-summary-in' type='checkbox'  checked><label for='section-b4dbfff5-0c87-4da2-9584-800aa5aaf541' class='xr-section-summary' >Attributes: <span>(6)</span></label><div class='xr-section-inline-details'></div><div class='xr-section-details'><dl class='xr-attrs'><dt><span>source_software :</span></dt><dd>SLEAP</dd><dt><span>ds_type :</span></dt><dd>poses</dd><dt><span>fps :</span></dt><dd>30.0</dd><dt><span>time_unit :</span></dt><dd>seconds</dd><dt><span>source_file :</span></dt><dd>/home/runner/.movement/data/poses/SLEAP_single-mouse_EPM.analysis.h5</dd><dt><span>frame_path :</span></dt><dd>/home/runner/.movement/data/frames/single-mouse_EPM_frame-20sec.png</dd></dl></div></li></ul></div></div>
    </div>
    <br />
    <br />

.. GENERATED FROM PYTHON SOURCE LINES 219-225

We see that this time the number of NaN values has decreased
across all keypoints.
Let's visualise the effects of the rolling median filter in the time and
frequency domains. Here we focus on the first 80 seconds for the ``snout``
keypoint. You can adjust the ``keypoint`` and ``time_range`` arguments to
explore other parts of the data.

.. GENERATED FROM PYTHON SOURCE LINES 225-230

.. code-block:: Python


    plot_raw_and_smooth_timeseries_and_psd(
        ds_mouse, ds_mouse_smooth, keypoint="snout", time_range=slice(0, 80)
    )




.. image-sg:: /examples/images/sphx_glr_smooth_002.png
   :alt: Time Domain, Frequency Domain
   :srcset: /examples/images/sphx_glr_smooth_002.png
   :class: sphx-glr-single-img





.. GENERATED FROM PYTHON SOURCE LINES 231-235

The smoothing once again reduces the power of high-frequency components, but
the resulting time series stays quite close to the raw data.

What happens if we increase the ``window`` to 2 seconds (60 frames)?

.. GENERATED FROM PYTHON SOURCE LINES 235-249

.. code-block:: Python


    window = int(2 * ds_mouse.fps)
    ds_mouse_smooth.update(
        {
            "position": rolling_filter(
                ds_mouse.position,
                window,
                min_periods=2,
                statistic="median",
                print_report=True,
            )
        }
    )





.. rst-class:: sphx-glr-script-out

 .. code-block:: none

    Missing points (marked as NaN) in input:

    keypoints                  snout           left_ear          right_ear             centre          tail_base            tail_end
    individuals                                                                                                                     
    id_0         4494/18485 (24.31%)  513/18485 (2.78%)  533/18485 (2.88%)  490/18485 (2.65%)  704/18485 (3.81%)  2496/18485 (13.5%)
    Missing points (marked as NaN) in output:

    keypoints               snout          left_ear         right_ear            centre         tail_base           tail_end
    individuals                                                                                                             
    id_0         795/18485 (4.3%)  80/18485 (0.43%)  80/18485 (0.43%)  80/18485 (0.43%)  80/18485 (0.43%)  239/18485 (1.29%)


.. raw:: html

    <div class="output_subarea output_html rendered_html output_result">
    <div><svg style="position: absolute; width: 0; height: 0; overflow: hidden">
    <defs>
    <symbol id="icon-database" viewBox="0 0 32 32">
    <path d="M16 0c-8.837 0-16 2.239-16 5v4c0 2.761 7.163 5 16 5s16-2.239 16-5v-4c0-2.761-7.163-5-16-5z"></path>
    <path d="M16 17c-8.837 0-16-2.239-16-5v6c0 2.761 7.163 5 16 5s16-2.239 16-5v-6c0 2.761-7.163 5-16 5z"></path>
    <path d="M16 26c-8.837 0-16-2.239-16-5v6c0 2.761 7.163 5 16 5s16-2.239 16-5v-6c0 2.761-7.163 5-16 5z"></path>
    </symbol>
    <symbol id="icon-file-text2" viewBox="0 0 32 32">
    <path d="M28.681 7.159c-0.694-0.947-1.662-2.053-2.724-3.116s-2.169-2.030-3.116-2.724c-1.612-1.182-2.393-1.319-2.841-1.319h-15.5c-1.378 0-2.5 1.121-2.5 2.5v27c0 1.378 1.122 2.5 2.5 2.5h23c1.378 0 2.5-1.122 2.5-2.5v-19.5c0-0.448-0.137-1.23-1.319-2.841zM24.543 5.457c0.959 0.959 1.712 1.825 2.268 2.543h-4.811v-4.811c0.718 0.556 1.584 1.309 2.543 2.268zM28 29.5c0 0.271-0.229 0.5-0.5 0.5h-23c-0.271 0-0.5-0.229-0.5-0.5v-27c0-0.271 0.229-0.5 0.5-0.5 0 0 15.499-0 15.5 0v7c0 0.552 0.448 1 1 1h7v19.5z"></path>
    <path d="M23 26h-14c-0.552 0-1-0.448-1-1s0.448-1 1-1h14c0.552 0 1 0.448 1 1s-0.448 1-1 1z"></path>
    <path d="M23 22h-14c-0.552 0-1-0.448-1-1s0.448-1 1-1h14c0.552 0 1 0.448 1 1s-0.448 1-1 1z"></path>
    <path d="M23 18h-14c-0.552 0-1-0.448-1-1s0.448-1 1-1h14c0.552 0 1 0.448 1 1s-0.448 1-1 1z"></path>
    </symbol>
    </defs>
    </svg>
    <style>/* CSS stylesheet for displaying xarray objects in jupyterlab.
     *
     */

    :root {
      --xr-font-color0: var(
        --jp-content-font-color0,
        var(--pst-color-text-base rgba(0, 0, 0, 1))
      );
      --xr-font-color2: var(
        --jp-content-font-color2,
        var(--pst-color-text-base, rgba(0, 0, 0, 0.54))
      );
      --xr-font-color3: var(
        --jp-content-font-color3,
        var(--pst-color-text-base, rgba(0, 0, 0, 0.38))
      );
      --xr-border-color: var(
        --jp-border-color2,
        hsl(from var(--pst-color-on-background, white) h s calc(l - 10))
      );
      --xr-disabled-color: var(
        --jp-layout-color3,
        hsl(from var(--pst-color-on-background, white) h s calc(l - 40))
      );
      --xr-background-color: var(
        --jp-layout-color0,
        var(--pst-color-on-background, white)
      );
      --xr-background-color-row-even: var(
        --jp-layout-color1,
        hsl(from var(--pst-color-on-background, white) h s calc(l - 5))
      );
      --xr-background-color-row-odd: var(
        --jp-layout-color2,
        hsl(from var(--pst-color-on-background, white) h s calc(l - 15))
      );
    }

    html[theme="dark"],
    html[data-theme="dark"],
    body[data-theme="dark"],
    body.vscode-dark {
      --xr-font-color0: var(
        --jp-content-font-color0,
        var(--pst-color-text-base, rgba(255, 255, 255, 1))
      );
      --xr-font-color2: var(
        --jp-content-font-color2,
        var(--pst-color-text-base, rgba(255, 255, 255, 0.54))
      );
      --xr-font-color3: var(
        --jp-content-font-color3,
        var(--pst-color-text-base, rgba(255, 255, 255, 0.38))
      );
      --xr-border-color: var(
        --jp-border-color2,
        hsl(from var(--pst-color-on-background, #111111) h s calc(l + 10))
      );
      --xr-disabled-color: var(
        --jp-layout-color3,
        hsl(from var(--pst-color-on-background, #111111) h s calc(l + 40))
      );
      --xr-background-color: var(
        --jp-layout-color0,
        var(--pst-color-on-background, #111111)
      );
      --xr-background-color-row-even: var(
        --jp-layout-color1,
        hsl(from var(--pst-color-on-background, #111111) h s calc(l + 5))
      );
      --xr-background-color-row-odd: var(
        --jp-layout-color2,
        hsl(from var(--pst-color-on-background, #111111) h s calc(l + 15))
      );
    }

    .xr-wrap {
      display: block !important;
      min-width: 300px;
      max-width: 700px;
    }

    .xr-text-repr-fallback {
      /* fallback to plain text repr when CSS is not injected (untrusted notebook) */
      display: none;
    }

    .xr-header {
      padding-top: 6px;
      padding-bottom: 6px;
      margin-bottom: 4px;
      border-bottom: solid 1px var(--xr-border-color);
    }

    .xr-header > div,
    .xr-header > ul {
      display: inline;
      margin-top: 0;
      margin-bottom: 0;
    }

    .xr-obj-type,
    .xr-array-name {
      margin-left: 2px;
      margin-right: 10px;
    }

    .xr-obj-type {
      color: var(--xr-font-color2);
    }

    .xr-sections {
      padding-left: 0 !important;
      display: grid;
      grid-template-columns: 150px auto auto 1fr 0 20px 0 20px;
    }

    .xr-section-item {
      display: contents;
    }

    .xr-section-item input {
      display: inline-block;
      opacity: 0;
      height: 0;
    }

    .xr-section-item input + label {
      color: var(--xr-disabled-color);
      border: 2px solid transparent !important;
    }

    .xr-section-item input:enabled + label {
      cursor: pointer;
      color: var(--xr-font-color2);
    }

    .xr-section-item input:focus + label {
      border: 2px solid var(--xr-font-color0) !important;
    }

    .xr-section-item input:enabled + label:hover {
      color: var(--xr-font-color0);
    }

    .xr-section-summary {
      grid-column: 1;
      color: var(--xr-font-color2);
      font-weight: 500;
    }

    .xr-section-summary > span {
      display: inline-block;
      padding-left: 0.5em;
    }

    .xr-section-summary-in:disabled + label {
      color: var(--xr-font-color2);
    }

    .xr-section-summary-in + label:before {
      display: inline-block;
      content: "►";
      font-size: 11px;
      width: 15px;
      text-align: center;
    }

    .xr-section-summary-in:disabled + label:before {
      color: var(--xr-disabled-color);
    }

    .xr-section-summary-in:checked + label:before {
      content: "▼";
    }

    .xr-section-summary-in:checked + label > span {
      display: none;
    }

    .xr-section-summary,
    .xr-section-inline-details {
      padding-top: 4px;
      padding-bottom: 4px;
    }

    .xr-section-inline-details {
      grid-column: 2 / -1;
    }

    .xr-section-details {
      display: none;
      grid-column: 1 / -1;
      margin-bottom: 5px;
    }

    .xr-section-summary-in:checked ~ .xr-section-details {
      display: contents;
    }

    .xr-array-wrap {
      grid-column: 1 / -1;
      display: grid;
      grid-template-columns: 20px auto;
    }

    .xr-array-wrap > label {
      grid-column: 1;
      vertical-align: top;
    }

    .xr-preview {
      color: var(--xr-font-color3);
    }

    .xr-array-preview,
    .xr-array-data {
      padding: 0 5px !important;
      grid-column: 2;
    }

    .xr-array-data,
    .xr-array-in:checked ~ .xr-array-preview {
      display: none;
    }

    .xr-array-in:checked ~ .xr-array-data,
    .xr-array-preview {
      display: inline-block;
    }

    .xr-dim-list {
      display: inline-block !important;
      list-style: none;
      padding: 0 !important;
      margin: 0;
    }

    .xr-dim-list li {
      display: inline-block;
      padding: 0;
      margin: 0;
    }

    .xr-dim-list:before {
      content: "(";
    }

    .xr-dim-list:after {
      content: ")";
    }

    .xr-dim-list li:not(:last-child):after {
      content: ",";
      padding-right: 5px;
    }

    .xr-has-index {
      font-weight: bold;
    }

    .xr-var-list,
    .xr-var-item {
      display: contents;
    }

    .xr-var-item > div,
    .xr-var-item label,
    .xr-var-item > .xr-var-name span {
      background-color: var(--xr-background-color-row-even);
      border-color: var(--xr-background-color-row-odd);
      margin-bottom: 0;
      padding-top: 2px;
    }

    .xr-var-item > .xr-var-name:hover span {
      padding-right: 5px;
    }

    .xr-var-list > li:nth-child(odd) > div,
    .xr-var-list > li:nth-child(odd) > label,
    .xr-var-list > li:nth-child(odd) > .xr-var-name span {
      background-color: var(--xr-background-color-row-odd);
      border-color: var(--xr-background-color-row-even);
    }

    .xr-var-name {
      grid-column: 1;
    }

    .xr-var-dims {
      grid-column: 2;
    }

    .xr-var-dtype {
      grid-column: 3;
      text-align: right;
      color: var(--xr-font-color2);
    }

    .xr-var-preview {
      grid-column: 4;
    }

    .xr-index-preview {
      grid-column: 2 / 5;
      color: var(--xr-font-color2);
    }

    .xr-var-name,
    .xr-var-dims,
    .xr-var-dtype,
    .xr-preview,
    .xr-attrs dt {
      white-space: nowrap;
      overflow: hidden;
      text-overflow: ellipsis;
      padding-right: 10px;
    }

    .xr-var-name:hover,
    .xr-var-dims:hover,
    .xr-var-dtype:hover,
    .xr-attrs dt:hover {
      overflow: visible;
      width: auto;
      z-index: 1;
    }

    .xr-var-attrs,
    .xr-var-data,
    .xr-index-data {
      display: none;
      border-top: 2px dotted var(--xr-background-color);
      padding-bottom: 20px !important;
      padding-top: 10px !important;
    }

    .xr-var-attrs-in + label,
    .xr-var-data-in + label,
    .xr-index-data-in + label {
      padding: 0 1px;
    }

    .xr-var-attrs-in:checked ~ .xr-var-attrs,
    .xr-var-data-in:checked ~ .xr-var-data,
    .xr-index-data-in:checked ~ .xr-index-data {
      display: block;
    }

    .xr-var-data > table {
      float: right;
    }

    .xr-var-data > pre,
    .xr-index-data > pre,
    .xr-var-data > table > tbody > tr {
      background-color: transparent !important;
    }

    .xr-var-name span,
    .xr-var-data,
    .xr-index-name div,
    .xr-index-data,
    .xr-attrs {
      padding-left: 25px !important;
    }

    .xr-attrs,
    .xr-var-attrs,
    .xr-var-data,
    .xr-index-data {
      grid-column: 1 / -1;
    }

    dl.xr-attrs {
      padding: 0;
      margin: 0;
      display: grid;
      grid-template-columns: 125px auto;
    }

    .xr-attrs dt,
    .xr-attrs dd {
      padding: 0;
      margin: 0;
      float: left;
      padding-right: 10px;
      width: auto;
    }

    .xr-attrs dt {
      font-weight: normal;
      grid-column: 1;
    }

    .xr-attrs dt:hover span {
      display: inline-block;
      background: var(--xr-background-color);
      padding-right: 10px;
    }

    .xr-attrs dd {
      grid-column: 2;
      white-space: pre-wrap;
      word-break: break-all;
    }

    .xr-icon-database,
    .xr-icon-file-text2,
    .xr-no-icon {
      display: inline-block;
      vertical-align: middle;
      width: 1em;
      height: 1.5em !important;
      stroke-width: 0;
      stroke: currentColor;
      fill: currentColor;
    }

    .xr-var-attrs-in:checked + label > .xr-icon-file-text2,
    .xr-var-data-in:checked + label > .xr-icon-database,
    .xr-index-data-in:checked + label > .xr-icon-database {
      color: var(--xr-font-color0);
      filter: drop-shadow(1px 1px 5px var(--xr-font-color2));
      stroke-width: 0.8px;
    }
    </style><pre class='xr-text-repr-fallback'>&lt;xarray.Dataset&gt; Size: 1MB
    Dimensions:      (time: 18485, space: 2, keypoints: 6, individuals: 1)
    Coordinates:
      * time         (time) float64 148kB 0.0 0.03333 0.06667 ... 616.1 616.1 616.1
      * space        (space) &lt;U1 8B &#x27;x&#x27; &#x27;y&#x27;
      * keypoints    (keypoints) &lt;U9 216B &#x27;snout&#x27; &#x27;left_ear&#x27; ... &#x27;tail_end&#x27;
      * individuals  (individuals) &lt;U4 16B &#x27;id_0&#x27;
    Data variables:
        position     (time, space, keypoints, individuals) float32 887kB nan ... ...
        confidence   (time, keypoints, individuals) float32 444kB nan nan ... 0.7607
    Attributes:
        source_software:  SLEAP
        ds_type:          poses
        fps:              30.0
        time_unit:        seconds
        source_file:      /home/runner/.movement/data/poses/SLEAP_single-mouse_EP...
        frame_path:       /home/runner/.movement/data/frames/single-mouse_EPM_fra...</pre><div class='xr-wrap' style='display:none'><div class='xr-header'><div class='xr-obj-type'>xarray.Dataset</div></div><ul class='xr-sections'><li class='xr-section-item'><input id='section-53ba7f82-08fb-4c81-875e-eaf6d46d1061' class='xr-section-summary-in' type='checkbox' disabled ><label for='section-53ba7f82-08fb-4c81-875e-eaf6d46d1061' class='xr-section-summary'  title='Expand/collapse section'>Dimensions:</label><div class='xr-section-inline-details'><ul class='xr-dim-list'><li><span class='xr-has-index'>time</span>: 18485</li><li><span class='xr-has-index'>space</span>: 2</li><li><span class='xr-has-index'>keypoints</span>: 6</li><li><span class='xr-has-index'>individuals</span>: 1</li></ul></div><div class='xr-section-details'></div></li><li class='xr-section-item'><input id='section-b2eb74d8-f101-47a7-80df-3221d324adb7' class='xr-section-summary-in' type='checkbox'  checked><label for='section-b2eb74d8-f101-47a7-80df-3221d324adb7' class='xr-section-summary' >Coordinates: <span>(4)</span></label><div class='xr-section-inline-details'></div><div class='xr-section-details'><ul class='xr-var-list'><li class='xr-var-item'><div class='xr-var-name'><span class='xr-has-index'>time</span></div><div class='xr-var-dims'>(time)</div><div class='xr-var-dtype'>float64</div><div class='xr-var-preview xr-preview'>0.0 0.03333 0.06667 ... 616.1 616.1</div><input id='attrs-a75255c2-7230-41fd-93a2-ffc1fc74eca7' class='xr-var-attrs-in' type='checkbox' disabled><label for='attrs-a75255c2-7230-41fd-93a2-ffc1fc74eca7' title='Show/Hide attributes'><svg class='icon xr-icon-file-text2'><use xlink:href='#icon-file-text2'></use></svg></label><input id='data-af83a535-17d4-4060-992c-a33a49b47841' class='xr-var-data-in' type='checkbox'><label for='data-af83a535-17d4-4060-992c-a33a49b47841' title='Show/Hide data repr'><svg class='icon xr-icon-database'><use xlink:href='#icon-database'></use></svg></label><div class='xr-var-attrs'><dl class='xr-attrs'></dl></div><div class='xr-var-data'><pre>array([0.000000e+00, 3.333333e-02, 6.666667e-02, ..., 6.160667e+02,
           6.161000e+02, 6.161333e+02], shape=(18485,))</pre></div></li><li class='xr-var-item'><div class='xr-var-name'><span class='xr-has-index'>space</span></div><div class='xr-var-dims'>(space)</div><div class='xr-var-dtype'>&lt;U1</div><div class='xr-var-preview xr-preview'>&#x27;x&#x27; &#x27;y&#x27;</div><input id='attrs-bb01456a-b339-4fc1-bb5d-a996adf4626c' class='xr-var-attrs-in' type='checkbox' disabled><label for='attrs-bb01456a-b339-4fc1-bb5d-a996adf4626c' title='Show/Hide attributes'><svg class='icon xr-icon-file-text2'><use xlink:href='#icon-file-text2'></use></svg></label><input id='data-df4413d2-8878-4b85-b4cc-a0f29b6e0e1f' class='xr-var-data-in' type='checkbox'><label for='data-df4413d2-8878-4b85-b4cc-a0f29b6e0e1f' title='Show/Hide data repr'><svg class='icon xr-icon-database'><use xlink:href='#icon-database'></use></svg></label><div class='xr-var-attrs'><dl class='xr-attrs'></dl></div><div class='xr-var-data'><pre>array([&#x27;x&#x27;, &#x27;y&#x27;], dtype=&#x27;&lt;U1&#x27;)</pre></div></li><li class='xr-var-item'><div class='xr-var-name'><span class='xr-has-index'>keypoints</span></div><div class='xr-var-dims'>(keypoints)</div><div class='xr-var-dtype'>&lt;U9</div><div class='xr-var-preview xr-preview'>&#x27;snout&#x27; &#x27;left_ear&#x27; ... &#x27;tail_end&#x27;</div><input id='attrs-acf22cd1-7774-4b5a-9bf5-1052d9012bb0' class='xr-var-attrs-in' type='checkbox' disabled><label for='attrs-acf22cd1-7774-4b5a-9bf5-1052d9012bb0' title='Show/Hide attributes'><svg class='icon xr-icon-file-text2'><use xlink:href='#icon-file-text2'></use></svg></label><input id='data-c43209ea-5eaa-4fad-a0d2-7ada58dbe940' class='xr-var-data-in' type='checkbox'><label for='data-c43209ea-5eaa-4fad-a0d2-7ada58dbe940' title='Show/Hide data repr'><svg class='icon xr-icon-database'><use xlink:href='#icon-database'></use></svg></label><div class='xr-var-attrs'><dl class='xr-attrs'></dl></div><div class='xr-var-data'><pre>array([&#x27;snout&#x27;, &#x27;left_ear&#x27;, &#x27;right_ear&#x27;, &#x27;centre&#x27;, &#x27;tail_base&#x27;, &#x27;tail_end&#x27;],
          dtype=&#x27;&lt;U9&#x27;)</pre></div></li><li class='xr-var-item'><div class='xr-var-name'><span class='xr-has-index'>individuals</span></div><div class='xr-var-dims'>(individuals)</div><div class='xr-var-dtype'>&lt;U4</div><div class='xr-var-preview xr-preview'>&#x27;id_0&#x27;</div><input id='attrs-4682d095-a309-4048-914b-6a7d90beaa6c' class='xr-var-attrs-in' type='checkbox' disabled><label for='attrs-4682d095-a309-4048-914b-6a7d90beaa6c' title='Show/Hide attributes'><svg class='icon xr-icon-file-text2'><use xlink:href='#icon-file-text2'></use></svg></label><input id='data-69f66c61-33ff-4c97-af01-b5642a45daff' class='xr-var-data-in' type='checkbox'><label for='data-69f66c61-33ff-4c97-af01-b5642a45daff' title='Show/Hide data repr'><svg class='icon xr-icon-database'><use xlink:href='#icon-database'></use></svg></label><div class='xr-var-attrs'><dl class='xr-attrs'></dl></div><div class='xr-var-data'><pre>array([&#x27;id_0&#x27;], dtype=&#x27;&lt;U4&#x27;)</pre></div></li></ul></div></li><li class='xr-section-item'><input id='section-3bfd1a55-5fc4-4e1d-bd5c-3575332e40be' class='xr-section-summary-in' type='checkbox'  checked><label for='section-3bfd1a55-5fc4-4e1d-bd5c-3575332e40be' class='xr-section-summary' >Data variables: <span>(2)</span></label><div class='xr-section-inline-details'></div><div class='xr-section-details'><ul class='xr-var-list'><li class='xr-var-item'><div class='xr-var-name'><span>position</span></div><div class='xr-var-dims'>(time, space, keypoints, individuals)</div><div class='xr-var-dtype'>float32</div><div class='xr-var-preview xr-preview'>nan nan nan ... 428.4 380.2 476.2</div><input id='attrs-26bfd2bf-4700-45fc-887e-695eaf8fe310' class='xr-var-attrs-in' type='checkbox' ><label for='attrs-26bfd2bf-4700-45fc-887e-695eaf8fe310' title='Show/Hide attributes'><svg class='icon xr-icon-file-text2'><use xlink:href='#icon-file-text2'></use></svg></label><input id='data-63cbeb6d-dd30-48f3-bbbc-207ab2fa584a' class='xr-var-data-in' type='checkbox'><label for='data-63cbeb6d-dd30-48f3-bbbc-207ab2fa584a' title='Show/Hide data repr'><svg class='icon xr-icon-database'><use xlink:href='#icon-database'></use></svg></label><div class='xr-var-attrs'><dl class='xr-attrs'><dt><span>log :</span></dt><dd>[
      {
        &quot;operation&quot;: &quot;rolling_filter&quot;,
        &quot;datetime&quot;: &quot;2025-07-22 16:47:39.958071&quot;,
        &quot;window&quot;: &quot;60&quot;,
        &quot;statistic&quot;: &quot;&#x27;median&#x27;&quot;,
        &quot;min_periods&quot;: &quot;2&quot;,
        &quot;print_report&quot;: &quot;True&quot;
      }
    ]</dd></dl></div><div class='xr-var-data'><pre>array([[[[      nan],
             [      nan],
             [      nan],
             [      nan],
             [      nan],
             [      nan]],

            [[      nan],
             [      nan],
             [      nan],
             [      nan],
             [      nan],
             [      nan]]],


           [[[      nan],
             [      nan],
             [      nan],
             [      nan],
             [      nan],
    ...
             [476.5145 ],
             [478.4414 ],
             [428.46777],
             [380.2395 ],
             [476.2374 ]]],


           [[[684.67834],
             [688.80676],
             [667.78625],
             [668.1798 ],
             [635.94543],
             [588.9046 ]],

            [[493.02063],
             [476.48022],
             [477.0539 ],
             [428.44302],
             [380.2395 ],
             [476.2374 ]]]], shape=(18485, 2, 6, 1), dtype=float32)</pre></div></li><li class='xr-var-item'><div class='xr-var-name'><span>confidence</span></div><div class='xr-var-dims'>(time, keypoints, individuals)</div><div class='xr-var-dtype'>float32</div><div class='xr-var-preview xr-preview'>nan nan nan ... 0.9336 0.7607</div><input id='attrs-70ac5439-3860-467a-9536-94c2214bd462' class='xr-var-attrs-in' type='checkbox' disabled><label for='attrs-70ac5439-3860-467a-9536-94c2214bd462' title='Show/Hide attributes'><svg class='icon xr-icon-file-text2'><use xlink:href='#icon-file-text2'></use></svg></label><input id='data-73a4c0f9-3346-48bc-b211-b85a9ea8746a' class='xr-var-data-in' type='checkbox'><label for='data-73a4c0f9-3346-48bc-b211-b85a9ea8746a' title='Show/Hide data repr'><svg class='icon xr-icon-database'><use xlink:href='#icon-database'></use></svg></label><div class='xr-var-attrs'><dl class='xr-attrs'></dl></div><div class='xr-var-data'><pre>array([[[       nan],
            [       nan],
            [       nan],
            [       nan],
            [       nan],
            [       nan]],

           [[       nan],
            [       nan],
            [       nan],
            [       nan],
            [       nan],
            [       nan]],

           [[       nan],
            [       nan],
            [       nan],
            [       nan],
            [       nan],
            [       nan]],
    ...
           [[0.9317396 ],
            [1.0026728 ],
            [1.025079  ],
            [0.92725545],
            [0.95202184],
            [0.7779419 ]],

           [[0.9193515 ],
            [1.0136327 ],
            [1.0336665 ],
            [0.93108493],
            [0.94561106],
            [0.7662804 ]],

           [[0.93820494],
            [1.0224991 ],
            [1.0452943 ],
            [0.9363993 ],
            [0.9335798 ],
            [0.76068705]]], shape=(18485, 6, 1), dtype=float32)</pre></div></li></ul></div></li><li class='xr-section-item'><input id='section-0527ae38-b01d-4a8c-87e1-845ea1ef334d' class='xr-section-summary-in' type='checkbox'  ><label for='section-0527ae38-b01d-4a8c-87e1-845ea1ef334d' class='xr-section-summary' >Indexes: <span>(4)</span></label><div class='xr-section-inline-details'></div><div class='xr-section-details'><ul class='xr-var-list'><li class='xr-var-item'><div class='xr-index-name'><div>time</div></div><div class='xr-index-preview'>PandasIndex</div><input type='checkbox' disabled/><label></label><input id='index-d759e6b0-7cf0-4455-aed4-ea5c652ee159' class='xr-index-data-in' type='checkbox'/><label for='index-d759e6b0-7cf0-4455-aed4-ea5c652ee159' title='Show/Hide index repr'><svg class='icon xr-icon-database'><use xlink:href='#icon-database'></use></svg></label><div class='xr-index-data'><pre>PandasIndex(Index([                0.0, 0.03333333333333333, 0.06666666666666667,
                           0.1, 0.13333333333333333, 0.16666666666666666,
                           0.2, 0.23333333333333334, 0.26666666666666666,
                           0.3,
           ...
             615.8333333333334,   615.8666666666667,               615.9,
             615.9333333333333,   615.9666666666667,               616.0,
             616.0333333333333,   616.0666666666667,               616.1,
             616.1333333333333],
          dtype=&#x27;float64&#x27;, name=&#x27;time&#x27;, length=18485))</pre></div></li><li class='xr-var-item'><div class='xr-index-name'><div>space</div></div><div class='xr-index-preview'>PandasIndex</div><input type='checkbox' disabled/><label></label><input id='index-37037014-298f-4f99-8a39-07dabe96351d' class='xr-index-data-in' type='checkbox'/><label for='index-37037014-298f-4f99-8a39-07dabe96351d' title='Show/Hide index repr'><svg class='icon xr-icon-database'><use xlink:href='#icon-database'></use></svg></label><div class='xr-index-data'><pre>PandasIndex(Index([&#x27;x&#x27;, &#x27;y&#x27;], dtype=&#x27;object&#x27;, name=&#x27;space&#x27;))</pre></div></li><li class='xr-var-item'><div class='xr-index-name'><div>keypoints</div></div><div class='xr-index-preview'>PandasIndex</div><input type='checkbox' disabled/><label></label><input id='index-1abd3b0d-5f18-49b8-b3b7-08727fa2e197' class='xr-index-data-in' type='checkbox'/><label for='index-1abd3b0d-5f18-49b8-b3b7-08727fa2e197' title='Show/Hide index repr'><svg class='icon xr-icon-database'><use xlink:href='#icon-database'></use></svg></label><div class='xr-index-data'><pre>PandasIndex(Index([&#x27;snout&#x27;, &#x27;left_ear&#x27;, &#x27;right_ear&#x27;, &#x27;centre&#x27;, &#x27;tail_base&#x27;, &#x27;tail_end&#x27;], dtype=&#x27;object&#x27;, name=&#x27;keypoints&#x27;))</pre></div></li><li class='xr-var-item'><div class='xr-index-name'><div>individuals</div></div><div class='xr-index-preview'>PandasIndex</div><input type='checkbox' disabled/><label></label><input id='index-32f807de-c866-40ed-b616-b3166e1063fd' class='xr-index-data-in' type='checkbox'/><label for='index-32f807de-c866-40ed-b616-b3166e1063fd' title='Show/Hide index repr'><svg class='icon xr-icon-database'><use xlink:href='#icon-database'></use></svg></label><div class='xr-index-data'><pre>PandasIndex(Index([&#x27;id_0&#x27;], dtype=&#x27;object&#x27;, name=&#x27;individuals&#x27;))</pre></div></li></ul></div></li><li class='xr-section-item'><input id='section-b6a0e3af-6012-4cea-9f85-f1a1897349fb' class='xr-section-summary-in' type='checkbox'  checked><label for='section-b6a0e3af-6012-4cea-9f85-f1a1897349fb' class='xr-section-summary' >Attributes: <span>(6)</span></label><div class='xr-section-inline-details'></div><div class='xr-section-details'><dl class='xr-attrs'><dt><span>source_software :</span></dt><dd>SLEAP</dd><dt><span>ds_type :</span></dt><dd>poses</dd><dt><span>fps :</span></dt><dd>30.0</dd><dt><span>time_unit :</span></dt><dd>seconds</dd><dt><span>source_file :</span></dt><dd>/home/runner/.movement/data/poses/SLEAP_single-mouse_EPM.analysis.h5</dd><dt><span>frame_path :</span></dt><dd>/home/runner/.movement/data/frames/single-mouse_EPM_frame-20sec.png</dd></dl></div></li></ul></div></div>
    </div>
    <br />
    <br />

.. GENERATED FROM PYTHON SOURCE LINES 250-255

The number of NaN values has decreased even further.
That's because the chance of finding at least 2 valid values within
a 2-second window (i.e. 60 frames) is quite high.
Let's plot the results for the same keypoint and time range
as before.

.. GENERATED FROM PYTHON SOURCE LINES 255-259

.. code-block:: Python


    plot_raw_and_smooth_timeseries_and_psd(
        ds_mouse, ds_mouse_smooth, keypoint="snout", time_range=slice(0, 80)
    )



.. image-sg:: /examples/images/sphx_glr_smooth_003.png
   :alt: Time Domain, Frequency Domain
   :srcset: /examples/images/sphx_glr_smooth_003.png
   :class: sphx-glr-single-img





.. GENERATED FROM PYTHON SOURCE LINES 260-268

We see that the filtered time series is much smoother and it has even
"bridged" over some small gaps. That said, it often deviates from the raw
data, in ways that may not be desirable, depending on the application.
Here, our choice of ``window`` may be too large.
In general, you should choose a ``window`` that is small enough to
preserve the original data structure, but large enough to remove
"spikes" and high-frequency noise. Always inspect the results to ensure
that the filter is not removing important features.

.. GENERATED FROM PYTHON SOURCE LINES 270-286

Smoothing with a Savitzky-Golay filter
--------------------------------------
Here we apply the :func:`movement.filtering.savgol_filter` function
(a wrapper around :func:`scipy.signal.savgol_filter`), to the ``position``
data variable.
The Savitzky-Golay filter is a polynomial smoothing filter that can be
applied to time series data on a rolling window basis.
A polynomial with a degree specified by ``polyorder`` is applied to each
data segment defined by the size ``window``.
The value of the polynomial at the midpoint of each ``window`` is then
used as the output value.

Let's try it on the mouse dataset, this time using a 0.2-second
window (i.e. 6 frames) and the default ``polyorder=2`` for smoothing.
As before, we first compute the corresponding number of observations
to be used as the ``window`` size.

.. GENERATED FROM PYTHON SOURCE LINES 286-292

.. code-block:: Python


    window = int(0.2 * ds_mouse.fps)
    ds_mouse_smooth.update(
        {"position": savgol_filter(ds_mouse.position, window, print_report=True)}
    )





.. rst-class:: sphx-glr-script-out

 .. code-block:: none

    Missing points (marked as NaN) in input:

    keypoints                  snout           left_ear          right_ear             centre          tail_base            tail_end
    individuals                                                                                                                     
    id_0         4494/18485 (24.31%)  513/18485 (2.78%)  533/18485 (2.88%)  490/18485 (2.65%)  704/18485 (3.81%)  2496/18485 (13.5%)
    Missing points (marked as NaN) in output:

    keypoints                  snout           left_ear         right_ear             centre           tail_base             tail_end
    individuals                                                                                                                      
    id_0         5810/18485 (31.43%)  895/18485 (4.84%)  905/18485 (4.9%)  839/18485 (4.54%)  1186/18485 (6.42%)  3801/18485 (20.56%)


.. raw:: html

    <div class="output_subarea output_html rendered_html output_result">
    <div><svg style="position: absolute; width: 0; height: 0; overflow: hidden">
    <defs>
    <symbol id="icon-database" viewBox="0 0 32 32">
    <path d="M16 0c-8.837 0-16 2.239-16 5v4c0 2.761 7.163 5 16 5s16-2.239 16-5v-4c0-2.761-7.163-5-16-5z"></path>
    <path d="M16 17c-8.837 0-16-2.239-16-5v6c0 2.761 7.163 5 16 5s16-2.239 16-5v-6c0 2.761-7.163 5-16 5z"></path>
    <path d="M16 26c-8.837 0-16-2.239-16-5v6c0 2.761 7.163 5 16 5s16-2.239 16-5v-6c0 2.761-7.163 5-16 5z"></path>
    </symbol>
    <symbol id="icon-file-text2" viewBox="0 0 32 32">
    <path d="M28.681 7.159c-0.694-0.947-1.662-2.053-2.724-3.116s-2.169-2.030-3.116-2.724c-1.612-1.182-2.393-1.319-2.841-1.319h-15.5c-1.378 0-2.5 1.121-2.5 2.5v27c0 1.378 1.122 2.5 2.5 2.5h23c1.378 0 2.5-1.122 2.5-2.5v-19.5c0-0.448-0.137-1.23-1.319-2.841zM24.543 5.457c0.959 0.959 1.712 1.825 2.268 2.543h-4.811v-4.811c0.718 0.556 1.584 1.309 2.543 2.268zM28 29.5c0 0.271-0.229 0.5-0.5 0.5h-23c-0.271 0-0.5-0.229-0.5-0.5v-27c0-0.271 0.229-0.5 0.5-0.5 0 0 15.499-0 15.5 0v7c0 0.552 0.448 1 1 1h7v19.5z"></path>
    <path d="M23 26h-14c-0.552 0-1-0.448-1-1s0.448-1 1-1h14c0.552 0 1 0.448 1 1s-0.448 1-1 1z"></path>
    <path d="M23 22h-14c-0.552 0-1-0.448-1-1s0.448-1 1-1h14c0.552 0 1 0.448 1 1s-0.448 1-1 1z"></path>
    <path d="M23 18h-14c-0.552 0-1-0.448-1-1s0.448-1 1-1h14c0.552 0 1 0.448 1 1s-0.448 1-1 1z"></path>
    </symbol>
    </defs>
    </svg>
    <style>/* CSS stylesheet for displaying xarray objects in jupyterlab.
     *
     */

    :root {
      --xr-font-color0: var(
        --jp-content-font-color0,
        var(--pst-color-text-base rgba(0, 0, 0, 1))
      );
      --xr-font-color2: var(
        --jp-content-font-color2,
        var(--pst-color-text-base, rgba(0, 0, 0, 0.54))
      );
      --xr-font-color3: var(
        --jp-content-font-color3,
        var(--pst-color-text-base, rgba(0, 0, 0, 0.38))
      );
      --xr-border-color: var(
        --jp-border-color2,
        hsl(from var(--pst-color-on-background, white) h s calc(l - 10))
      );
      --xr-disabled-color: var(
        --jp-layout-color3,
        hsl(from var(--pst-color-on-background, white) h s calc(l - 40))
      );
      --xr-background-color: var(
        --jp-layout-color0,
        var(--pst-color-on-background, white)
      );
      --xr-background-color-row-even: var(
        --jp-layout-color1,
        hsl(from var(--pst-color-on-background, white) h s calc(l - 5))
      );
      --xr-background-color-row-odd: var(
        --jp-layout-color2,
        hsl(from var(--pst-color-on-background, white) h s calc(l - 15))
      );
    }

    html[theme="dark"],
    html[data-theme="dark"],
    body[data-theme="dark"],
    body.vscode-dark {
      --xr-font-color0: var(
        --jp-content-font-color0,
        var(--pst-color-text-base, rgba(255, 255, 255, 1))
      );
      --xr-font-color2: var(
        --jp-content-font-color2,
        var(--pst-color-text-base, rgba(255, 255, 255, 0.54))
      );
      --xr-font-color3: var(
        --jp-content-font-color3,
        var(--pst-color-text-base, rgba(255, 255, 255, 0.38))
      );
      --xr-border-color: var(
        --jp-border-color2,
        hsl(from var(--pst-color-on-background, #111111) h s calc(l + 10))
      );
      --xr-disabled-color: var(
        --jp-layout-color3,
        hsl(from var(--pst-color-on-background, #111111) h s calc(l + 40))
      );
      --xr-background-color: var(
        --jp-layout-color0,
        var(--pst-color-on-background, #111111)
      );
      --xr-background-color-row-even: var(
        --jp-layout-color1,
        hsl(from var(--pst-color-on-background, #111111) h s calc(l + 5))
      );
      --xr-background-color-row-odd: var(
        --jp-layout-color2,
        hsl(from var(--pst-color-on-background, #111111) h s calc(l + 15))
      );
    }

    .xr-wrap {
      display: block !important;
      min-width: 300px;
      max-width: 700px;
    }

    .xr-text-repr-fallback {
      /* fallback to plain text repr when CSS is not injected (untrusted notebook) */
      display: none;
    }

    .xr-header {
      padding-top: 6px;
      padding-bottom: 6px;
      margin-bottom: 4px;
      border-bottom: solid 1px var(--xr-border-color);
    }

    .xr-header > div,
    .xr-header > ul {
      display: inline;
      margin-top: 0;
      margin-bottom: 0;
    }

    .xr-obj-type,
    .xr-array-name {
      margin-left: 2px;
      margin-right: 10px;
    }

    .xr-obj-type {
      color: var(--xr-font-color2);
    }

    .xr-sections {
      padding-left: 0 !important;
      display: grid;
      grid-template-columns: 150px auto auto 1fr 0 20px 0 20px;
    }

    .xr-section-item {
      display: contents;
    }

    .xr-section-item input {
      display: inline-block;
      opacity: 0;
      height: 0;
    }

    .xr-section-item input + label {
      color: var(--xr-disabled-color);
      border: 2px solid transparent !important;
    }

    .xr-section-item input:enabled + label {
      cursor: pointer;
      color: var(--xr-font-color2);
    }

    .xr-section-item input:focus + label {
      border: 2px solid var(--xr-font-color0) !important;
    }

    .xr-section-item input:enabled + label:hover {
      color: var(--xr-font-color0);
    }

    .xr-section-summary {
      grid-column: 1;
      color: var(--xr-font-color2);
      font-weight: 500;
    }

    .xr-section-summary > span {
      display: inline-block;
      padding-left: 0.5em;
    }

    .xr-section-summary-in:disabled + label {
      color: var(--xr-font-color2);
    }

    .xr-section-summary-in + label:before {
      display: inline-block;
      content: "►";
      font-size: 11px;
      width: 15px;
      text-align: center;
    }

    .xr-section-summary-in:disabled + label:before {
      color: var(--xr-disabled-color);
    }

    .xr-section-summary-in:checked + label:before {
      content: "▼";
    }

    .xr-section-summary-in:checked + label > span {
      display: none;
    }

    .xr-section-summary,
    .xr-section-inline-details {
      padding-top: 4px;
      padding-bottom: 4px;
    }

    .xr-section-inline-details {
      grid-column: 2 / -1;
    }

    .xr-section-details {
      display: none;
      grid-column: 1 / -1;
      margin-bottom: 5px;
    }

    .xr-section-summary-in:checked ~ .xr-section-details {
      display: contents;
    }

    .xr-array-wrap {
      grid-column: 1 / -1;
      display: grid;
      grid-template-columns: 20px auto;
    }

    .xr-array-wrap > label {
      grid-column: 1;
      vertical-align: top;
    }

    .xr-preview {
      color: var(--xr-font-color3);
    }

    .xr-array-preview,
    .xr-array-data {
      padding: 0 5px !important;
      grid-column: 2;
    }

    .xr-array-data,
    .xr-array-in:checked ~ .xr-array-preview {
      display: none;
    }

    .xr-array-in:checked ~ .xr-array-data,
    .xr-array-preview {
      display: inline-block;
    }

    .xr-dim-list {
      display: inline-block !important;
      list-style: none;
      padding: 0 !important;
      margin: 0;
    }

    .xr-dim-list li {
      display: inline-block;
      padding: 0;
      margin: 0;
    }

    .xr-dim-list:before {
      content: "(";
    }

    .xr-dim-list:after {
      content: ")";
    }

    .xr-dim-list li:not(:last-child):after {
      content: ",";
      padding-right: 5px;
    }

    .xr-has-index {
      font-weight: bold;
    }

    .xr-var-list,
    .xr-var-item {
      display: contents;
    }

    .xr-var-item > div,
    .xr-var-item label,
    .xr-var-item > .xr-var-name span {
      background-color: var(--xr-background-color-row-even);
      border-color: var(--xr-background-color-row-odd);
      margin-bottom: 0;
      padding-top: 2px;
    }

    .xr-var-item > .xr-var-name:hover span {
      padding-right: 5px;
    }

    .xr-var-list > li:nth-child(odd) > div,
    .xr-var-list > li:nth-child(odd) > label,
    .xr-var-list > li:nth-child(odd) > .xr-var-name span {
      background-color: var(--xr-background-color-row-odd);
      border-color: var(--xr-background-color-row-even);
    }

    .xr-var-name {
      grid-column: 1;
    }

    .xr-var-dims {
      grid-column: 2;
    }

    .xr-var-dtype {
      grid-column: 3;
      text-align: right;
      color: var(--xr-font-color2);
    }

    .xr-var-preview {
      grid-column: 4;
    }

    .xr-index-preview {
      grid-column: 2 / 5;
      color: var(--xr-font-color2);
    }

    .xr-var-name,
    .xr-var-dims,
    .xr-var-dtype,
    .xr-preview,
    .xr-attrs dt {
      white-space: nowrap;
      overflow: hidden;
      text-overflow: ellipsis;
      padding-right: 10px;
    }

    .xr-var-name:hover,
    .xr-var-dims:hover,
    .xr-var-dtype:hover,
    .xr-attrs dt:hover {
      overflow: visible;
      width: auto;
      z-index: 1;
    }

    .xr-var-attrs,
    .xr-var-data,
    .xr-index-data {
      display: none;
      border-top: 2px dotted var(--xr-background-color);
      padding-bottom: 20px !important;
      padding-top: 10px !important;
    }

    .xr-var-attrs-in + label,
    .xr-var-data-in + label,
    .xr-index-data-in + label {
      padding: 0 1px;
    }

    .xr-var-attrs-in:checked ~ .xr-var-attrs,
    .xr-var-data-in:checked ~ .xr-var-data,
    .xr-index-data-in:checked ~ .xr-index-data {
      display: block;
    }

    .xr-var-data > table {
      float: right;
    }

    .xr-var-data > pre,
    .xr-index-data > pre,
    .xr-var-data > table > tbody > tr {
      background-color: transparent !important;
    }

    .xr-var-name span,
    .xr-var-data,
    .xr-index-name div,
    .xr-index-data,
    .xr-attrs {
      padding-left: 25px !important;
    }

    .xr-attrs,
    .xr-var-attrs,
    .xr-var-data,
    .xr-index-data {
      grid-column: 1 / -1;
    }

    dl.xr-attrs {
      padding: 0;
      margin: 0;
      display: grid;
      grid-template-columns: 125px auto;
    }

    .xr-attrs dt,
    .xr-attrs dd {
      padding: 0;
      margin: 0;
      float: left;
      padding-right: 10px;
      width: auto;
    }

    .xr-attrs dt {
      font-weight: normal;
      grid-column: 1;
    }

    .xr-attrs dt:hover span {
      display: inline-block;
      background: var(--xr-background-color);
      padding-right: 10px;
    }

    .xr-attrs dd {
      grid-column: 2;
      white-space: pre-wrap;
      word-break: break-all;
    }

    .xr-icon-database,
    .xr-icon-file-text2,
    .xr-no-icon {
      display: inline-block;
      vertical-align: middle;
      width: 1em;
      height: 1.5em !important;
      stroke-width: 0;
      stroke: currentColor;
      fill: currentColor;
    }

    .xr-var-attrs-in:checked + label > .xr-icon-file-text2,
    .xr-var-data-in:checked + label > .xr-icon-database,
    .xr-index-data-in:checked + label > .xr-icon-database {
      color: var(--xr-font-color0);
      filter: drop-shadow(1px 1px 5px var(--xr-font-color2));
      stroke-width: 0.8px;
    }
    </style><pre class='xr-text-repr-fallback'>&lt;xarray.Dataset&gt; Size: 1MB
    Dimensions:      (time: 18485, space: 2, keypoints: 6, individuals: 1)
    Coordinates:
      * time         (time) float64 148kB 0.0 0.03333 0.06667 ... 616.1 616.1 616.1
      * space        (space) &lt;U1 8B &#x27;x&#x27; &#x27;y&#x27;
      * keypoints    (keypoints) &lt;U9 216B &#x27;snout&#x27; &#x27;left_ear&#x27; ... &#x27;tail_end&#x27;
      * individuals  (individuals) &lt;U4 16B &#x27;id_0&#x27;
    Data variables:
        position     (time, space, keypoints, individuals) float32 887kB nan ... ...
        confidence   (time, keypoints, individuals) float32 444kB nan nan ... 0.7607
    Attributes:
        source_software:  SLEAP
        ds_type:          poses
        fps:              30.0
        time_unit:        seconds
        source_file:      /home/runner/.movement/data/poses/SLEAP_single-mouse_EP...
        frame_path:       /home/runner/.movement/data/frames/single-mouse_EPM_fra...</pre><div class='xr-wrap' style='display:none'><div class='xr-header'><div class='xr-obj-type'>xarray.Dataset</div></div><ul class='xr-sections'><li class='xr-section-item'><input id='section-eb574431-cef1-4203-bbca-cc9f8b3bc7fa' class='xr-section-summary-in' type='checkbox' disabled ><label for='section-eb574431-cef1-4203-bbca-cc9f8b3bc7fa' class='xr-section-summary'  title='Expand/collapse section'>Dimensions:</label><div class='xr-section-inline-details'><ul class='xr-dim-list'><li><span class='xr-has-index'>time</span>: 18485</li><li><span class='xr-has-index'>space</span>: 2</li><li><span class='xr-has-index'>keypoints</span>: 6</li><li><span class='xr-has-index'>individuals</span>: 1</li></ul></div><div class='xr-section-details'></div></li><li class='xr-section-item'><input id='section-2d7786ad-a84c-4586-9943-41f6f5d99668' class='xr-section-summary-in' type='checkbox'  checked><label for='section-2d7786ad-a84c-4586-9943-41f6f5d99668' class='xr-section-summary' >Coordinates: <span>(4)</span></label><div class='xr-section-inline-details'></div><div class='xr-section-details'><ul class='xr-var-list'><li class='xr-var-item'><div class='xr-var-name'><span class='xr-has-index'>time</span></div><div class='xr-var-dims'>(time)</div><div class='xr-var-dtype'>float64</div><div class='xr-var-preview xr-preview'>0.0 0.03333 0.06667 ... 616.1 616.1</div><input id='attrs-e2930e6c-bf13-464d-a93c-d8d357e092d4' class='xr-var-attrs-in' type='checkbox' disabled><label for='attrs-e2930e6c-bf13-464d-a93c-d8d357e092d4' title='Show/Hide attributes'><svg class='icon xr-icon-file-text2'><use xlink:href='#icon-file-text2'></use></svg></label><input id='data-d90d9ccc-37cf-4290-81e5-e41100f1a39d' class='xr-var-data-in' type='checkbox'><label for='data-d90d9ccc-37cf-4290-81e5-e41100f1a39d' title='Show/Hide data repr'><svg class='icon xr-icon-database'><use xlink:href='#icon-database'></use></svg></label><div class='xr-var-attrs'><dl class='xr-attrs'></dl></div><div class='xr-var-data'><pre>array([0.000000e+00, 3.333333e-02, 6.666667e-02, ..., 6.160667e+02,
           6.161000e+02, 6.161333e+02], shape=(18485,))</pre></div></li><li class='xr-var-item'><div class='xr-var-name'><span class='xr-has-index'>space</span></div><div class='xr-var-dims'>(space)</div><div class='xr-var-dtype'>&lt;U1</div><div class='xr-var-preview xr-preview'>&#x27;x&#x27; &#x27;y&#x27;</div><input id='attrs-5794c8bd-3832-4910-8602-74aa08ee40ce' class='xr-var-attrs-in' type='checkbox' disabled><label for='attrs-5794c8bd-3832-4910-8602-74aa08ee40ce' title='Show/Hide attributes'><svg class='icon xr-icon-file-text2'><use xlink:href='#icon-file-text2'></use></svg></label><input id='data-da3d2a6e-3b6f-4003-89c1-d48339c79fcd' class='xr-var-data-in' type='checkbox'><label for='data-da3d2a6e-3b6f-4003-89c1-d48339c79fcd' title='Show/Hide data repr'><svg class='icon xr-icon-database'><use xlink:href='#icon-database'></use></svg></label><div class='xr-var-attrs'><dl class='xr-attrs'></dl></div><div class='xr-var-data'><pre>array([&#x27;x&#x27;, &#x27;y&#x27;], dtype=&#x27;&lt;U1&#x27;)</pre></div></li><li class='xr-var-item'><div class='xr-var-name'><span class='xr-has-index'>keypoints</span></div><div class='xr-var-dims'>(keypoints)</div><div class='xr-var-dtype'>&lt;U9</div><div class='xr-var-preview xr-preview'>&#x27;snout&#x27; &#x27;left_ear&#x27; ... &#x27;tail_end&#x27;</div><input id='attrs-003d6d2f-7e7c-49e4-ae16-287da8d01722' class='xr-var-attrs-in' type='checkbox' disabled><label for='attrs-003d6d2f-7e7c-49e4-ae16-287da8d01722' title='Show/Hide attributes'><svg class='icon xr-icon-file-text2'><use xlink:href='#icon-file-text2'></use></svg></label><input id='data-45447deb-e3fe-48e8-8067-9cebe9cb25ae' class='xr-var-data-in' type='checkbox'><label for='data-45447deb-e3fe-48e8-8067-9cebe9cb25ae' title='Show/Hide data repr'><svg class='icon xr-icon-database'><use xlink:href='#icon-database'></use></svg></label><div class='xr-var-attrs'><dl class='xr-attrs'></dl></div><div class='xr-var-data'><pre>array([&#x27;snout&#x27;, &#x27;left_ear&#x27;, &#x27;right_ear&#x27;, &#x27;centre&#x27;, &#x27;tail_base&#x27;, &#x27;tail_end&#x27;],
          dtype=&#x27;&lt;U9&#x27;)</pre></div></li><li class='xr-var-item'><div class='xr-var-name'><span class='xr-has-index'>individuals</span></div><div class='xr-var-dims'>(individuals)</div><div class='xr-var-dtype'>&lt;U4</div><div class='xr-var-preview xr-preview'>&#x27;id_0&#x27;</div><input id='attrs-b41f7bf5-aec8-4747-8dc4-3afb60364ada' class='xr-var-attrs-in' type='checkbox' disabled><label for='attrs-b41f7bf5-aec8-4747-8dc4-3afb60364ada' title='Show/Hide attributes'><svg class='icon xr-icon-file-text2'><use xlink:href='#icon-file-text2'></use></svg></label><input id='data-e00071ed-2256-42a5-aba5-f580bc62e9cb' class='xr-var-data-in' type='checkbox'><label for='data-e00071ed-2256-42a5-aba5-f580bc62e9cb' title='Show/Hide data repr'><svg class='icon xr-icon-database'><use xlink:href='#icon-database'></use></svg></label><div class='xr-var-attrs'><dl class='xr-attrs'></dl></div><div class='xr-var-data'><pre>array([&#x27;id_0&#x27;], dtype=&#x27;&lt;U4&#x27;)</pre></div></li></ul></div></li><li class='xr-section-item'><input id='section-65a6d09d-bf2a-42e2-8520-09ac3a6f3b94' class='xr-section-summary-in' type='checkbox'  checked><label for='section-65a6d09d-bf2a-42e2-8520-09ac3a6f3b94' class='xr-section-summary' >Data variables: <span>(2)</span></label><div class='xr-section-inline-details'></div><div class='xr-section-details'><ul class='xr-var-list'><li class='xr-var-item'><div class='xr-var-name'><span>position</span></div><div class='xr-var-dims'>(time, space, keypoints, individuals)</div><div class='xr-var-dtype'>float32</div><div class='xr-var-preview xr-preview'>nan nan nan ... 440.4 384.0 476.2</div><input id='attrs-7ef6b3fb-97f9-445a-bd79-678a0ca5052d' class='xr-var-attrs-in' type='checkbox' ><label for='attrs-7ef6b3fb-97f9-445a-bd79-678a0ca5052d' title='Show/Hide attributes'><svg class='icon xr-icon-file-text2'><use xlink:href='#icon-file-text2'></use></svg></label><input id='data-b21fd90c-c0a0-4444-99dc-d74611ccea52' class='xr-var-data-in' type='checkbox'><label for='data-b21fd90c-c0a0-4444-99dc-d74611ccea52' title='Show/Hide data repr'><svg class='icon xr-icon-database'><use xlink:href='#icon-database'></use></svg></label><div class='xr-var-attrs'><dl class='xr-attrs'><dt><span>log :</span></dt><dd>[
      {
        &quot;operation&quot;: &quot;savgol_filter&quot;,
        &quot;datetime&quot;: &quot;2025-07-22 16:47:40.218540&quot;,
        &quot;window&quot;: &quot;6&quot;,
        &quot;polyorder&quot;: &quot;2&quot;,
        &quot;print_report&quot;: &quot;True&quot;
      }
    ]</dd></dl></div><div class='xr-var-data'><pre>array([[[[      nan],
             [      nan],
             [      nan],
             [      nan],
             [      nan],
             [      nan]],

            [[      nan],
             [      nan],
             [      nan],
             [      nan],
             [      nan],
             [      nan]]],


           [[[      nan],
             [      nan],
             [      nan],
             [      nan],
             [      nan],
    ...
             [486.02914],
             [491.82062],
             [439.01932],
             [384.39636],
             [476.5229 ]]],


           [[[685.86224],
             [693.0002 ],
             [668.3964 ],
             [667.8464 ],
             [636.8503 ],
             [588.4095 ]],

            [[505.34033],
             [486.7021 ],
             [492.4088 ],
             [440.36227],
             [384.02908],
             [476.17532]]]], shape=(18485, 2, 6, 1), dtype=float32)</pre></div></li><li class='xr-var-item'><div class='xr-var-name'><span>confidence</span></div><div class='xr-var-dims'>(time, keypoints, individuals)</div><div class='xr-var-dtype'>float32</div><div class='xr-var-preview xr-preview'>nan nan nan ... 0.9336 0.7607</div><input id='attrs-5954b88b-3f07-4b3e-a559-a350ce1e7829' class='xr-var-attrs-in' type='checkbox' disabled><label for='attrs-5954b88b-3f07-4b3e-a559-a350ce1e7829' title='Show/Hide attributes'><svg class='icon xr-icon-file-text2'><use xlink:href='#icon-file-text2'></use></svg></label><input id='data-132ddd33-4257-45b4-8a2a-51101cbe67ea' class='xr-var-data-in' type='checkbox'><label for='data-132ddd33-4257-45b4-8a2a-51101cbe67ea' title='Show/Hide data repr'><svg class='icon xr-icon-database'><use xlink:href='#icon-database'></use></svg></label><div class='xr-var-attrs'><dl class='xr-attrs'></dl></div><div class='xr-var-data'><pre>array([[[       nan],
            [       nan],
            [       nan],
            [       nan],
            [       nan],
            [       nan]],

           [[       nan],
            [       nan],
            [       nan],
            [       nan],
            [       nan],
            [       nan]],

           [[       nan],
            [       nan],
            [       nan],
            [       nan],
            [       nan],
            [       nan]],
    ...
           [[0.9317396 ],
            [1.0026728 ],
            [1.025079  ],
            [0.92725545],
            [0.95202184],
            [0.7779419 ]],

           [[0.9193515 ],
            [1.0136327 ],
            [1.0336665 ],
            [0.93108493],
            [0.94561106],
            [0.7662804 ]],

           [[0.93820494],
            [1.0224991 ],
            [1.0452943 ],
            [0.9363993 ],
            [0.9335798 ],
            [0.76068705]]], shape=(18485, 6, 1), dtype=float32)</pre></div></li></ul></div></li><li class='xr-section-item'><input id='section-ea65d552-63bb-4f7f-8dce-0af8bc6094a1' class='xr-section-summary-in' type='checkbox'  ><label for='section-ea65d552-63bb-4f7f-8dce-0af8bc6094a1' class='xr-section-summary' >Indexes: <span>(4)</span></label><div class='xr-section-inline-details'></div><div class='xr-section-details'><ul class='xr-var-list'><li class='xr-var-item'><div class='xr-index-name'><div>time</div></div><div class='xr-index-preview'>PandasIndex</div><input type='checkbox' disabled/><label></label><input id='index-1f6bc3e8-7cfd-4e2f-ac8a-ac0a64673c47' class='xr-index-data-in' type='checkbox'/><label for='index-1f6bc3e8-7cfd-4e2f-ac8a-ac0a64673c47' title='Show/Hide index repr'><svg class='icon xr-icon-database'><use xlink:href='#icon-database'></use></svg></label><div class='xr-index-data'><pre>PandasIndex(Index([                0.0, 0.03333333333333333, 0.06666666666666667,
                           0.1, 0.13333333333333333, 0.16666666666666666,
                           0.2, 0.23333333333333334, 0.26666666666666666,
                           0.3,
           ...
             615.8333333333334,   615.8666666666667,               615.9,
             615.9333333333333,   615.9666666666667,               616.0,
             616.0333333333333,   616.0666666666667,               616.1,
             616.1333333333333],
          dtype=&#x27;float64&#x27;, name=&#x27;time&#x27;, length=18485))</pre></div></li><li class='xr-var-item'><div class='xr-index-name'><div>space</div></div><div class='xr-index-preview'>PandasIndex</div><input type='checkbox' disabled/><label></label><input id='index-37d67a43-e327-4c15-9abc-b46a748f13db' class='xr-index-data-in' type='checkbox'/><label for='index-37d67a43-e327-4c15-9abc-b46a748f13db' title='Show/Hide index repr'><svg class='icon xr-icon-database'><use xlink:href='#icon-database'></use></svg></label><div class='xr-index-data'><pre>PandasIndex(Index([&#x27;x&#x27;, &#x27;y&#x27;], dtype=&#x27;object&#x27;, name=&#x27;space&#x27;))</pre></div></li><li class='xr-var-item'><div class='xr-index-name'><div>keypoints</div></div><div class='xr-index-preview'>PandasIndex</div><input type='checkbox' disabled/><label></label><input id='index-b634c94a-460b-4c9e-ad1c-64f17d7beca6' class='xr-index-data-in' type='checkbox'/><label for='index-b634c94a-460b-4c9e-ad1c-64f17d7beca6' title='Show/Hide index repr'><svg class='icon xr-icon-database'><use xlink:href='#icon-database'></use></svg></label><div class='xr-index-data'><pre>PandasIndex(Index([&#x27;snout&#x27;, &#x27;left_ear&#x27;, &#x27;right_ear&#x27;, &#x27;centre&#x27;, &#x27;tail_base&#x27;, &#x27;tail_end&#x27;], dtype=&#x27;object&#x27;, name=&#x27;keypoints&#x27;))</pre></div></li><li class='xr-var-item'><div class='xr-index-name'><div>individuals</div></div><div class='xr-index-preview'>PandasIndex</div><input type='checkbox' disabled/><label></label><input id='index-b73dd032-4adc-4214-a31c-6f80f0198e0c' class='xr-index-data-in' type='checkbox'/><label for='index-b73dd032-4adc-4214-a31c-6f80f0198e0c' title='Show/Hide index repr'><svg class='icon xr-icon-database'><use xlink:href='#icon-database'></use></svg></label><div class='xr-index-data'><pre>PandasIndex(Index([&#x27;id_0&#x27;], dtype=&#x27;object&#x27;, name=&#x27;individuals&#x27;))</pre></div></li></ul></div></li><li class='xr-section-item'><input id='section-6c6d4003-d879-4f13-b72b-18855f557b3f' class='xr-section-summary-in' type='checkbox'  checked><label for='section-6c6d4003-d879-4f13-b72b-18855f557b3f' class='xr-section-summary' >Attributes: <span>(6)</span></label><div class='xr-section-inline-details'></div><div class='xr-section-details'><dl class='xr-attrs'><dt><span>source_software :</span></dt><dd>SLEAP</dd><dt><span>ds_type :</span></dt><dd>poses</dd><dt><span>fps :</span></dt><dd>30.0</dd><dt><span>time_unit :</span></dt><dd>seconds</dd><dt><span>source_file :</span></dt><dd>/home/runner/.movement/data/poses/SLEAP_single-mouse_EPM.analysis.h5</dd><dt><span>frame_path :</span></dt><dd>/home/runner/.movement/data/frames/single-mouse_EPM_frame-20sec.png</dd></dl></div></li></ul></div></div>
    </div>
    <br />
    <br />

.. GENERATED FROM PYTHON SOURCE LINES 293-299

We see that the number of NaN values has increased after filtering. This is
for the same reason as with the rolling filter (in its default mode), i.e.
if there is at least one NaN value in the window, the output will be NaN.
Unlike the rolling filter, the Savitzky-Golay filter does not provide a
``min_periods`` parameter to control this behaviour. Let's visualise the
effects in the time and frequency domains.

.. GENERATED FROM PYTHON SOURCE LINES 299-303

.. code-block:: Python


    plot_raw_and_smooth_timeseries_and_psd(
        ds_mouse, ds_mouse_smooth, keypoint="snout", time_range=slice(0, 80)
    )



.. image-sg:: /examples/images/sphx_glr_smooth_004.png
   :alt: Time Domain, Frequency Domain
   :srcset: /examples/images/sphx_glr_smooth_004.png
   :class: sphx-glr-single-img





.. GENERATED FROM PYTHON SOURCE LINES 304-306

Once again, the power of high-frequency components has been reduced, but more
missing values have been introduced.

.. GENERATED FROM PYTHON SOURCE LINES 308-309

Now let's apply the same Savitzky-Golay filter to the wasp dataset.

.. GENERATED FROM PYTHON SOURCE LINES 309-315

.. code-block:: Python


    window = int(0.2 * ds_wasp.fps)
    ds_wasp_smooth.update(
        {"position": savgol_filter(ds_wasp.position, window, print_report=True)}
    )





.. rst-class:: sphx-glr-script-out

 .. code-block:: none

    No missing points (marked as NaN) in input.
    No missing points (marked as NaN) in output.


.. raw:: html

    <div class="output_subarea output_html rendered_html output_result">
    <div><svg style="position: absolute; width: 0; height: 0; overflow: hidden">
    <defs>
    <symbol id="icon-database" viewBox="0 0 32 32">
    <path d="M16 0c-8.837 0-16 2.239-16 5v4c0 2.761 7.163 5 16 5s16-2.239 16-5v-4c0-2.761-7.163-5-16-5z"></path>
    <path d="M16 17c-8.837 0-16-2.239-16-5v6c0 2.761 7.163 5 16 5s16-2.239 16-5v-6c0 2.761-7.163 5-16 5z"></path>
    <path d="M16 26c-8.837 0-16-2.239-16-5v6c0 2.761 7.163 5 16 5s16-2.239 16-5v-6c0 2.761-7.163 5-16 5z"></path>
    </symbol>
    <symbol id="icon-file-text2" viewBox="0 0 32 32">
    <path d="M28.681 7.159c-0.694-0.947-1.662-2.053-2.724-3.116s-2.169-2.030-3.116-2.724c-1.612-1.182-2.393-1.319-2.841-1.319h-15.5c-1.378 0-2.5 1.121-2.5 2.5v27c0 1.378 1.122 2.5 2.5 2.5h23c1.378 0 2.5-1.122 2.5-2.5v-19.5c0-0.448-0.137-1.23-1.319-2.841zM24.543 5.457c0.959 0.959 1.712 1.825 2.268 2.543h-4.811v-4.811c0.718 0.556 1.584 1.309 2.543 2.268zM28 29.5c0 0.271-0.229 0.5-0.5 0.5h-23c-0.271 0-0.5-0.229-0.5-0.5v-27c0-0.271 0.229-0.5 0.5-0.5 0 0 15.499-0 15.5 0v7c0 0.552 0.448 1 1 1h7v19.5z"></path>
    <path d="M23 26h-14c-0.552 0-1-0.448-1-1s0.448-1 1-1h14c0.552 0 1 0.448 1 1s-0.448 1-1 1z"></path>
    <path d="M23 22h-14c-0.552 0-1-0.448-1-1s0.448-1 1-1h14c0.552 0 1 0.448 1 1s-0.448 1-1 1z"></path>
    <path d="M23 18h-14c-0.552 0-1-0.448-1-1s0.448-1 1-1h14c0.552 0 1 0.448 1 1s-0.448 1-1 1z"></path>
    </symbol>
    </defs>
    </svg>
    <style>/* CSS stylesheet for displaying xarray objects in jupyterlab.
     *
     */

    :root {
      --xr-font-color0: var(
        --jp-content-font-color0,
        var(--pst-color-text-base rgba(0, 0, 0, 1))
      );
      --xr-font-color2: var(
        --jp-content-font-color2,
        var(--pst-color-text-base, rgba(0, 0, 0, 0.54))
      );
      --xr-font-color3: var(
        --jp-content-font-color3,
        var(--pst-color-text-base, rgba(0, 0, 0, 0.38))
      );
      --xr-border-color: var(
        --jp-border-color2,
        hsl(from var(--pst-color-on-background, white) h s calc(l - 10))
      );
      --xr-disabled-color: var(
        --jp-layout-color3,
        hsl(from var(--pst-color-on-background, white) h s calc(l - 40))
      );
      --xr-background-color: var(
        --jp-layout-color0,
        var(--pst-color-on-background, white)
      );
      --xr-background-color-row-even: var(
        --jp-layout-color1,
        hsl(from var(--pst-color-on-background, white) h s calc(l - 5))
      );
      --xr-background-color-row-odd: var(
        --jp-layout-color2,
        hsl(from var(--pst-color-on-background, white) h s calc(l - 15))
      );
    }

    html[theme="dark"],
    html[data-theme="dark"],
    body[data-theme="dark"],
    body.vscode-dark {
      --xr-font-color0: var(
        --jp-content-font-color0,
        var(--pst-color-text-base, rgba(255, 255, 255, 1))
      );
      --xr-font-color2: var(
        --jp-content-font-color2,
        var(--pst-color-text-base, rgba(255, 255, 255, 0.54))
      );
      --xr-font-color3: var(
        --jp-content-font-color3,
        var(--pst-color-text-base, rgba(255, 255, 255, 0.38))
      );
      --xr-border-color: var(
        --jp-border-color2,
        hsl(from var(--pst-color-on-background, #111111) h s calc(l + 10))
      );
      --xr-disabled-color: var(
        --jp-layout-color3,
        hsl(from var(--pst-color-on-background, #111111) h s calc(l + 40))
      );
      --xr-background-color: var(
        --jp-layout-color0,
        var(--pst-color-on-background, #111111)
      );
      --xr-background-color-row-even: var(
        --jp-layout-color1,
        hsl(from var(--pst-color-on-background, #111111) h s calc(l + 5))
      );
      --xr-background-color-row-odd: var(
        --jp-layout-color2,
        hsl(from var(--pst-color-on-background, #111111) h s calc(l + 15))
      );
    }

    .xr-wrap {
      display: block !important;
      min-width: 300px;
      max-width: 700px;
    }

    .xr-text-repr-fallback {
      /* fallback to plain text repr when CSS is not injected (untrusted notebook) */
      display: none;
    }

    .xr-header {
      padding-top: 6px;
      padding-bottom: 6px;
      margin-bottom: 4px;
      border-bottom: solid 1px var(--xr-border-color);
    }

    .xr-header > div,
    .xr-header > ul {
      display: inline;
      margin-top: 0;
      margin-bottom: 0;
    }

    .xr-obj-type,
    .xr-array-name {
      margin-left: 2px;
      margin-right: 10px;
    }

    .xr-obj-type {
      color: var(--xr-font-color2);
    }

    .xr-sections {
      padding-left: 0 !important;
      display: grid;
      grid-template-columns: 150px auto auto 1fr 0 20px 0 20px;
    }

    .xr-section-item {
      display: contents;
    }

    .xr-section-item input {
      display: inline-block;
      opacity: 0;
      height: 0;
    }

    .xr-section-item input + label {
      color: var(--xr-disabled-color);
      border: 2px solid transparent !important;
    }

    .xr-section-item input:enabled + label {
      cursor: pointer;
      color: var(--xr-font-color2);
    }

    .xr-section-item input:focus + label {
      border: 2px solid var(--xr-font-color0) !important;
    }

    .xr-section-item input:enabled + label:hover {
      color: var(--xr-font-color0);
    }

    .xr-section-summary {
      grid-column: 1;
      color: var(--xr-font-color2);
      font-weight: 500;
    }

    .xr-section-summary > span {
      display: inline-block;
      padding-left: 0.5em;
    }

    .xr-section-summary-in:disabled + label {
      color: var(--xr-font-color2);
    }

    .xr-section-summary-in + label:before {
      display: inline-block;
      content: "►";
      font-size: 11px;
      width: 15px;
      text-align: center;
    }

    .xr-section-summary-in:disabled + label:before {
      color: var(--xr-disabled-color);
    }

    .xr-section-summary-in:checked + label:before {
      content: "▼";
    }

    .xr-section-summary-in:checked + label > span {
      display: none;
    }

    .xr-section-summary,
    .xr-section-inline-details {
      padding-top: 4px;
      padding-bottom: 4px;
    }

    .xr-section-inline-details {
      grid-column: 2 / -1;
    }

    .xr-section-details {
      display: none;
      grid-column: 1 / -1;
      margin-bottom: 5px;
    }

    .xr-section-summary-in:checked ~ .xr-section-details {
      display: contents;
    }

    .xr-array-wrap {
      grid-column: 1 / -1;
      display: grid;
      grid-template-columns: 20px auto;
    }

    .xr-array-wrap > label {
      grid-column: 1;
      vertical-align: top;
    }

    .xr-preview {
      color: var(--xr-font-color3);
    }

    .xr-array-preview,
    .xr-array-data {
      padding: 0 5px !important;
      grid-column: 2;
    }

    .xr-array-data,
    .xr-array-in:checked ~ .xr-array-preview {
      display: none;
    }

    .xr-array-in:checked ~ .xr-array-data,
    .xr-array-preview {
      display: inline-block;
    }

    .xr-dim-list {
      display: inline-block !important;
      list-style: none;
      padding: 0 !important;
      margin: 0;
    }

    .xr-dim-list li {
      display: inline-block;
      padding: 0;
      margin: 0;
    }

    .xr-dim-list:before {
      content: "(";
    }

    .xr-dim-list:after {
      content: ")";
    }

    .xr-dim-list li:not(:last-child):after {
      content: ",";
      padding-right: 5px;
    }

    .xr-has-index {
      font-weight: bold;
    }

    .xr-var-list,
    .xr-var-item {
      display: contents;
    }

    .xr-var-item > div,
    .xr-var-item label,
    .xr-var-item > .xr-var-name span {
      background-color: var(--xr-background-color-row-even);
      border-color: var(--xr-background-color-row-odd);
      margin-bottom: 0;
      padding-top: 2px;
    }

    .xr-var-item > .xr-var-name:hover span {
      padding-right: 5px;
    }

    .xr-var-list > li:nth-child(odd) > div,
    .xr-var-list > li:nth-child(odd) > label,
    .xr-var-list > li:nth-child(odd) > .xr-var-name span {
      background-color: var(--xr-background-color-row-odd);
      border-color: var(--xr-background-color-row-even);
    }

    .xr-var-name {
      grid-column: 1;
    }

    .xr-var-dims {
      grid-column: 2;
    }

    .xr-var-dtype {
      grid-column: 3;
      text-align: right;
      color: var(--xr-font-color2);
    }

    .xr-var-preview {
      grid-column: 4;
    }

    .xr-index-preview {
      grid-column: 2 / 5;
      color: var(--xr-font-color2);
    }

    .xr-var-name,
    .xr-var-dims,
    .xr-var-dtype,
    .xr-preview,
    .xr-attrs dt {
      white-space: nowrap;
      overflow: hidden;
      text-overflow: ellipsis;
      padding-right: 10px;
    }

    .xr-var-name:hover,
    .xr-var-dims:hover,
    .xr-var-dtype:hover,
    .xr-attrs dt:hover {
      overflow: visible;
      width: auto;
      z-index: 1;
    }

    .xr-var-attrs,
    .xr-var-data,
    .xr-index-data {
      display: none;
      border-top: 2px dotted var(--xr-background-color);
      padding-bottom: 20px !important;
      padding-top: 10px !important;
    }

    .xr-var-attrs-in + label,
    .xr-var-data-in + label,
    .xr-index-data-in + label {
      padding: 0 1px;
    }

    .xr-var-attrs-in:checked ~ .xr-var-attrs,
    .xr-var-data-in:checked ~ .xr-var-data,
    .xr-index-data-in:checked ~ .xr-index-data {
      display: block;
    }

    .xr-var-data > table {
      float: right;
    }

    .xr-var-data > pre,
    .xr-index-data > pre,
    .xr-var-data > table > tbody > tr {
      background-color: transparent !important;
    }

    .xr-var-name span,
    .xr-var-data,
    .xr-index-name div,
    .xr-index-data,
    .xr-attrs {
      padding-left: 25px !important;
    }

    .xr-attrs,
    .xr-var-attrs,
    .xr-var-data,
    .xr-index-data {
      grid-column: 1 / -1;
    }

    dl.xr-attrs {
      padding: 0;
      margin: 0;
      display: grid;
      grid-template-columns: 125px auto;
    }

    .xr-attrs dt,
    .xr-attrs dd {
      padding: 0;
      margin: 0;
      float: left;
      padding-right: 10px;
      width: auto;
    }

    .xr-attrs dt {
      font-weight: normal;
      grid-column: 1;
    }

    .xr-attrs dt:hover span {
      display: inline-block;
      background: var(--xr-background-color);
      padding-right: 10px;
    }

    .xr-attrs dd {
      grid-column: 2;
      white-space: pre-wrap;
      word-break: break-all;
    }

    .xr-icon-database,
    .xr-icon-file-text2,
    .xr-no-icon {
      display: inline-block;
      vertical-align: middle;
      width: 1em;
      height: 1.5em !important;
      stroke-width: 0;
      stroke: currentColor;
      fill: currentColor;
    }

    .xr-var-attrs-in:checked + label > .xr-icon-file-text2,
    .xr-var-data-in:checked + label > .xr-icon-database,
    .xr-index-data-in:checked + label > .xr-icon-database {
      color: var(--xr-font-color0);
      filter: drop-shadow(1px 1px 5px var(--xr-font-color2));
      stroke-width: 0.8px;
    }
    </style><pre class='xr-text-repr-fallback'>&lt;xarray.Dataset&gt; Size: 61kB
    Dimensions:      (time: 1085, space: 2, keypoints: 2, individuals: 1)
    Coordinates:
      * time         (time) float64 9kB 0.0 0.025 0.05 0.075 ... 27.05 27.07 27.1
      * space        (space) &lt;U1 8B &#x27;x&#x27; &#x27;y&#x27;
      * keypoints    (keypoints) &lt;U7 56B &#x27;head&#x27; &#x27;stinger&#x27;
      * individuals  (individuals) &lt;U12 48B &#x27;individual_0&#x27;
    Data variables:
        position     (time, space, keypoints, individuals) float64 35kB 1.086e+03...
        confidence   (time, keypoints, individuals) float64 17kB 0.05305 ... 0.0
    Attributes:
        source_software:  DeepLabCut
        ds_type:          poses
        fps:              40.0
        time_unit:        seconds
        source_file:      /home/runner/.movement/data/poses/DLC_single-wasp.predi...
        frame_path:       /home/runner/.movement/data/frames/single-wasp_frame-10...</pre><div class='xr-wrap' style='display:none'><div class='xr-header'><div class='xr-obj-type'>xarray.Dataset</div></div><ul class='xr-sections'><li class='xr-section-item'><input id='section-b1e33466-5e1a-4ded-b5e0-d0f230c868e4' class='xr-section-summary-in' type='checkbox' disabled ><label for='section-b1e33466-5e1a-4ded-b5e0-d0f230c868e4' class='xr-section-summary'  title='Expand/collapse section'>Dimensions:</label><div class='xr-section-inline-details'><ul class='xr-dim-list'><li><span class='xr-has-index'>time</span>: 1085</li><li><span class='xr-has-index'>space</span>: 2</li><li><span class='xr-has-index'>keypoints</span>: 2</li><li><span class='xr-has-index'>individuals</span>: 1</li></ul></div><div class='xr-section-details'></div></li><li class='xr-section-item'><input id='section-609836e7-9d1a-4b93-8b65-d75ed4e21de2' class='xr-section-summary-in' type='checkbox'  checked><label for='section-609836e7-9d1a-4b93-8b65-d75ed4e21de2' class='xr-section-summary' >Coordinates: <span>(4)</span></label><div class='xr-section-inline-details'></div><div class='xr-section-details'><ul class='xr-var-list'><li class='xr-var-item'><div class='xr-var-name'><span class='xr-has-index'>time</span></div><div class='xr-var-dims'>(time)</div><div class='xr-var-dtype'>float64</div><div class='xr-var-preview xr-preview'>0.0 0.025 0.05 ... 27.05 27.07 27.1</div><input id='attrs-8dd6f4c4-af2b-4863-b864-054d58aa937e' class='xr-var-attrs-in' type='checkbox' disabled><label for='attrs-8dd6f4c4-af2b-4863-b864-054d58aa937e' title='Show/Hide attributes'><svg class='icon xr-icon-file-text2'><use xlink:href='#icon-file-text2'></use></svg></label><input id='data-548b32ac-661a-4efc-9860-efe5293f06c5' class='xr-var-data-in' type='checkbox'><label for='data-548b32ac-661a-4efc-9860-efe5293f06c5' title='Show/Hide data repr'><svg class='icon xr-icon-database'><use xlink:href='#icon-database'></use></svg></label><div class='xr-var-attrs'><dl class='xr-attrs'></dl></div><div class='xr-var-data'><pre>array([0.0000e+00, 2.5000e-02, 5.0000e-02, ..., 2.7050e+01, 2.7075e+01,
           2.7100e+01], shape=(1085,))</pre></div></li><li class='xr-var-item'><div class='xr-var-name'><span class='xr-has-index'>space</span></div><div class='xr-var-dims'>(space)</div><div class='xr-var-dtype'>&lt;U1</div><div class='xr-var-preview xr-preview'>&#x27;x&#x27; &#x27;y&#x27;</div><input id='attrs-e3ef4326-e5ea-4c04-bbc2-08ba99ec541a' class='xr-var-attrs-in' type='checkbox' disabled><label for='attrs-e3ef4326-e5ea-4c04-bbc2-08ba99ec541a' title='Show/Hide attributes'><svg class='icon xr-icon-file-text2'><use xlink:href='#icon-file-text2'></use></svg></label><input id='data-129d09cc-8600-474c-acfd-f5a2b032fda7' class='xr-var-data-in' type='checkbox'><label for='data-129d09cc-8600-474c-acfd-f5a2b032fda7' title='Show/Hide data repr'><svg class='icon xr-icon-database'><use xlink:href='#icon-database'></use></svg></label><div class='xr-var-attrs'><dl class='xr-attrs'></dl></div><div class='xr-var-data'><pre>array([&#x27;x&#x27;, &#x27;y&#x27;], dtype=&#x27;&lt;U1&#x27;)</pre></div></li><li class='xr-var-item'><div class='xr-var-name'><span class='xr-has-index'>keypoints</span></div><div class='xr-var-dims'>(keypoints)</div><div class='xr-var-dtype'>&lt;U7</div><div class='xr-var-preview xr-preview'>&#x27;head&#x27; &#x27;stinger&#x27;</div><input id='attrs-e11a878b-8cdb-4637-8ea4-01921b582fef' class='xr-var-attrs-in' type='checkbox' disabled><label for='attrs-e11a878b-8cdb-4637-8ea4-01921b582fef' title='Show/Hide attributes'><svg class='icon xr-icon-file-text2'><use xlink:href='#icon-file-text2'></use></svg></label><input id='data-fcfd24db-ba4d-4729-85c5-3b146569a870' class='xr-var-data-in' type='checkbox'><label for='data-fcfd24db-ba4d-4729-85c5-3b146569a870' title='Show/Hide data repr'><svg class='icon xr-icon-database'><use xlink:href='#icon-database'></use></svg></label><div class='xr-var-attrs'><dl class='xr-attrs'></dl></div><div class='xr-var-data'><pre>array([&#x27;head&#x27;, &#x27;stinger&#x27;], dtype=&#x27;&lt;U7&#x27;)</pre></div></li><li class='xr-var-item'><div class='xr-var-name'><span class='xr-has-index'>individuals</span></div><div class='xr-var-dims'>(individuals)</div><div class='xr-var-dtype'>&lt;U12</div><div class='xr-var-preview xr-preview'>&#x27;individual_0&#x27;</div><input id='attrs-93920db3-4006-4a69-a46f-708b96ee9064' class='xr-var-attrs-in' type='checkbox' disabled><label for='attrs-93920db3-4006-4a69-a46f-708b96ee9064' title='Show/Hide attributes'><svg class='icon xr-icon-file-text2'><use xlink:href='#icon-file-text2'></use></svg></label><input id='data-0be19e47-0e97-4ae8-844d-3046f1953df7' class='xr-var-data-in' type='checkbox'><label for='data-0be19e47-0e97-4ae8-844d-3046f1953df7' title='Show/Hide data repr'><svg class='icon xr-icon-database'><use xlink:href='#icon-database'></use></svg></label><div class='xr-var-attrs'><dl class='xr-attrs'></dl></div><div class='xr-var-data'><pre>array([&#x27;individual_0&#x27;], dtype=&#x27;&lt;U12&#x27;)</pre></div></li></ul></div></li><li class='xr-section-item'><input id='section-c932252f-5a06-4948-b108-496ae7c27caf' class='xr-section-summary-in' type='checkbox'  checked><label for='section-c932252f-5a06-4948-b108-496ae7c27caf' class='xr-section-summary' >Data variables: <span>(2)</span></label><div class='xr-section-inline-details'></div><div class='xr-section-details'><ul class='xr-var-list'><li class='xr-var-item'><div class='xr-var-name'><span>position</span></div><div class='xr-var-dims'>(time, space, keypoints, individuals)</div><div class='xr-var-dtype'>float64</div><div class='xr-var-preview xr-preview'>1.086e+03 1.084e+03 ... 0.0 0.0</div><input id='attrs-5d7c4a78-f8a7-4fbf-a9ea-04be9eea9822' class='xr-var-attrs-in' type='checkbox' ><label for='attrs-5d7c4a78-f8a7-4fbf-a9ea-04be9eea9822' title='Show/Hide attributes'><svg class='icon xr-icon-file-text2'><use xlink:href='#icon-file-text2'></use></svg></label><input id='data-80691472-2288-45e0-8cb1-765f581b28ed' class='xr-var-data-in' type='checkbox'><label for='data-80691472-2288-45e0-8cb1-765f581b28ed' title='Show/Hide data repr'><svg class='icon xr-icon-database'><use xlink:href='#icon-database'></use></svg></label><div class='xr-var-attrs'><dl class='xr-attrs'><dt><span>log :</span></dt><dd>[
      {
        &quot;operation&quot;: &quot;savgol_filter&quot;,
        &quot;datetime&quot;: &quot;2025-07-22 16:47:40.465158&quot;,
        &quot;window&quot;: &quot;8&quot;,
        &quot;polyorder&quot;: &quot;2&quot;,
        &quot;print_report&quot;: &quot;True&quot;
      }
    ]</dd></dl></div><div class='xr-var-data'><pre>array([[[[1086.21587626],
             [1084.39068604]],

            [[ 421.48088328],
             [ 420.21653112]]],


           [[[1085.91406323],
             [1083.25480725]],

            [[ 421.67755381],
             [ 422.10508746]]],


           [[[1085.62648446],
             [1082.09089007]],

            [[ 421.90293339],
             [ 423.7017152 ]]],

    ...

           [[[   0.        ],
             [   0.        ]],

            [[   0.        ],
             [   0.        ]]],


           [[[   0.        ],
             [   0.        ]],

            [[   0.        ],
             [   0.        ]]],


           [[[   0.        ],
             [   0.        ]],

            [[   0.        ],
             [   0.        ]]]], shape=(1085, 2, 2, 1))</pre></div></li><li class='xr-var-item'><div class='xr-var-name'><span>confidence</span></div><div class='xr-var-dims'>(time, keypoints, individuals)</div><div class='xr-var-dtype'>float64</div><div class='xr-var-preview xr-preview'>0.05305 0.07366 0.03532 ... 0.0 0.0</div><input id='attrs-7278f2e8-d6dc-4d0b-9b67-8d2bd5263adb' class='xr-var-attrs-in' type='checkbox' disabled><label for='attrs-7278f2e8-d6dc-4d0b-9b67-8d2bd5263adb' title='Show/Hide attributes'><svg class='icon xr-icon-file-text2'><use xlink:href='#icon-file-text2'></use></svg></label><input id='data-8c236d80-1588-4761-ae6f-a62670d2bc83' class='xr-var-data-in' type='checkbox'><label for='data-8c236d80-1588-4761-ae6f-a62670d2bc83' title='Show/Hide data repr'><svg class='icon xr-icon-database'><use xlink:href='#icon-database'></use></svg></label><div class='xr-var-attrs'><dl class='xr-attrs'></dl></div><div class='xr-var-data'><pre>array([[[0.05305099],
            [0.07366323]],

           [[0.03531652],
            [0.03293059]],

           [[0.01706707],
            [0.01022208]],

           ...,

           [[0.        ],
            [0.        ]],

           [[0.        ],
            [0.        ]],

           [[0.        ],
            [0.        ]]], shape=(1085, 2, 1))</pre></div></li></ul></div></li><li class='xr-section-item'><input id='section-3c939fb9-2dc0-4491-9c61-542fa7c2cf0d' class='xr-section-summary-in' type='checkbox'  ><label for='section-3c939fb9-2dc0-4491-9c61-542fa7c2cf0d' class='xr-section-summary' >Indexes: <span>(4)</span></label><div class='xr-section-inline-details'></div><div class='xr-section-details'><ul class='xr-var-list'><li class='xr-var-item'><div class='xr-index-name'><div>time</div></div><div class='xr-index-preview'>PandasIndex</div><input type='checkbox' disabled/><label></label><input id='index-d9bda9eb-99ed-482a-84bb-82001fc253e1' class='xr-index-data-in' type='checkbox'/><label for='index-d9bda9eb-99ed-482a-84bb-82001fc253e1' title='Show/Hide index repr'><svg class='icon xr-icon-database'><use xlink:href='#icon-database'></use></svg></label><div class='xr-index-data'><pre>PandasIndex(Index([   0.0,  0.025,   0.05,  0.075,    0.1,  0.125,   0.15,  0.175,    0.2,
            0.225,
           ...
           26.875,   26.9, 26.925,  26.95, 26.975,   27.0, 27.025,  27.05, 27.075,
             27.1],
          dtype=&#x27;float64&#x27;, name=&#x27;time&#x27;, length=1085))</pre></div></li><li class='xr-var-item'><div class='xr-index-name'><div>space</div></div><div class='xr-index-preview'>PandasIndex</div><input type='checkbox' disabled/><label></label><input id='index-45b9b2c4-4d9e-46c4-af4d-3a7ebae1b0f1' class='xr-index-data-in' type='checkbox'/><label for='index-45b9b2c4-4d9e-46c4-af4d-3a7ebae1b0f1' title='Show/Hide index repr'><svg class='icon xr-icon-database'><use xlink:href='#icon-database'></use></svg></label><div class='xr-index-data'><pre>PandasIndex(Index([&#x27;x&#x27;, &#x27;y&#x27;], dtype=&#x27;object&#x27;, name=&#x27;space&#x27;))</pre></div></li><li class='xr-var-item'><div class='xr-index-name'><div>keypoints</div></div><div class='xr-index-preview'>PandasIndex</div><input type='checkbox' disabled/><label></label><input id='index-854051b1-2ed6-4a4c-892b-9b846ca99070' class='xr-index-data-in' type='checkbox'/><label for='index-854051b1-2ed6-4a4c-892b-9b846ca99070' title='Show/Hide index repr'><svg class='icon xr-icon-database'><use xlink:href='#icon-database'></use></svg></label><div class='xr-index-data'><pre>PandasIndex(Index([&#x27;head&#x27;, &#x27;stinger&#x27;], dtype=&#x27;object&#x27;, name=&#x27;keypoints&#x27;))</pre></div></li><li class='xr-var-item'><div class='xr-index-name'><div>individuals</div></div><div class='xr-index-preview'>PandasIndex</div><input type='checkbox' disabled/><label></label><input id='index-e19412fc-751b-40e5-b7ea-fb9e42c2a357' class='xr-index-data-in' type='checkbox'/><label for='index-e19412fc-751b-40e5-b7ea-fb9e42c2a357' title='Show/Hide index repr'><svg class='icon xr-icon-database'><use xlink:href='#icon-database'></use></svg></label><div class='xr-index-data'><pre>PandasIndex(Index([&#x27;individual_0&#x27;], dtype=&#x27;object&#x27;, name=&#x27;individuals&#x27;))</pre></div></li></ul></div></li><li class='xr-section-item'><input id='section-5696110d-448b-43aa-aad6-c0d181c4a48e' class='xr-section-summary-in' type='checkbox'  checked><label for='section-5696110d-448b-43aa-aad6-c0d181c4a48e' class='xr-section-summary' >Attributes: <span>(6)</span></label><div class='xr-section-inline-details'></div><div class='xr-section-details'><dl class='xr-attrs'><dt><span>source_software :</span></dt><dd>DeepLabCut</dd><dt><span>ds_type :</span></dt><dd>poses</dd><dt><span>fps :</span></dt><dd>40.0</dd><dt><span>time_unit :</span></dt><dd>seconds</dd><dt><span>source_file :</span></dt><dd>/home/runner/.movement/data/poses/DLC_single-wasp.predictions.h5</dd><dt><span>frame_path :</span></dt><dd>/home/runner/.movement/data/frames/single-wasp_frame-10sec.png</dd></dl></div></li></ul></div></div>
    </div>
    <br />
    <br />

.. GENERATED FROM PYTHON SOURCE LINES 316-319

.. code-block:: Python

    plot_raw_and_smooth_timeseries_and_psd(
        ds_wasp, ds_wasp_smooth, keypoint="stinger"
    )



.. image-sg:: /examples/images/sphx_glr_smooth_005.png
   :alt: Time Domain, Frequency Domain
   :srcset: /examples/images/sphx_glr_smooth_005.png
   :class: sphx-glr-single-img





.. GENERATED FROM PYTHON SOURCE LINES 320-328

This example shows two important limitations of the Savitzky-Golay filter.
First, the filter can introduce artefacts around sharp boundaries. For
example, focus on what happens around the sudden drop in position
during the final second. Second, the PSD appears to have large periodic
drops at certain frequencies. Both of these effects vary with the
choice of ``window`` and ``polyorder``. You can read more about these
and other limitations of the Savitzky-Golay filter in
`this paper <https://pubs.acs.org/doi/10.1021/acsmeasuresciau.1c00054>`_.

.. GENERATED FROM PYTHON SOURCE LINES 331-339

Combining multiple smoothing filters
------------------------------------
We can also combine multiple smoothing filters by applying them
sequentially. For example, we can first apply the rolling median filter with
a small ``window`` to remove "spikes" and then apply the Savitzky-Golay
filter with a larger ``window`` to further smooth the data.
Between the two filters, we can interpolate over small gaps to avoid the
excessive proliferation of NaN values. Let's try this on the mouse dataset.

.. GENERATED FROM PYTHON SOURCE LINES 339-363

.. code-block:: Python


    # First, we will apply the rolling median filter.
    window = int(0.1 * ds_mouse.fps)
    ds_mouse_smooth.update(
        {
            "position": rolling_filter(
                ds_mouse.position, window, min_periods=2, statistic="median"
            )
        }
    )

    # Next, let's linearly interpolate over gaps smaller
    # than 1 second (30 frames).
    ds_mouse_smooth.update(
        {"position": interpolate_over_time(ds_mouse_smooth.position, max_gap=30)}
    )

    # Finally, let's apply the Savitzky-Golay filter
    # over a 0.4-second window (12 frames).
    window = int(0.4 * ds_mouse.fps)
    ds_mouse_smooth.update(
        {"position": savgol_filter(ds_mouse_smooth.position, window)}
    )






.. raw:: html

    <div class="output_subarea output_html rendered_html output_result">
    <div><svg style="position: absolute; width: 0; height: 0; overflow: hidden">
    <defs>
    <symbol id="icon-database" viewBox="0 0 32 32">
    <path d="M16 0c-8.837 0-16 2.239-16 5v4c0 2.761 7.163 5 16 5s16-2.239 16-5v-4c0-2.761-7.163-5-16-5z"></path>
    <path d="M16 17c-8.837 0-16-2.239-16-5v6c0 2.761 7.163 5 16 5s16-2.239 16-5v-6c0 2.761-7.163 5-16 5z"></path>
    <path d="M16 26c-8.837 0-16-2.239-16-5v6c0 2.761 7.163 5 16 5s16-2.239 16-5v-6c0 2.761-7.163 5-16 5z"></path>
    </symbol>
    <symbol id="icon-file-text2" viewBox="0 0 32 32">
    <path d="M28.681 7.159c-0.694-0.947-1.662-2.053-2.724-3.116s-2.169-2.030-3.116-2.724c-1.612-1.182-2.393-1.319-2.841-1.319h-15.5c-1.378 0-2.5 1.121-2.5 2.5v27c0 1.378 1.122 2.5 2.5 2.5h23c1.378 0 2.5-1.122 2.5-2.5v-19.5c0-0.448-0.137-1.23-1.319-2.841zM24.543 5.457c0.959 0.959 1.712 1.825 2.268 2.543h-4.811v-4.811c0.718 0.556 1.584 1.309 2.543 2.268zM28 29.5c0 0.271-0.229 0.5-0.5 0.5h-23c-0.271 0-0.5-0.229-0.5-0.5v-27c0-0.271 0.229-0.5 0.5-0.5 0 0 15.499-0 15.5 0v7c0 0.552 0.448 1 1 1h7v19.5z"></path>
    <path d="M23 26h-14c-0.552 0-1-0.448-1-1s0.448-1 1-1h14c0.552 0 1 0.448 1 1s-0.448 1-1 1z"></path>
    <path d="M23 22h-14c-0.552 0-1-0.448-1-1s0.448-1 1-1h14c0.552 0 1 0.448 1 1s-0.448 1-1 1z"></path>
    <path d="M23 18h-14c-0.552 0-1-0.448-1-1s0.448-1 1-1h14c0.552 0 1 0.448 1 1s-0.448 1-1 1z"></path>
    </symbol>
    </defs>
    </svg>
    <style>/* CSS stylesheet for displaying xarray objects in jupyterlab.
     *
     */

    :root {
      --xr-font-color0: var(
        --jp-content-font-color0,
        var(--pst-color-text-base rgba(0, 0, 0, 1))
      );
      --xr-font-color2: var(
        --jp-content-font-color2,
        var(--pst-color-text-base, rgba(0, 0, 0, 0.54))
      );
      --xr-font-color3: var(
        --jp-content-font-color3,
        var(--pst-color-text-base, rgba(0, 0, 0, 0.38))
      );
      --xr-border-color: var(
        --jp-border-color2,
        hsl(from var(--pst-color-on-background, white) h s calc(l - 10))
      );
      --xr-disabled-color: var(
        --jp-layout-color3,
        hsl(from var(--pst-color-on-background, white) h s calc(l - 40))
      );
      --xr-background-color: var(
        --jp-layout-color0,
        var(--pst-color-on-background, white)
      );
      --xr-background-color-row-even: var(
        --jp-layout-color1,
        hsl(from var(--pst-color-on-background, white) h s calc(l - 5))
      );
      --xr-background-color-row-odd: var(
        --jp-layout-color2,
        hsl(from var(--pst-color-on-background, white) h s calc(l - 15))
      );
    }

    html[theme="dark"],
    html[data-theme="dark"],
    body[data-theme="dark"],
    body.vscode-dark {
      --xr-font-color0: var(
        --jp-content-font-color0,
        var(--pst-color-text-base, rgba(255, 255, 255, 1))
      );
      --xr-font-color2: var(
        --jp-content-font-color2,
        var(--pst-color-text-base, rgba(255, 255, 255, 0.54))
      );
      --xr-font-color3: var(
        --jp-content-font-color3,
        var(--pst-color-text-base, rgba(255, 255, 255, 0.38))
      );
      --xr-border-color: var(
        --jp-border-color2,
        hsl(from var(--pst-color-on-background, #111111) h s calc(l + 10))
      );
      --xr-disabled-color: var(
        --jp-layout-color3,
        hsl(from var(--pst-color-on-background, #111111) h s calc(l + 40))
      );
      --xr-background-color: var(
        --jp-layout-color0,
        var(--pst-color-on-background, #111111)
      );
      --xr-background-color-row-even: var(
        --jp-layout-color1,
        hsl(from var(--pst-color-on-background, #111111) h s calc(l + 5))
      );
      --xr-background-color-row-odd: var(
        --jp-layout-color2,
        hsl(from var(--pst-color-on-background, #111111) h s calc(l + 15))
      );
    }

    .xr-wrap {
      display: block !important;
      min-width: 300px;
      max-width: 700px;
    }

    .xr-text-repr-fallback {
      /* fallback to plain text repr when CSS is not injected (untrusted notebook) */
      display: none;
    }

    .xr-header {
      padding-top: 6px;
      padding-bottom: 6px;
      margin-bottom: 4px;
      border-bottom: solid 1px var(--xr-border-color);
    }

    .xr-header > div,
    .xr-header > ul {
      display: inline;
      margin-top: 0;
      margin-bottom: 0;
    }

    .xr-obj-type,
    .xr-array-name {
      margin-left: 2px;
      margin-right: 10px;
    }

    .xr-obj-type {
      color: var(--xr-font-color2);
    }

    .xr-sections {
      padding-left: 0 !important;
      display: grid;
      grid-template-columns: 150px auto auto 1fr 0 20px 0 20px;
    }

    .xr-section-item {
      display: contents;
    }

    .xr-section-item input {
      display: inline-block;
      opacity: 0;
      height: 0;
    }

    .xr-section-item input + label {
      color: var(--xr-disabled-color);
      border: 2px solid transparent !important;
    }

    .xr-section-item input:enabled + label {
      cursor: pointer;
      color: var(--xr-font-color2);
    }

    .xr-section-item input:focus + label {
      border: 2px solid var(--xr-font-color0) !important;
    }

    .xr-section-item input:enabled + label:hover {
      color: var(--xr-font-color0);
    }

    .xr-section-summary {
      grid-column: 1;
      color: var(--xr-font-color2);
      font-weight: 500;
    }

    .xr-section-summary > span {
      display: inline-block;
      padding-left: 0.5em;
    }

    .xr-section-summary-in:disabled + label {
      color: var(--xr-font-color2);
    }

    .xr-section-summary-in + label:before {
      display: inline-block;
      content: "►";
      font-size: 11px;
      width: 15px;
      text-align: center;
    }

    .xr-section-summary-in:disabled + label:before {
      color: var(--xr-disabled-color);
    }

    .xr-section-summary-in:checked + label:before {
      content: "▼";
    }

    .xr-section-summary-in:checked + label > span {
      display: none;
    }

    .xr-section-summary,
    .xr-section-inline-details {
      padding-top: 4px;
      padding-bottom: 4px;
    }

    .xr-section-inline-details {
      grid-column: 2 / -1;
    }

    .xr-section-details {
      display: none;
      grid-column: 1 / -1;
      margin-bottom: 5px;
    }

    .xr-section-summary-in:checked ~ .xr-section-details {
      display: contents;
    }

    .xr-array-wrap {
      grid-column: 1 / -1;
      display: grid;
      grid-template-columns: 20px auto;
    }

    .xr-array-wrap > label {
      grid-column: 1;
      vertical-align: top;
    }

    .xr-preview {
      color: var(--xr-font-color3);
    }

    .xr-array-preview,
    .xr-array-data {
      padding: 0 5px !important;
      grid-column: 2;
    }

    .xr-array-data,
    .xr-array-in:checked ~ .xr-array-preview {
      display: none;
    }

    .xr-array-in:checked ~ .xr-array-data,
    .xr-array-preview {
      display: inline-block;
    }

    .xr-dim-list {
      display: inline-block !important;
      list-style: none;
      padding: 0 !important;
      margin: 0;
    }

    .xr-dim-list li {
      display: inline-block;
      padding: 0;
      margin: 0;
    }

    .xr-dim-list:before {
      content: "(";
    }

    .xr-dim-list:after {
      content: ")";
    }

    .xr-dim-list li:not(:last-child):after {
      content: ",";
      padding-right: 5px;
    }

    .xr-has-index {
      font-weight: bold;
    }

    .xr-var-list,
    .xr-var-item {
      display: contents;
    }

    .xr-var-item > div,
    .xr-var-item label,
    .xr-var-item > .xr-var-name span {
      background-color: var(--xr-background-color-row-even);
      border-color: var(--xr-background-color-row-odd);
      margin-bottom: 0;
      padding-top: 2px;
    }

    .xr-var-item > .xr-var-name:hover span {
      padding-right: 5px;
    }

    .xr-var-list > li:nth-child(odd) > div,
    .xr-var-list > li:nth-child(odd) > label,
    .xr-var-list > li:nth-child(odd) > .xr-var-name span {
      background-color: var(--xr-background-color-row-odd);
      border-color: var(--xr-background-color-row-even);
    }

    .xr-var-name {
      grid-column: 1;
    }

    .xr-var-dims {
      grid-column: 2;
    }

    .xr-var-dtype {
      grid-column: 3;
      text-align: right;
      color: var(--xr-font-color2);
    }

    .xr-var-preview {
      grid-column: 4;
    }

    .xr-index-preview {
      grid-column: 2 / 5;
      color: var(--xr-font-color2);
    }

    .xr-var-name,
    .xr-var-dims,
    .xr-var-dtype,
    .xr-preview,
    .xr-attrs dt {
      white-space: nowrap;
      overflow: hidden;
      text-overflow: ellipsis;
      padding-right: 10px;
    }

    .xr-var-name:hover,
    .xr-var-dims:hover,
    .xr-var-dtype:hover,
    .xr-attrs dt:hover {
      overflow: visible;
      width: auto;
      z-index: 1;
    }

    .xr-var-attrs,
    .xr-var-data,
    .xr-index-data {
      display: none;
      border-top: 2px dotted var(--xr-background-color);
      padding-bottom: 20px !important;
      padding-top: 10px !important;
    }

    .xr-var-attrs-in + label,
    .xr-var-data-in + label,
    .xr-index-data-in + label {
      padding: 0 1px;
    }

    .xr-var-attrs-in:checked ~ .xr-var-attrs,
    .xr-var-data-in:checked ~ .xr-var-data,
    .xr-index-data-in:checked ~ .xr-index-data {
      display: block;
    }

    .xr-var-data > table {
      float: right;
    }

    .xr-var-data > pre,
    .xr-index-data > pre,
    .xr-var-data > table > tbody > tr {
      background-color: transparent !important;
    }

    .xr-var-name span,
    .xr-var-data,
    .xr-index-name div,
    .xr-index-data,
    .xr-attrs {
      padding-left: 25px !important;
    }

    .xr-attrs,
    .xr-var-attrs,
    .xr-var-data,
    .xr-index-data {
      grid-column: 1 / -1;
    }

    dl.xr-attrs {
      padding: 0;
      margin: 0;
      display: grid;
      grid-template-columns: 125px auto;
    }

    .xr-attrs dt,
    .xr-attrs dd {
      padding: 0;
      margin: 0;
      float: left;
      padding-right: 10px;
      width: auto;
    }

    .xr-attrs dt {
      font-weight: normal;
      grid-column: 1;
    }

    .xr-attrs dt:hover span {
      display: inline-block;
      background: var(--xr-background-color);
      padding-right: 10px;
    }

    .xr-attrs dd {
      grid-column: 2;
      white-space: pre-wrap;
      word-break: break-all;
    }

    .xr-icon-database,
    .xr-icon-file-text2,
    .xr-no-icon {
      display: inline-block;
      vertical-align: middle;
      width: 1em;
      height: 1.5em !important;
      stroke-width: 0;
      stroke: currentColor;
      fill: currentColor;
    }

    .xr-var-attrs-in:checked + label > .xr-icon-file-text2,
    .xr-var-data-in:checked + label > .xr-icon-database,
    .xr-index-data-in:checked + label > .xr-icon-database {
      color: var(--xr-font-color0);
      filter: drop-shadow(1px 1px 5px var(--xr-font-color2));
      stroke-width: 0.8px;
    }
    </style><pre class='xr-text-repr-fallback'>&lt;xarray.Dataset&gt; Size: 1MB
    Dimensions:      (time: 18485, space: 2, keypoints: 6, individuals: 1)
    Coordinates:
      * time         (time) float64 148kB 0.0 0.03333 0.06667 ... 616.1 616.1 616.1
      * space        (space) &lt;U1 8B &#x27;x&#x27; &#x27;y&#x27;
      * keypoints    (keypoints) &lt;U9 216B &#x27;snout&#x27; &#x27;left_ear&#x27; ... &#x27;tail_end&#x27;
      * individuals  (individuals) &lt;U4 16B &#x27;id_0&#x27;
    Data variables:
        position     (time, space, keypoints, individuals) float32 887kB nan ... ...
        confidence   (time, keypoints, individuals) float32 444kB nan nan ... 0.7607
    Attributes:
        source_software:  SLEAP
        ds_type:          poses
        fps:              30.0
        time_unit:        seconds
        source_file:      /home/runner/.movement/data/poses/SLEAP_single-mouse_EP...
        frame_path:       /home/runner/.movement/data/frames/single-mouse_EPM_fra...</pre><div class='xr-wrap' style='display:none'><div class='xr-header'><div class='xr-obj-type'>xarray.Dataset</div></div><ul class='xr-sections'><li class='xr-section-item'><input id='section-c3592924-92c4-4797-874d-57eb460fc754' class='xr-section-summary-in' type='checkbox' disabled ><label for='section-c3592924-92c4-4797-874d-57eb460fc754' class='xr-section-summary'  title='Expand/collapse section'>Dimensions:</label><div class='xr-section-inline-details'><ul class='xr-dim-list'><li><span class='xr-has-index'>time</span>: 18485</li><li><span class='xr-has-index'>space</span>: 2</li><li><span class='xr-has-index'>keypoints</span>: 6</li><li><span class='xr-has-index'>individuals</span>: 1</li></ul></div><div class='xr-section-details'></div></li><li class='xr-section-item'><input id='section-20bec524-613d-4049-b278-812239e767bf' class='xr-section-summary-in' type='checkbox'  checked><label for='section-20bec524-613d-4049-b278-812239e767bf' class='xr-section-summary' >Coordinates: <span>(4)</span></label><div class='xr-section-inline-details'></div><div class='xr-section-details'><ul class='xr-var-list'><li class='xr-var-item'><div class='xr-var-name'><span class='xr-has-index'>time</span></div><div class='xr-var-dims'>(time)</div><div class='xr-var-dtype'>float64</div><div class='xr-var-preview xr-preview'>0.0 0.03333 0.06667 ... 616.1 616.1</div><input id='attrs-4ac0d6c1-0793-4cba-9d6b-678c90a11971' class='xr-var-attrs-in' type='checkbox' disabled><label for='attrs-4ac0d6c1-0793-4cba-9d6b-678c90a11971' title='Show/Hide attributes'><svg class='icon xr-icon-file-text2'><use xlink:href='#icon-file-text2'></use></svg></label><input id='data-a6637ec4-27f5-48a0-9e20-2ceb07d522b6' class='xr-var-data-in' type='checkbox'><label for='data-a6637ec4-27f5-48a0-9e20-2ceb07d522b6' title='Show/Hide data repr'><svg class='icon xr-icon-database'><use xlink:href='#icon-database'></use></svg></label><div class='xr-var-attrs'><dl class='xr-attrs'></dl></div><div class='xr-var-data'><pre>array([0.000000e+00, 3.333333e-02, 6.666667e-02, ..., 6.160667e+02,
           6.161000e+02, 6.161333e+02], shape=(18485,))</pre></div></li><li class='xr-var-item'><div class='xr-var-name'><span class='xr-has-index'>space</span></div><div class='xr-var-dims'>(space)</div><div class='xr-var-dtype'>&lt;U1</div><div class='xr-var-preview xr-preview'>&#x27;x&#x27; &#x27;y&#x27;</div><input id='attrs-7ccc2f9a-70bb-4267-a750-9a5c189613cb' class='xr-var-attrs-in' type='checkbox' disabled><label for='attrs-7ccc2f9a-70bb-4267-a750-9a5c189613cb' title='Show/Hide attributes'><svg class='icon xr-icon-file-text2'><use xlink:href='#icon-file-text2'></use></svg></label><input id='data-506fa191-88a5-4ff5-9677-9bfb088e4535' class='xr-var-data-in' type='checkbox'><label for='data-506fa191-88a5-4ff5-9677-9bfb088e4535' title='Show/Hide data repr'><svg class='icon xr-icon-database'><use xlink:href='#icon-database'></use></svg></label><div class='xr-var-attrs'><dl class='xr-attrs'></dl></div><div class='xr-var-data'><pre>array([&#x27;x&#x27;, &#x27;y&#x27;], dtype=&#x27;&lt;U1&#x27;)</pre></div></li><li class='xr-var-item'><div class='xr-var-name'><span class='xr-has-index'>keypoints</span></div><div class='xr-var-dims'>(keypoints)</div><div class='xr-var-dtype'>&lt;U9</div><div class='xr-var-preview xr-preview'>&#x27;snout&#x27; &#x27;left_ear&#x27; ... &#x27;tail_end&#x27;</div><input id='attrs-85ea71c4-48a8-478c-afea-f2aada59f9ee' class='xr-var-attrs-in' type='checkbox' disabled><label for='attrs-85ea71c4-48a8-478c-afea-f2aada59f9ee' title='Show/Hide attributes'><svg class='icon xr-icon-file-text2'><use xlink:href='#icon-file-text2'></use></svg></label><input id='data-1cf38014-c10e-4c56-a6f7-7ad64d0855fc' class='xr-var-data-in' type='checkbox'><label for='data-1cf38014-c10e-4c56-a6f7-7ad64d0855fc' title='Show/Hide data repr'><svg class='icon xr-icon-database'><use xlink:href='#icon-database'></use></svg></label><div class='xr-var-attrs'><dl class='xr-attrs'></dl></div><div class='xr-var-data'><pre>array([&#x27;snout&#x27;, &#x27;left_ear&#x27;, &#x27;right_ear&#x27;, &#x27;centre&#x27;, &#x27;tail_base&#x27;, &#x27;tail_end&#x27;],
          dtype=&#x27;&lt;U9&#x27;)</pre></div></li><li class='xr-var-item'><div class='xr-var-name'><span class='xr-has-index'>individuals</span></div><div class='xr-var-dims'>(individuals)</div><div class='xr-var-dtype'>&lt;U4</div><div class='xr-var-preview xr-preview'>&#x27;id_0&#x27;</div><input id='attrs-1b72ee56-898b-4977-9ce2-5938703f2a23' class='xr-var-attrs-in' type='checkbox' disabled><label for='attrs-1b72ee56-898b-4977-9ce2-5938703f2a23' title='Show/Hide attributes'><svg class='icon xr-icon-file-text2'><use xlink:href='#icon-file-text2'></use></svg></label><input id='data-f374d320-1ff7-4609-9941-dc6c3497c4aa' class='xr-var-data-in' type='checkbox'><label for='data-f374d320-1ff7-4609-9941-dc6c3497c4aa' title='Show/Hide data repr'><svg class='icon xr-icon-database'><use xlink:href='#icon-database'></use></svg></label><div class='xr-var-attrs'><dl class='xr-attrs'></dl></div><div class='xr-var-data'><pre>array([&#x27;id_0&#x27;], dtype=&#x27;&lt;U4&#x27;)</pre></div></li></ul></div></li><li class='xr-section-item'><input id='section-0b0c034d-498d-444f-b816-2564b1d1ad43' class='xr-section-summary-in' type='checkbox'  checked><label for='section-0b0c034d-498d-444f-b816-2564b1d1ad43' class='xr-section-summary' >Data variables: <span>(2)</span></label><div class='xr-section-inline-details'></div><div class='xr-section-details'><ul class='xr-var-list'><li class='xr-var-item'><div class='xr-var-name'><span>position</span></div><div class='xr-var-dims'>(time, space, keypoints, individuals)</div><div class='xr-var-dtype'>float32</div><div class='xr-var-preview xr-preview'>nan nan nan ... 439.8 384.9 476.4</div><input id='attrs-6f50ec8a-039f-4eb3-9334-ad2f269ac11b' class='xr-var-attrs-in' type='checkbox' ><label for='attrs-6f50ec8a-039f-4eb3-9334-ad2f269ac11b' title='Show/Hide attributes'><svg class='icon xr-icon-file-text2'><use xlink:href='#icon-file-text2'></use></svg></label><input id='data-59021605-741b-4980-ab33-db959c9a39bb' class='xr-var-data-in' type='checkbox'><label for='data-59021605-741b-4980-ab33-db959c9a39bb' title='Show/Hide data repr'><svg class='icon xr-icon-database'><use xlink:href='#icon-database'></use></svg></label><div class='xr-var-attrs'><dl class='xr-attrs'><dt><span>log :</span></dt><dd>[
      {
        &quot;operation&quot;: &quot;rolling_filter&quot;,
        &quot;datetime&quot;: &quot;2025-07-22 16:47:40.705019&quot;,
        &quot;window&quot;: &quot;3&quot;,
        &quot;statistic&quot;: &quot;&#x27;median&#x27;&quot;,
        &quot;min_periods&quot;: &quot;2&quot;,
        &quot;print_report&quot;: &quot;False&quot;
      },
      {
        &quot;operation&quot;: &quot;interpolate_over_time&quot;,
        &quot;datetime&quot;: &quot;2025-07-22 16:47:40.729290&quot;,
        &quot;method&quot;: &quot;&#x27;linear&#x27;&quot;,
        &quot;max_gap&quot;: &quot;30&quot;,
        &quot;print_report&quot;: &quot;False&quot;
      },
      {
        &quot;operation&quot;: &quot;savgol_filter&quot;,
        &quot;datetime&quot;: &quot;2025-07-22 16:47:40.733094&quot;,
        &quot;window&quot;: &quot;12&quot;,
        &quot;polyorder&quot;: &quot;2&quot;,
        &quot;print_report&quot;: &quot;False&quot;
      }
    ]</dd></dl></div><div class='xr-var-data'><pre>array([[[[      nan],
             [      nan],
             [      nan],
             [      nan],
             [      nan],
             [      nan]],

            [[      nan],
             [      nan],
             [      nan],
             [      nan],
             [      nan],
             [      nan]]],


           [[[      nan],
             [      nan],
             [      nan],
             [      nan],
             [      nan],
    ...
             [484.99295],
             [491.70206],
             [439.1004 ],
             [384.04898],
             [476.4877 ]]],


           [[[687.1241 ],
             [691.6779 ],
             [667.5868 ],
             [667.8876 ],
             [636.8564 ],
             [588.4856 ]],

            [[507.36728],
             [485.9541 ],
             [492.4988 ],
             [439.8272 ],
             [384.89087],
             [476.4103 ]]]], shape=(18485, 2, 6, 1), dtype=float32)</pre></div></li><li class='xr-var-item'><div class='xr-var-name'><span>confidence</span></div><div class='xr-var-dims'>(time, keypoints, individuals)</div><div class='xr-var-dtype'>float32</div><div class='xr-var-preview xr-preview'>nan nan nan ... 0.9336 0.7607</div><input id='attrs-bf1b2895-e50f-4462-ba63-5de78e721aad' class='xr-var-attrs-in' type='checkbox' disabled><label for='attrs-bf1b2895-e50f-4462-ba63-5de78e721aad' title='Show/Hide attributes'><svg class='icon xr-icon-file-text2'><use xlink:href='#icon-file-text2'></use></svg></label><input id='data-ad8adb01-0d1e-4238-9ce1-daf040f3fc58' class='xr-var-data-in' type='checkbox'><label for='data-ad8adb01-0d1e-4238-9ce1-daf040f3fc58' title='Show/Hide data repr'><svg class='icon xr-icon-database'><use xlink:href='#icon-database'></use></svg></label><div class='xr-var-attrs'><dl class='xr-attrs'></dl></div><div class='xr-var-data'><pre>array([[[       nan],
            [       nan],
            [       nan],
            [       nan],
            [       nan],
            [       nan]],

           [[       nan],
            [       nan],
            [       nan],
            [       nan],
            [       nan],
            [       nan]],

           [[       nan],
            [       nan],
            [       nan],
            [       nan],
            [       nan],
            [       nan]],
    ...
           [[0.9317396 ],
            [1.0026728 ],
            [1.025079  ],
            [0.92725545],
            [0.95202184],
            [0.7779419 ]],

           [[0.9193515 ],
            [1.0136327 ],
            [1.0336665 ],
            [0.93108493],
            [0.94561106],
            [0.7662804 ]],

           [[0.93820494],
            [1.0224991 ],
            [1.0452943 ],
            [0.9363993 ],
            [0.9335798 ],
            [0.76068705]]], shape=(18485, 6, 1), dtype=float32)</pre></div></li></ul></div></li><li class='xr-section-item'><input id='section-c900ea6d-ffcd-4198-b04e-eb3f211821db' class='xr-section-summary-in' type='checkbox'  ><label for='section-c900ea6d-ffcd-4198-b04e-eb3f211821db' class='xr-section-summary' >Indexes: <span>(4)</span></label><div class='xr-section-inline-details'></div><div class='xr-section-details'><ul class='xr-var-list'><li class='xr-var-item'><div class='xr-index-name'><div>time</div></div><div class='xr-index-preview'>PandasIndex</div><input type='checkbox' disabled/><label></label><input id='index-9cb306c2-4bcd-43bf-a085-4983533d9133' class='xr-index-data-in' type='checkbox'/><label for='index-9cb306c2-4bcd-43bf-a085-4983533d9133' title='Show/Hide index repr'><svg class='icon xr-icon-database'><use xlink:href='#icon-database'></use></svg></label><div class='xr-index-data'><pre>PandasIndex(Index([                0.0, 0.03333333333333333, 0.06666666666666667,
                           0.1, 0.13333333333333333, 0.16666666666666666,
                           0.2, 0.23333333333333334, 0.26666666666666666,
                           0.3,
           ...
             615.8333333333334,   615.8666666666667,               615.9,
             615.9333333333333,   615.9666666666667,               616.0,
             616.0333333333333,   616.0666666666667,               616.1,
             616.1333333333333],
          dtype=&#x27;float64&#x27;, name=&#x27;time&#x27;, length=18485))</pre></div></li><li class='xr-var-item'><div class='xr-index-name'><div>space</div></div><div class='xr-index-preview'>PandasIndex</div><input type='checkbox' disabled/><label></label><input id='index-e7b3a906-cd63-4458-9a60-ef87cbb49dad' class='xr-index-data-in' type='checkbox'/><label for='index-e7b3a906-cd63-4458-9a60-ef87cbb49dad' title='Show/Hide index repr'><svg class='icon xr-icon-database'><use xlink:href='#icon-database'></use></svg></label><div class='xr-index-data'><pre>PandasIndex(Index([&#x27;x&#x27;, &#x27;y&#x27;], dtype=&#x27;object&#x27;, name=&#x27;space&#x27;))</pre></div></li><li class='xr-var-item'><div class='xr-index-name'><div>keypoints</div></div><div class='xr-index-preview'>PandasIndex</div><input type='checkbox' disabled/><label></label><input id='index-1a1f08d4-a81e-49eb-b8b5-1219b77ab4a2' class='xr-index-data-in' type='checkbox'/><label for='index-1a1f08d4-a81e-49eb-b8b5-1219b77ab4a2' title='Show/Hide index repr'><svg class='icon xr-icon-database'><use xlink:href='#icon-database'></use></svg></label><div class='xr-index-data'><pre>PandasIndex(Index([&#x27;snout&#x27;, &#x27;left_ear&#x27;, &#x27;right_ear&#x27;, &#x27;centre&#x27;, &#x27;tail_base&#x27;, &#x27;tail_end&#x27;], dtype=&#x27;object&#x27;, name=&#x27;keypoints&#x27;))</pre></div></li><li class='xr-var-item'><div class='xr-index-name'><div>individuals</div></div><div class='xr-index-preview'>PandasIndex</div><input type='checkbox' disabled/><label></label><input id='index-4c929d28-219c-463f-a3fc-a7de13a7b507' class='xr-index-data-in' type='checkbox'/><label for='index-4c929d28-219c-463f-a3fc-a7de13a7b507' title='Show/Hide index repr'><svg class='icon xr-icon-database'><use xlink:href='#icon-database'></use></svg></label><div class='xr-index-data'><pre>PandasIndex(Index([&#x27;id_0&#x27;], dtype=&#x27;object&#x27;, name=&#x27;individuals&#x27;))</pre></div></li></ul></div></li><li class='xr-section-item'><input id='section-d271f297-e259-408a-b71b-36fe9a685dbd' class='xr-section-summary-in' type='checkbox'  checked><label for='section-d271f297-e259-408a-b71b-36fe9a685dbd' class='xr-section-summary' >Attributes: <span>(6)</span></label><div class='xr-section-inline-details'></div><div class='xr-section-details'><dl class='xr-attrs'><dt><span>source_software :</span></dt><dd>SLEAP</dd><dt><span>ds_type :</span></dt><dd>poses</dd><dt><span>fps :</span></dt><dd>30.0</dd><dt><span>time_unit :</span></dt><dd>seconds</dd><dt><span>source_file :</span></dt><dd>/home/runner/.movement/data/poses/SLEAP_single-mouse_EPM.analysis.h5</dd><dt><span>frame_path :</span></dt><dd>/home/runner/.movement/data/frames/single-mouse_EPM_frame-20sec.png</dd></dl></div></li></ul></div></div>
    </div>
    <br />
    <br />

.. GENERATED FROM PYTHON SOURCE LINES 364-367

A record of all applied operations is stored in the ``log`` attribute of the
``ds_mouse_smooth.position`` data array. Let's inspect it to summarise
what we've done.

.. GENERATED FROM PYTHON SOURCE LINES 367-370

.. code-block:: Python


    print(ds_mouse_smooth.position.log)





.. rst-class:: sphx-glr-script-out

 .. code-block:: none

    [
      {
        "operation": "rolling_filter",
        "datetime": "2025-07-22 16:47:40.705019",
        "window": "3",
        "statistic": "'median'",
        "min_periods": "2",
        "print_report": "False"
      },
      {
        "operation": "interpolate_over_time",
        "datetime": "2025-07-22 16:47:40.729290",
        "method": "'linear'",
        "max_gap": "30",
        "print_report": "False"
      },
      {
        "operation": "savgol_filter",
        "datetime": "2025-07-22 16:47:40.733094",
        "window": "12",
        "polyorder": "2",
        "print_report": "False"
      }
    ]




.. GENERATED FROM PYTHON SOURCE LINES 371-373

Now let's visualise the difference between the raw data and the final
smoothed result.

.. GENERATED FROM PYTHON SOURCE LINES 373-381

.. code-block:: Python


    plot_raw_and_smooth_timeseries_and_psd(
        ds_mouse,
        ds_mouse_smooth,
        keypoint="snout",
        time_range=slice(0, 80),
    )




.. image-sg:: /examples/images/sphx_glr_smooth_006.png
   :alt: Time Domain, Frequency Domain
   :srcset: /examples/images/sphx_glr_smooth_006.png
   :class: sphx-glr-single-img





.. GENERATED FROM PYTHON SOURCE LINES 382-384

Feel free to play around with the parameters of the applied filters and to
also look at other keypoints and time ranges.

.. GENERATED FROM PYTHON SOURCE LINES 386-390

.. seealso::
  :ref:`examples/filter_and_interpolate:Filtering multiple data variables`
  in the
  :ref:`sphx_glr_examples_filter_and_interpolate.py` example.


.. rst-class:: sphx-glr-timing

   **Total running time of the script:** (0 minutes 1.630 seconds)


.. _sphx_glr_download_examples_smooth.py:

.. only:: html

  .. container:: sphx-glr-footer sphx-glr-footer-example

    .. container:: binder-badge

      .. image:: images/binder_badge_logo.svg
        :target: https://mybinder.org/v2/gh/neuroinformatics-unit/movement/gh-pages?filepath=notebooks/examples/smooth.ipynb
        :alt: Launch binder
        :width: 150 px

    .. container:: sphx-glr-download sphx-glr-download-jupyter

      :download:`Download Jupyter notebook: smooth.ipynb <smooth.ipynb>`

    .. container:: sphx-glr-download sphx-glr-download-python

      :download:`Download Python source code: smooth.py <smooth.py>`

    .. container:: sphx-glr-download sphx-glr-download-zip

      :download:`Download zipped: smooth.zip <smooth.zip>`


.. only:: html

 .. rst-class:: sphx-glr-signature

    `Gallery generated by Sphinx-Gallery <https://sphinx-gallery.github.io>`_
