
<!DOCTYPE html>


<html lang="en" data-content_root="../" >

  <head>
    <meta charset="utf-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" /><meta name="viewport" content="width=device-width, initial-scale=1" />

    <title>Compute distances and angles to regions of interest &#8212; movement</title>
  
  
  
  <script data-cfasync="false">
    document.documentElement.dataset.mode = localStorage.getItem("mode") || "";
    document.documentElement.dataset.theme = localStorage.getItem("theme") || "";
  </script>
  <!--
    this give us a css class that will be invisible only if js is disabled
  -->
  <noscript>
    <style>
      .pst-js-only { display: none !important; }

    </style>
  </noscript>
  
  <!-- Loaded before other Sphinx assets -->
  <link href="../_static/styles/theme.css?digest=8878045cc6db502f8baf" rel="stylesheet" />
<link href="../_static/styles/pydata-sphinx-theme.css?digest=8878045cc6db502f8baf" rel="stylesheet" />

    <link rel="stylesheet" type="text/css" href="../_static/css/custom.css?v=ade74076" />
    <link rel="stylesheet" type="text/css" href="../_static/pygments.css?v=8f2a1f02" />
    <link rel="stylesheet" type="text/css" href="../_static/sg_gallery.css?v=d2d258e8" />
    <link rel="stylesheet" type="text/css" href="../_static/sg_gallery-binder.css?v=f4aeca0c" />
    <link rel="stylesheet" type="text/css" href="../_static/sg_gallery-dataframe.css?v=2082cf3c" />
    <link rel="stylesheet" type="text/css" href="../_static/sg_gallery-rendered-html.css?v=1277b6f3" />
    <link rel="stylesheet" type="text/css" href="../_static/sphinx-design.min.css?v=95c83b7e" />
  
  <!-- So that users can add custom icons -->
  <script src="../_static/scripts/fontawesome.js?digest=8878045cc6db502f8baf"></script>
  <!-- Pre-loaded scripts that we'll load fully later -->
  <link rel="preload" as="script" href="../_static/scripts/bootstrap.js?digest=8878045cc6db502f8baf" />
<link rel="preload" as="script" href="../_static/scripts/pydata-sphinx-theme.js?digest=8878045cc6db502f8baf" />

    <script src="../_static/documentation_options.js?v=5a057da9"></script>
    <script src="../_static/doctools.js?v=9bcbadda"></script>
    <script src="../_static/sphinx_highlight.js?v=dc90522c"></script>
    <script src="../_static/design-tabs.js?v=f930bc37"></script>
    <script crossorigin="anonymous" integrity="sha256-Ae2Vz/4ePdIu6ZyI/5ZGsYnb+m0JlOmKPjt6XZ9JJkA=" src="https://cdnjs.cloudflare.com/ajax/libs/require.js/2.3.4/require.min.js"></script>
    <script>window.MathJax = {"tex": {"inlineMath": [["$", "$"], ["\\(", "\\)"]], "processEscapes": true}, "options": {"ignoreHtmlClass": "tex2jax_ignore|mathjax_ignore|document", "processHtmlClass": "tex2jax_process|mathjax_process|math|output_area"}}</script>
    <script defer="defer" src="https://cdn.jsdelivr.net/npm/mathjax@3/es5/tex-mml-chtml.js"></script>
    <script>DOCUMENTATION_OPTIONS.pagename = 'examples/boundary_angles';</script>
    <script src="../_static/js/contributors.js?v=4c153e30"></script>
    <link rel="canonical" href="https://movement.neuroinformatics.dev/examples/boundary_angles.html" />
    <link rel="icon" href="../_static/light-logo-niu.png"/>
    <link rel="index" title="Index" href="../genindex.html" />
    <link rel="search" title="Search" href="../search.html" />
    <link rel="next" title="Load and upsample bounding box tracks" href="load_and_upsample_bboxes.html" />
    <link rel="prev" title="Compute and visualise kinematics." href="compute_kinematics.html" /> 
  <meta name="viewport" content="width=device-width, initial-scale=1"/>
  <meta name="docsearch:language" content="en"/>
  <meta name="docsearch:version" content="" />   
  </head>
  
  
  <body data-bs-spy="scroll" data-bs-target=".bd-toc-nav" data-offset="180" data-bs-root-margin="0px 0px -60%" data-default-mode="">

  
  
  <div id="pst-skip-link" class="skip-link d-print-none"><a href="#main-content">Skip to main content</a></div>
  
  <div id="pst-scroll-pixel-helper"></div>
  
  <button type="button" class="btn rounded-pill" id="pst-back-to-top">
    <i class="fa-solid fa-arrow-up"></i>Back to top</button>

  
  <dialog id="pst-search-dialog">
    
<form class="bd-search d-flex align-items-center"
      action="../search.html"
      method="get">
  <i class="fa-solid fa-magnifying-glass"></i>
  <input type="search"
         class="form-control"
         name="q"
         placeholder="Search the docs ..."
         aria-label="Search the docs ..."
         autocomplete="off"
         autocorrect="off"
         autocapitalize="off"
         spellcheck="false"/>
  <span class="search-button__kbd-shortcut"><kbd class="kbd-shortcut__modifier">Ctrl</kbd>+<kbd>K</kbd></span>
</form>
  </dialog>

  <div class="pst-async-banner-revealer d-none">
  <aside id="bd-header-version-warning" class="d-none d-print-none" aria-label="Version warning"></aside>
</div>

  
    <header class="bd-header navbar navbar-expand-lg bd-navbar d-print-none">
<div class="bd-header__inner bd-page-width">
  <button class="pst-navbar-icon sidebar-toggle primary-toggle" aria-label="Site navigation">
    <span class="fa-solid fa-bars"></span>
  </button>
  
  
  <div class="col-lg-3 navbar-header-items__start">
    
      <div class="navbar-item">

  
    
  

<a class="navbar-brand logo" href="../index.html">
  
  
  
  
  
  
    <p class="title logo__title">movement v0.7.1</p>
  
</a></div>
    
  </div>
  
  <div class="col-lg-9 navbar-header-items">
    
    <div class="me-auto navbar-header-items__center">
      
        <div class="navbar-item">
<nav>
  <ul class="bd-navbar-elements navbar-nav">
    
<li class="nav-item ">
  <a class="nav-link nav-internal" href="../user_guide/index.html">
    User guide
  </a>
</li>


<li class="nav-item current active">
  <a class="nav-link nav-internal" href="index.html">
    Examples
  </a>
</li>


<li class="nav-item ">
  <a class="nav-link nav-internal" href="../community/index.html">
    Community
  </a>
</li>


<li class="nav-item ">
  <a class="nav-link nav-internal" href="../api_index.html">
    API reference
  </a>
</li>


<li class="nav-item ">
  <a class="nav-link nav-internal" href="../blog/index.html">
    Blog
  </a>
</li>

  </ul>
</nav></div>
      
    </div>
    
    
    <div class="navbar-header-items__end">
      
        <div class="navbar-item navbar-persistent--container">
          

<button class="btn search-button-field search-button__button pst-js-only" title="Search" aria-label="Search" data-bs-placement="bottom" data-bs-toggle="tooltip">
 <i class="fa-solid fa-magnifying-glass"></i>
 <span class="search-button__default-text">Search</span>
 <span class="search-button__kbd-shortcut"><kbd class="kbd-shortcut__modifier">Ctrl</kbd>+<kbd class="kbd-shortcut__modifier">K</kbd></span>
</button>
        </div>
      
      
        <div class="navbar-item">

<button class="btn btn-sm nav-link pst-navbar-icon theme-switch-button pst-js-only" aria-label="Color mode" data-bs-title="Color mode"  data-bs-placement="bottom" data-bs-toggle="tooltip">
  <i class="theme-switch fa-solid fa-sun                fa-lg" data-mode="light" title="Light"></i>
  <i class="theme-switch fa-solid fa-moon               fa-lg" data-mode="dark"  title="Dark"></i>
  <i class="theme-switch fa-solid fa-circle-half-stroke fa-lg" data-mode="auto"  title="System Settings"></i>
</button></div>
      
        <div class="navbar-item"><ul class="navbar-icon-links"
    aria-label="Icon Links">
        <li class="nav-item">
          
          
          
          
          
          
          
          
          <a href="https://github.com/neuroinformatics-unit/movement" title="GitHub" class="nav-link pst-navbar-icon" rel="noopener" target="_blank" data-bs-toggle="tooltip" data-bs-placement="bottom"><i class="fa-brands fa-github fa-lg" aria-hidden="true"></i>
            <span class="sr-only">GitHub</span></a>
        </li>
        <li class="nav-item">
          
          
          
          
          
          
          
          
          <a href="https://neuroinformatics.zulipchat.com/#narrow/stream/406001-Movement" title="Zulip (chat)" class="nav-link pst-navbar-icon" rel="noopener" target="_blank" data-bs-toggle="tooltip" data-bs-placement="bottom"><i class="fa-solid fa-comments fa-lg" aria-hidden="true"></i>
            <span class="sr-only">Zulip (chat)</span></a>
        </li>
</ul></div>
      
    </div>
    
  </div>
  
  
    <div class="navbar-persistent--mobile">

<button class="btn search-button-field search-button__button pst-js-only" title="Search" aria-label="Search" data-bs-placement="bottom" data-bs-toggle="tooltip">
 <i class="fa-solid fa-magnifying-glass"></i>
 <span class="search-button__default-text">Search</span>
 <span class="search-button__kbd-shortcut"><kbd class="kbd-shortcut__modifier">Ctrl</kbd>+<kbd class="kbd-shortcut__modifier">K</kbd></span>
</button>
    </div>
  

  
    <button class="pst-navbar-icon sidebar-toggle secondary-toggle" aria-label="On this page">
      <span class="fa-solid fa-outdent"></span>
    </button>
  
</div>

    </header>
  

  <div class="bd-container">
    <div class="bd-container__inner bd-page-width">
      
      
      
      <dialog id="pst-primary-sidebar-modal"></dialog>
      <div id="pst-primary-sidebar" class="bd-sidebar-primary bd-sidebar">
        

  
  <div class="sidebar-header-items sidebar-primary__section">
    
    
      <div class="sidebar-header-items__center">
        
          
          
            <div class="navbar-item">
<nav>
  <ul class="bd-navbar-elements navbar-nav">
    
<li class="nav-item ">
  <a class="nav-link nav-internal" href="../user_guide/index.html">
    User guide
  </a>
</li>


<li class="nav-item current active">
  <a class="nav-link nav-internal" href="index.html">
    Examples
  </a>
</li>


<li class="nav-item ">
  <a class="nav-link nav-internal" href="../community/index.html">
    Community
  </a>
</li>


<li class="nav-item ">
  <a class="nav-link nav-internal" href="../api_index.html">
    API reference
  </a>
</li>


<li class="nav-item ">
  <a class="nav-link nav-internal" href="../blog/index.html">
    Blog
  </a>
</li>

  </ul>
</nav></div>
          
        
      </div>
    
    
    
      <div class="sidebar-header-items__end">
        
          <div class="navbar-item">

<button class="btn btn-sm nav-link pst-navbar-icon theme-switch-button pst-js-only" aria-label="Color mode" data-bs-title="Color mode"  data-bs-placement="bottom" data-bs-toggle="tooltip">
  <i class="theme-switch fa-solid fa-sun                fa-lg" data-mode="light" title="Light"></i>
  <i class="theme-switch fa-solid fa-moon               fa-lg" data-mode="dark"  title="Dark"></i>
  <i class="theme-switch fa-solid fa-circle-half-stroke fa-lg" data-mode="auto"  title="System Settings"></i>
</button></div>
        
          <div class="navbar-item"><ul class="navbar-icon-links"
    aria-label="Icon Links">
        <li class="nav-item">
          
          
          
          
          
          
          
          
          <a href="https://github.com/neuroinformatics-unit/movement" title="GitHub" class="nav-link pst-navbar-icon" rel="noopener" target="_blank" data-bs-toggle="tooltip" data-bs-placement="bottom"><i class="fa-brands fa-github fa-lg" aria-hidden="true"></i>
            <span class="sr-only">GitHub</span></a>
        </li>
        <li class="nav-item">
          
          
          
          
          
          
          
          
          <a href="https://neuroinformatics.zulipchat.com/#narrow/stream/406001-Movement" title="Zulip (chat)" class="nav-link pst-navbar-icon" rel="noopener" target="_blank" data-bs-toggle="tooltip" data-bs-placement="bottom"><i class="fa-solid fa-comments fa-lg" aria-hidden="true"></i>
            <span class="sr-only">Zulip (chat)</span></a>
        </li>
</ul></div>
        
      </div>
    
  </div>
  
    <div class="sidebar-primary-items__start sidebar-primary__section">
        <div class="sidebar-primary-item">
<nav class="bd-docs-nav bd-links"
     aria-label="Section Navigation">
  <p class="bd-links__title" role="heading" aria-level="1">Section Navigation</p>
  <div class="bd-toc-item navbar-nav"><ul class="current nav bd-sidenav">
<li class="toctree-l1"><a class="reference internal" href="load_and_explore_poses.html">Load and explore pose tracks</a></li>
<li class="toctree-l1"><a class="reference internal" href="filter_and_interpolate.html">Drop outliers and interpolate</a></li>
<li class="toctree-l1"><a class="reference internal" href="convert_file_formats.html">Convert pose tracks between file formats</a></li>
<li class="toctree-l1"><a class="reference internal" href="smooth.html">Smooth pose tracks</a></li>
<li class="toctree-l1"><a class="reference internal" href="mouse_eye_movements.html">Pupil tracking</a></li>
<li class="toctree-l1"><a class="reference internal" href="compute_head_direction.html">Compute head direction</a></li>
<li class="toctree-l1"><a class="reference internal" href="compute_kinematics.html">Compute and visualise kinematics.</a></li>
<li class="toctree-l1 current active"><a class="current reference internal" href="#">Compute distances and angles to regions of interest</a></li>
<li class="toctree-l1"><a class="reference internal" href="load_and_upsample_bboxes.html">Load and upsample bounding box tracks</a></li>
</ul>
<ul class="nav bd-sidenav">
<li class="toctree-l1 has-children"><a class="reference internal" href="advanced/index.html">Advanced</a><details><summary><span class="toctree-toggle" role="presentation"><i class="fa-solid fa-chevron-down"></i></span></summary><ul>
<li class="toctree-l2"><a class="reference internal" href="advanced/broadcasting_your_own_methods.html">Broadcast functions across multi-dimensional data</a></li>
</ul>
</details></li>
</ul>
</div>
</nav></div>
    </div>
  
  
  <div class="sidebar-primary-items__end sidebar-primary__section">
      <div class="sidebar-primary-item">
<div id="ethical-ad-placement"
      class="flat"
      data-ea-publisher="readthedocs"
      data-ea-type="readthedocs-sidebar"
      data-ea-manual="true">
</div></div>
  </div>


      </div>
      
      <main id="main-content" class="bd-main" role="main">
        
        
          <div class="bd-content">
            <div class="bd-article-container">
              
              <div class="bd-header-article d-print-none">
<div class="header-article-items header-article__inner">
  
    <div class="header-article-items__start">
      
        <div class="header-article-item">

<nav aria-label="Breadcrumb" class="d-print-none">
  <ul class="bd-breadcrumbs">
    
    <li class="breadcrumb-item breadcrumb-home">
      <a href="../index.html" class="nav-link" aria-label="Home">
        <i class="fa-solid fa-home"></i>
      </a>
    </li>
    
    <li class="breadcrumb-item"><a href="index.html" class="nav-link">Examples</a></li>
    
    <li class="breadcrumb-item active" aria-current="page"><span class="ellipsis">Compute distances and angles to regions of interest</span></li>
  </ul>
</nav>
</div>
      
    </div>
  
  
</div>
</div>
              
              
              
                
<div id="searchbox"></div>
                <article class="bd-article">
                   <div class="sphx-glr-download-link-note admonition note">
<p class="admonition-title">Note</p>
<p><a class="reference internal" href="#sphx-glr-download-examples-boundary-angles-py"><span class="std std-ref">Go to the end</span></a>
to download the full example code. or to run this example in your browser via Binder</p>
</div>
<section class="sphx-glr-example-title" id="compute-distances-and-angles-to-regions-of-interest">
<span id="sphx-glr-examples-boundary-angles-py"></span><h1>Compute distances and angles to regions of interest<a class="headerlink" href="#compute-distances-and-angles-to-regions-of-interest" title="Link to this heading">#</a></h1>
<p>Compute distances, approach vectors, and both egocentric and allocentric
boundary angles relative to regions of interest (RoIs).</p>
<section id="imports">
<h2>Imports<a class="headerlink" href="#imports" title="Link to this heading">#</a></h2>
<div class="highlight-Python notranslate"><div class="highlight"><pre><span></span><span class="c1"># For interactive plots: install ipympl with `pip install ipympl` and uncomment</span>
<span class="c1"># the following lines in your notebook</span>
<span class="c1"># %matplotlib widget</span>
<span class="kn">import</span><span class="w"> </span><span class="nn">matplotlib.pyplot</span><span class="w"> </span><span class="k">as</span><span class="w"> </span><span class="nn">plt</span>
<span class="kn">import</span><span class="w"> </span><span class="nn">numpy</span><span class="w"> </span><span class="k">as</span><span class="w"> </span><span class="nn">np</span>
<span class="kn">import</span><span class="w"> </span><span class="nn">xarray</span><span class="w"> </span><span class="k">as</span><span class="w"> </span><span class="nn">xr</span>

<span class="kn">from</span><span class="w"> </span><span class="nn">movement</span><span class="w"> </span><span class="kn">import</span> <span class="n">sample_data</span>
<span class="kn">from</span><span class="w"> </span><span class="nn">movement.kinematics</span><span class="w"> </span><span class="kn">import</span> <span class="n">compute_velocity</span>
<span class="kn">from</span><span class="w"> </span><span class="nn">movement.plots</span><span class="w"> </span><span class="kn">import</span> <span class="n">plot_centroid_trajectory</span>
<span class="kn">from</span><span class="w"> </span><span class="nn">movement.roi</span><span class="w"> </span><span class="kn">import</span> <a href="../api/movement.roi.base.BaseRegionOfInterest.html#movement.roi.base.BaseRegionOfInterest" title="movement.roi.base.BaseRegionOfInterest" class="sphx-glr-backref-module-movement-roi-base sphx-glr-backref-type-py-class"><span class="n">PolygonOfInterest</span></a>
</pre></div>
</div>
</section>
<section id="load-sample-dataset">
<h2>Load sample dataset<a class="headerlink" href="#load-sample-dataset" title="Link to this heading">#</a></h2>
<p>In this example, we will use the <code class="docutils literal notranslate"><span class="pre">SLEAP_three-mice_Aeon_proofread</span></code> example
dataset. We only need the <code class="docutils literal notranslate"><span class="pre">position</span></code> data array, so we store it in a
separate variable.</p>
<div class="highlight-Python notranslate"><div class="highlight"><pre><span></span><a href="https://docs.xarray.dev/en/stable/generated/xarray.Dataset.html#xarray.Dataset" title="xarray.core.dataset.Dataset" class="sphx-glr-backref-module-xarray-core-dataset sphx-glr-backref-type-py-class sphx-glr-backref-instance"><span class="n">ds</span></a> <span class="o">=</span> <a href="../api/movement.sample_data.fetch_dataset.html#movement.sample_data.fetch_dataset" title="movement.sample_data.fetch_dataset" class="sphx-glr-backref-module-movement-sample_data sphx-glr-backref-type-py-function"><span class="n">sample_data</span><span class="o">.</span><span class="n">fetch_dataset</span></a><span class="p">(</span><span class="s2">&quot;SLEAP_three-mice_Aeon_proofread.analysis.h5&quot;</span><span class="p">)</span>
<a href="https://docs.xarray.dev/en/stable/generated/xarray.DataArray.html#xarray.DataArray" title="xarray.core.dataarray.DataArray" class="sphx-glr-backref-module-xarray-core-dataarray sphx-glr-backref-type-py-class sphx-glr-backref-instance"><span class="n">positions</span></a><span class="p">:</span> <a href="https://docs.xarray.dev/en/stable/generated/xarray.DataArray.html#xarray.DataArray" title="xarray.core.dataarray.DataArray" class="sphx-glr-backref-module-xarray-core-dataarray sphx-glr-backref-type-py-class"><span class="n">xr</span><span class="o">.</span><span class="n">DataArray</span></a> <span class="o">=</span> <a href="https://docs.xarray.dev/en/stable/generated/xarray.DataArray.html#xarray.DataArray" title="xarray.core.dataarray.DataArray" class="sphx-glr-backref-module-xarray-core-dataarray sphx-glr-backref-type-py-class sphx-glr-backref-instance"><span class="n">ds</span><span class="o">.</span><span class="n">position</span></a>
</pre></div>
</div>
<p>The data we have loaded used an arena setup that we have plotted below.</p>
<div class="highlight-Python notranslate"><div class="highlight"><pre><span></span><span class="n">arena_fig</span><span class="p">,</span> <span class="n">arena_ax</span> <span class="o">=</span> <span class="n">plt</span><span class="o">.</span><span class="n">subplots</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span> <span class="mi">1</span><span class="p">)</span>
<span class="c1"># Overlay an image of the experimental arena</span>
<a href="https://docs.python.org/3/library/stdtypes.html#str" title="builtins.str" class="sphx-glr-backref-module-builtins sphx-glr-backref-type-py-class sphx-glr-backref-instance"><span class="n">arena_image</span></a> <span class="o">=</span> <a href="https://docs.python.org/3/library/stdtypes.html#str" title="builtins.str" class="sphx-glr-backref-module-builtins sphx-glr-backref-type-py-class sphx-glr-backref-instance"><span class="n">ds</span><span class="o">.</span><span class="n">frame_path</span></a>
<span class="n">arena_ax</span><span class="o">.</span><span class="n">imshow</span><span class="p">(</span><span class="n">plt</span><span class="o">.</span><span class="n">imread</span><span class="p">(</span><a href="https://docs.python.org/3/library/stdtypes.html#str" title="builtins.str" class="sphx-glr-backref-module-builtins sphx-glr-backref-type-py-class sphx-glr-backref-instance"><span class="n">arena_image</span></a><span class="p">))</span>

<span class="n">arena_ax</span><span class="o">.</span><span class="n">set_xlabel</span><span class="p">(</span><span class="s2">&quot;x (pixels)&quot;</span><span class="p">)</span>
<span class="n">arena_ax</span><span class="o">.</span><span class="n">set_ylabel</span><span class="p">(</span><span class="s2">&quot;y (pixels)&quot;</span><span class="p">)</span>

<span class="n">arena_fig</span><span class="o">.</span><span class="n">show</span><span class="p">()</span>
</pre></div>
</div>
<img src="../_images/sphx_glr_boundary_angles_001.png" srcset="../_images/sphx_glr_boundary_angles_001.png" alt="boundary angles" class = "sphx-glr-single-img"/><p>The
<a class="reference external" href="https://sainsburywellcomecentre.github.io/aeon_docs/reference/hardware/habitat.html">arena</a>
is divided up into three main sub-regions. The cuboidal structure
on the right-hand-side of the arena is the nest of the three individuals
taking part in the experiment. The majority of the arena is an open
octadecagonal (18-sided) shape, which is the bright central region that
encompasses most of the image. This central region is surrounded by a
(comparatively thin) “ring”, which links the central region to the nest.
In this example, we will look at how we can use the functionality for regions
of interest (RoIs) provided by <code class="docutils literal notranslate"><span class="pre">movement</span></code> to analyse our sample dataset.</p>
</section>
<section id="define-regions-of-interest">
<h2>Define regions of interest<a class="headerlink" href="#define-regions-of-interest" title="Link to this heading">#</a></h2>
<p>In order to ask questions about the behaviour of our individuals with respect
to the arena, we first need to define the RoIs to represent the separate
pieces of our arena programmatically. Since each part of our arena is
two-dimensional, we will use a <code class="docutils literal notranslate"><span class="pre">PolygonOfInterest</span></code> to describe each of
them.</p>
<p>In the future, the
<a class="reference internal" href="../user_guide/gui.html"><span class="doc">movement plugin for napari</span></a>
will support creating regions of interest by clicking points and drawing
shapes in the napari GUI. For the time being, we can still define our RoIs
by specifying the points that make up the interior and exterior boundaries.
So first, let’s define the boundary vertices of our various regions.</p>
<div class="highlight-Python notranslate"><div class="highlight"><pre><span></span><span class="c1"># The centre of the arena is located roughly here</span>
<span class="n">centre</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">([</span><span class="mf">712.5</span><span class="p">,</span> <span class="mi">541</span><span class="p">])</span>
<span class="c1"># The &quot;width&quot; (distance between the inner and outer octadecagonal rings) is 40</span>
<span class="c1"># pixels wide</span>
<a href="https://docs.python.org/3/library/functions.html#float" title="builtins.float" class="sphx-glr-backref-module-builtins sphx-glr-backref-type-py-class sphx-glr-backref-instance"><span class="n">ring_width</span></a> <span class="o">=</span> <span class="mf">40.0</span>
<span class="c1"># The distance between opposite vertices of the outer ring is 1090 pixels</span>
<a href="https://docs.python.org/3/library/functions.html#float" title="builtins.float" class="sphx-glr-backref-module-builtins sphx-glr-backref-type-py-class sphx-glr-backref-instance"><span class="n">ring_extent</span></a> <span class="o">=</span> <span class="mf">1090.0</span>

<span class="c1"># Create the vertices of a &quot;unit&quot; octadecagon, centred on (0,0)</span>
<a href="https://docs.python.org/3/library/functions.html#int" title="builtins.int" class="sphx-glr-backref-module-builtins sphx-glr-backref-type-py-class sphx-glr-backref-instance"><span class="n">n_pts</span></a> <span class="o">=</span> <span class="mi">18</span>
<span class="n">unit_shape</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">(</span>
    <span class="p">[</span>
        <span class="n">np</span><span class="o">.</span><span class="n">exp</span><span class="p">((</span><a href="https://docs.python.org/3/library/functions.html#float" title="builtins.float" class="sphx-glr-backref-module-builtins sphx-glr-backref-type-py-class sphx-glr-backref-instance"><span class="n">np</span><span class="o">.</span><span class="n">pi</span></a> <span class="o">/</span> <span class="mf">2.0</span> <span class="o">+</span> <span class="p">(</span><span class="mf">2.0</span> <span class="o">*</span> <span class="n">i</span> <span class="o">*</span> <a href="https://docs.python.org/3/library/functions.html#float" title="builtins.float" class="sphx-glr-backref-module-builtins sphx-glr-backref-type-py-class sphx-glr-backref-instance"><span class="n">np</span><span class="o">.</span><span class="n">pi</span></a><span class="p">)</span> <span class="o">/</span> <a href="https://docs.python.org/3/library/functions.html#int" title="builtins.int" class="sphx-glr-backref-module-builtins sphx-glr-backref-type-py-class sphx-glr-backref-instance"><span class="n">n_pts</span></a><span class="p">)</span> <span class="o">*</span> <span class="mf">1.0</span><span class="n">j</span><span class="p">)</span>
        <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><a href="https://docs.python.org/3/library/functions.html#int" title="builtins.int" class="sphx-glr-backref-module-builtins sphx-glr-backref-type-py-class sphx-glr-backref-instance"><span class="n">n_pts</span></a><span class="p">)</span>
    <span class="p">],</span>
    <span class="n">dtype</span><span class="o">=</span><span class="nb">complex</span><span class="p">,</span>
<span class="p">)</span>
<span class="c1"># Then stretch and translate the reference to match our arena</span>
<span class="n">ring_outer_boundary</span> <span class="o">=</span> <a href="https://docs.python.org/3/library/functions.html#float" title="builtins.float" class="sphx-glr-backref-module-builtins sphx-glr-backref-type-py-class sphx-glr-backref-instance"><span class="n">ring_extent</span></a> <span class="o">/</span> <span class="mf">2.0</span> <span class="o">*</span> <span class="n">unit_shape</span><span class="o">.</span><span class="n">copy</span><span class="p">()</span>
<span class="n">ring_outer_boundary</span> <span class="o">=</span> <span class="p">(</span>
    <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">([</span><span class="n">ring_outer_boundary</span><span class="o">.</span><span class="n">real</span><span class="p">,</span> <span class="n">ring_outer_boundary</span><span class="o">.</span><span class="n">imag</span><span class="p">])</span><span class="o">.</span><span class="n">transpose</span><span class="p">()</span>
    <span class="o">+</span> <span class="n">centre</span>
<span class="p">)</span>
<span class="n">core_boundary</span> <span class="o">=</span> <span class="p">(</span><a href="https://docs.python.org/3/library/functions.html#float" title="builtins.float" class="sphx-glr-backref-module-builtins sphx-glr-backref-type-py-class sphx-glr-backref-instance"><span class="n">ring_extent</span></a> <span class="o">-</span> <a href="https://docs.python.org/3/library/functions.html#float" title="builtins.float" class="sphx-glr-backref-module-builtins sphx-glr-backref-type-py-class sphx-glr-backref-instance"><span class="n">ring_width</span></a><span class="p">)</span> <span class="o">/</span> <span class="mf">2.0</span> <span class="o">*</span> <span class="n">unit_shape</span><span class="o">.</span><span class="n">copy</span><span class="p">()</span>
<span class="n">core_boundary</span> <span class="o">=</span> <span class="p">(</span>
    <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">([</span><span class="n">core_boundary</span><span class="o">.</span><span class="n">real</span><span class="p">,</span> <span class="n">core_boundary</span><span class="o">.</span><span class="n">imag</span><span class="p">])</span><span class="o">.</span><span class="n">transpose</span><span class="p">()</span> <span class="o">+</span> <span class="n">centre</span>
<span class="p">)</span>

<a href="https://docs.python.org/3/library/stdtypes.html#tuple" title="builtins.tuple" class="sphx-glr-backref-module-builtins sphx-glr-backref-type-py-class sphx-glr-backref-instance"><span class="n">nest_corners</span></a> <span class="o">=</span> <span class="p">((</span><span class="mi">1245</span><span class="p">,</span> <span class="mi">585</span><span class="p">),</span> <span class="p">(</span><span class="mi">1245</span><span class="p">,</span> <span class="mi">475</span><span class="p">),</span> <span class="p">(</span><span class="mi">1330</span><span class="p">,</span> <span class="mi">480</span><span class="p">),</span> <span class="p">(</span><span class="mi">1330</span><span class="p">,</span> <span class="mi">580</span><span class="p">))</span>
</pre></div>
</div>
<p>Our central region is a solid shape without any interior holes.
To create the appropriate RoI, we just pass the coordinates in either
clockwise or counter-clockwise order.</p>
<div class="highlight-Python notranslate"><div class="highlight"><pre><span></span><span class="n">central_region</span> <span class="o">=</span> <a href="../api/movement.roi.base.BaseRegionOfInterest.html#movement.roi.base.BaseRegionOfInterest" title="movement.roi.base.BaseRegionOfInterest" class="sphx-glr-backref-module-movement-roi-base sphx-glr-backref-type-py-class"><span class="n">PolygonOfInterest</span></a><span class="p">(</span><span class="n">core_boundary</span><span class="p">,</span> <span class="n">name</span><span class="o">=</span><span class="s2">&quot;Central region&quot;</span><span class="p">)</span>
</pre></div>
</div>
<p>Likewise, the nest is also just a solid shape without any holes.
Note that we are only registering the “floor” of the nest here.</p>
<div class="highlight-Python notranslate"><div class="highlight"><pre><span></span><span class="n">nest_region</span> <span class="o">=</span> <a href="../api/movement.roi.base.BaseRegionOfInterest.html#movement.roi.base.BaseRegionOfInterest" title="movement.roi.base.BaseRegionOfInterest" class="sphx-glr-backref-module-movement-roi-base sphx-glr-backref-type-py-class"><span class="n">PolygonOfInterest</span></a><span class="p">(</span><a href="https://docs.python.org/3/library/stdtypes.html#tuple" title="builtins.tuple" class="sphx-glr-backref-module-builtins sphx-glr-backref-type-py-class sphx-glr-backref-instance"><span class="n">nest_corners</span></a><span class="p">,</span> <span class="n">name</span><span class="o">=</span><span class="s2">&quot;Nest region&quot;</span><span class="p">)</span>
</pre></div>
</div>
<p>To create an RoI representing the ring region, we need to provide an interior
boundary so that <code class="docutils literal notranslate"><span class="pre">movement</span></code> knows our ring region has a “hole”.
<code class="docutils literal notranslate"><span class="pre">movement</span></code>’s <code class="docutils literal notranslate"><span class="pre">PolygonsOfInterest</span></code> can actually support multiple
(non-overlapping) holes, which is why the <code class="docutils literal notranslate"><span class="pre">holes</span></code> argument takes a
<code class="docutils literal notranslate"><span class="pre">list</span></code>.</p>
<div class="highlight-Python notranslate"><div class="highlight"><pre><span></span><span class="n">ring_region</span> <span class="o">=</span> <a href="../api/movement.roi.base.BaseRegionOfInterest.html#movement.roi.base.BaseRegionOfInterest" title="movement.roi.base.BaseRegionOfInterest" class="sphx-glr-backref-module-movement-roi-base sphx-glr-backref-type-py-class"><span class="n">PolygonOfInterest</span></a><span class="p">(</span>
    <span class="n">ring_outer_boundary</span><span class="p">,</span> <span class="n">holes</span><span class="o">=</span><span class="p">[</span><span class="n">core_boundary</span><span class="p">],</span> <span class="n">name</span><span class="o">=</span><span class="s2">&quot;Ring region&quot;</span>
<span class="p">)</span>

<span class="n">arena_fig</span><span class="p">,</span> <span class="n">arena_ax</span> <span class="o">=</span> <span class="n">plt</span><span class="o">.</span><span class="n">subplots</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span> <span class="mi">1</span><span class="p">)</span>
<span class="c1"># Overlay an image of the experimental arena</span>
<span class="n">arena_ax</span><span class="o">.</span><span class="n">imshow</span><span class="p">(</span><span class="n">plt</span><span class="o">.</span><span class="n">imread</span><span class="p">(</span><a href="https://docs.python.org/3/library/stdtypes.html#str" title="builtins.str" class="sphx-glr-backref-module-builtins sphx-glr-backref-type-py-class sphx-glr-backref-instance"><span class="n">arena_image</span></a><span class="p">))</span>

<a href="../api/movement.roi.base.BaseRegionOfInterest.html#movement.roi.base.BaseRegionOfInterest.plot" title="movement.roi.base.BaseRegionOfInterest.plot" class="sphx-glr-backref-module-movement-roi-base sphx-glr-backref-type-py-method"><span class="n">central_region</span><span class="o">.</span><span class="n">plot</span></a><span class="p">(</span><span class="n">arena_ax</span><span class="p">,</span> <span class="n">facecolor</span><span class="o">=</span><span class="s2">&quot;lightblue&quot;</span><span class="p">,</span> <span class="n">alpha</span><span class="o">=</span><span class="mf">0.25</span><span class="p">)</span>
<a href="../api/movement.roi.base.BaseRegionOfInterest.html#movement.roi.base.BaseRegionOfInterest.plot" title="movement.roi.base.BaseRegionOfInterest.plot" class="sphx-glr-backref-module-movement-roi-base sphx-glr-backref-type-py-method"><span class="n">nest_region</span><span class="o">.</span><span class="n">plot</span></a><span class="p">(</span><span class="n">arena_ax</span><span class="p">,</span> <span class="n">facecolor</span><span class="o">=</span><span class="s2">&quot;green&quot;</span><span class="p">,</span> <span class="n">alpha</span><span class="o">=</span><span class="mf">0.25</span><span class="p">)</span>
<a href="../api/movement.roi.base.BaseRegionOfInterest.html#movement.roi.base.BaseRegionOfInterest.plot" title="movement.roi.base.BaseRegionOfInterest.plot" class="sphx-glr-backref-module-movement-roi-base sphx-glr-backref-type-py-method"><span class="n">ring_region</span><span class="o">.</span><span class="n">plot</span></a><span class="p">(</span><span class="n">arena_ax</span><span class="p">,</span> <span class="n">facecolor</span><span class="o">=</span><span class="s2">&quot;blue&quot;</span><span class="p">,</span> <span class="n">alpha</span><span class="o">=</span><span class="mf">0.25</span><span class="p">)</span>
<span class="n">arena_ax</span><span class="o">.</span><span class="n">legend</span><span class="p">()</span>
<span class="n">arena_fig</span><span class="o">.</span><span class="n">show</span><span class="p">()</span>
</pre></div>
</div>
<img src="../_images/sphx_glr_boundary_angles_002.png" srcset="../_images/sphx_glr_boundary_angles_002.png" alt="boundary angles" class = "sphx-glr-single-img"/></section>
<section id="view-individual-paths-inside-the-arena">
<h2>View individual paths inside the arena<a class="headerlink" href="#view-individual-paths-inside-the-arena" title="Link to this heading">#</a></h2>
<p>We can now overlay the paths that the individuals followed on top of our
image of the arena and the RoIs that we have defined.</p>
<div class="highlight-Python notranslate"><div class="highlight"><pre><span></span><span class="n">arena_fig</span><span class="p">,</span> <span class="n">arena_ax</span> <span class="o">=</span> <span class="n">plt</span><span class="o">.</span><span class="n">subplots</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span> <span class="mi">1</span><span class="p">)</span>
<span class="c1"># Overlay an image of the experimental arena</span>
<span class="n">arena_ax</span><span class="o">.</span><span class="n">imshow</span><span class="p">(</span><span class="n">plt</span><span class="o">.</span><span class="n">imread</span><span class="p">(</span><a href="https://docs.python.org/3/library/stdtypes.html#str" title="builtins.str" class="sphx-glr-backref-module-builtins sphx-glr-backref-type-py-class sphx-glr-backref-instance"><span class="n">arena_image</span></a><span class="p">))</span>

<a href="../api/movement.roi.base.BaseRegionOfInterest.html#movement.roi.base.BaseRegionOfInterest.plot" title="movement.roi.base.BaseRegionOfInterest.plot" class="sphx-glr-backref-module-movement-roi-base sphx-glr-backref-type-py-method"><span class="n">central_region</span><span class="o">.</span><span class="n">plot</span></a><span class="p">(</span><span class="n">arena_ax</span><span class="p">,</span> <span class="n">facecolor</span><span class="o">=</span><span class="s2">&quot;lightblue&quot;</span><span class="p">,</span> <span class="n">alpha</span><span class="o">=</span><span class="mf">0.25</span><span class="p">)</span>
<a href="../api/movement.roi.base.BaseRegionOfInterest.html#movement.roi.base.BaseRegionOfInterest.plot" title="movement.roi.base.BaseRegionOfInterest.plot" class="sphx-glr-backref-module-movement-roi-base sphx-glr-backref-type-py-method"><span class="n">nest_region</span><span class="o">.</span><span class="n">plot</span></a><span class="p">(</span><span class="n">arena_ax</span><span class="p">,</span> <span class="n">facecolor</span><span class="o">=</span><span class="s2">&quot;green&quot;</span><span class="p">,</span> <span class="n">alpha</span><span class="o">=</span><span class="mf">0.25</span><span class="p">)</span>
<a href="../api/movement.roi.base.BaseRegionOfInterest.html#movement.roi.base.BaseRegionOfInterest.plot" title="movement.roi.base.BaseRegionOfInterest.plot" class="sphx-glr-backref-module-movement-roi-base sphx-glr-backref-type-py-method"><span class="n">ring_region</span><span class="o">.</span><span class="n">plot</span></a><span class="p">(</span><span class="n">arena_ax</span><span class="p">,</span> <span class="n">facecolor</span><span class="o">=</span><span class="s2">&quot;blue&quot;</span><span class="p">,</span> <span class="n">alpha</span><span class="o">=</span><span class="mf">0.25</span><span class="p">)</span>

<span class="c1"># Plot trajectories of the individuals</span>
<a href="https://docs.python.org/3/library/stdtypes.html#list" title="builtins.list" class="sphx-glr-backref-module-builtins sphx-glr-backref-type-py-class sphx-glr-backref-instance"><span class="n">mouse_names_and_colours</span></a> <span class="o">=</span> <span class="nb">list</span><span class="p">(</span>
    <span class="nb">zip</span><span class="p">(</span><a href="https://docs.xarray.dev/en/stable/generated/xarray.DataArray.values.html#xarray.DataArray.values" title="xarray.DataArray.values" class="sphx-glr-backref-module-xarray sphx-glr-backref-type-py-property"><span class="n">positions</span><span class="o">.</span><span class="n">individuals</span><span class="o">.</span><span class="n">values</span></a><span class="p">,</span> <span class="p">[</span><span class="s2">&quot;r&quot;</span><span class="p">,</span> <span class="s2">&quot;g&quot;</span><span class="p">,</span> <span class="s2">&quot;b&quot;</span><span class="p">],</span> <span class="n">strict</span><span class="o">=</span><span class="kc">False</span><span class="p">)</span>
<span class="p">)</span>
<span class="k">for</span> <span class="n">mouse_name</span><span class="p">,</span> <a href="https://docs.python.org/3/library/stdtypes.html#str" title="builtins.str" class="sphx-glr-backref-module-builtins sphx-glr-backref-type-py-class sphx-glr-backref-instance"><span class="n">col</span></a> <span class="ow">in</span> <a href="https://docs.python.org/3/library/stdtypes.html#list" title="builtins.list" class="sphx-glr-backref-module-builtins sphx-glr-backref-type-py-class sphx-glr-backref-instance"><span class="n">mouse_names_and_colours</span></a><span class="p">:</span>
    <span class="n">plot_centroid_trajectory</span><span class="p">(</span>
        <a href="https://docs.xarray.dev/en/stable/generated/xarray.DataArray.html#xarray.DataArray" title="xarray.core.dataarray.DataArray" class="sphx-glr-backref-module-xarray-core-dataarray sphx-glr-backref-type-py-class sphx-glr-backref-instance"><span class="n">positions</span></a><span class="p">,</span>
        <span class="n">individual</span><span class="o">=</span><span class="n">mouse_name</span><span class="p">,</span>
        <span class="n">ax</span><span class="o">=</span><span class="n">arena_ax</span><span class="p">,</span>
        <span class="n">linestyle</span><span class="o">=</span><span class="s2">&quot;-&quot;</span><span class="p">,</span>
        <span class="n">marker</span><span class="o">=</span><span class="s2">&quot;.&quot;</span><span class="p">,</span>
        <span class="n">s</span><span class="o">=</span><span class="mi">1</span><span class="p">,</span>
        <span class="n">c</span><span class="o">=</span><a href="https://docs.python.org/3/library/stdtypes.html#str" title="builtins.str" class="sphx-glr-backref-module-builtins sphx-glr-backref-type-py-class sphx-glr-backref-instance"><span class="n">col</span></a><span class="p">,</span>
        <span class="n">label</span><span class="o">=</span><span class="n">mouse_name</span><span class="p">,</span>
    <span class="p">)</span>
<span class="n">arena_ax</span><span class="o">.</span><span class="n">set_title</span><span class="p">(</span><span class="s2">&quot;Individual trajectories within the arena&quot;</span><span class="p">)</span>
<span class="n">arena_ax</span><span class="o">.</span><span class="n">legend</span><span class="p">()</span>

<span class="n">arena_fig</span><span class="o">.</span><span class="n">show</span><span class="p">()</span>
</pre></div>
</div>
<img src="../_images/sphx_glr_boundary_angles_003.png" srcset="../_images/sphx_glr_boundary_angles_003.png" alt="Individual trajectories within the arena" class = "sphx-glr-single-img"/><p>At a glance, it looks like all the individuals remained inside the
ring-region for the duration of the experiment. We can verify this
programmatically, by asking whether the <code class="docutils literal notranslate"><span class="pre">ring_region</span></code>
contained the individuals’ locations, at all recorded time-points.</p>
<div class="highlight-Python notranslate"><div class="highlight"><pre><span></span><span class="c1"># This is a DataArray with dimensions: time, keypoint, and individual.</span>
<span class="c1"># The values of the DataArray are True/False values, indicating if at the given</span>
<span class="c1"># time, the keypoint of individual was inside ring_region.</span>
<a href="https://docs.xarray.dev/en/stable/generated/xarray.DataArray.html#xarray.DataArray" title="xarray.core.dataarray.DataArray" class="sphx-glr-backref-module-xarray-core-dataarray sphx-glr-backref-type-py-class sphx-glr-backref-instance"><span class="n">individual_was_inside</span></a> <span class="o">=</span> <a href="../api/movement.roi.base.BaseRegionOfInterest.html#movement.roi.base.BaseRegionOfInterest.contains_point" title="movement.roi.base.BaseRegionOfInterest.contains_point" class="sphx-glr-backref-module-movement-roi-base sphx-glr-backref-type-py-method"><span class="n">ring_region</span><span class="o">.</span><span class="n">contains_point</span></a><span class="p">(</span><a href="https://docs.xarray.dev/en/stable/generated/xarray.DataArray.html#xarray.DataArray" title="xarray.core.dataarray.DataArray" class="sphx-glr-backref-module-xarray-core-dataarray sphx-glr-backref-type-py-class sphx-glr-backref-instance"><span class="n">positions</span></a><span class="p">)</span>
<a href="https://docs.xarray.dev/en/stable/generated/xarray.DataArray.html#xarray.DataArray" title="xarray.core.dataarray.DataArray" class="sphx-glr-backref-module-xarray-core-dataarray sphx-glr-backref-type-py-class sphx-glr-backref-instance"><span class="n">all_individuals_in_ring_at_all_times</span></a> <span class="o">=</span> <a href="https://docs.xarray.dev/en/stable/generated/xarray.DataArray.all.html#xarray.DataArray.all" title="xarray.DataArray.all" class="sphx-glr-backref-module-xarray sphx-glr-backref-type-py-method"><span class="n">individual_was_inside</span><span class="o">.</span><span class="n">all</span></a><span class="p">()</span>

<span class="k">if</span> <a href="https://docs.xarray.dev/en/stable/generated/xarray.DataArray.html#xarray.DataArray" title="xarray.core.dataarray.DataArray" class="sphx-glr-backref-module-xarray-core-dataarray sphx-glr-backref-type-py-class sphx-glr-backref-instance"><span class="n">all_individuals_in_ring_at_all_times</span></a><span class="p">:</span>
    <span class="nb">print</span><span class="p">(</span>
        <span class="s2">&quot;All recorded positions, at all times,</span><span class="se">\n</span><span class="s2">&quot;</span>
        <span class="s2">&quot;and for all individuals, were inside ring_region.&quot;</span>
    <span class="p">)</span>
<span class="k">else</span><span class="p">:</span>
    <span class="nb">print</span><span class="p">(</span><span class="s2">&quot;At least one position was recorded outside the ring_region.&quot;</span><span class="p">)</span>
</pre></div>
</div>
<div class="sphx-glr-script-out highlight-none notranslate"><div class="highlight"><pre><span></span>All recorded positions, at all times,
and for all individuals, were inside ring_region.
</pre></div>
</div>
</section>
<section id="compute-the-distance-to-the-nest">
<h2>Compute the distance to the nest<a class="headerlink" href="#compute-the-distance-to-the-nest" title="Link to this heading">#</a></h2>
<p>Defining RoIs means that we can efficiently extract information from our data
that depends on the location or relative position of an individual to an RoI.
For example, we might be interested in how the distance between an
individual and the nest region changes over the course of the experiment. We
can query the <code class="docutils literal notranslate"><span class="pre">nest_region</span></code> that we created for this information.</p>
<div class="highlight-Python notranslate"><div class="highlight"><pre><span></span><span class="c1"># Compute all distances to the nest; for all times, keypoints, and</span>
<span class="c1"># individuals.</span>
<a href="https://docs.xarray.dev/en/stable/generated/xarray.DataArray.html#xarray.DataArray" title="xarray.core.dataarray.DataArray" class="sphx-glr-backref-module-xarray-core-dataarray sphx-glr-backref-type-py-class sphx-glr-backref-instance"><span class="n">distances_to_nest</span></a> <span class="o">=</span> <a href="../api/movement.roi.base.BaseRegionOfInterest.html#movement.roi.base.BaseRegionOfInterest.compute_distance_to" title="movement.roi.base.BaseRegionOfInterest.compute_distance_to" class="sphx-glr-backref-module-movement-roi-base sphx-glr-backref-type-py-method"><span class="n">nest_region</span><span class="o">.</span><span class="n">compute_distance_to</span></a><span class="p">(</span><a href="https://docs.xarray.dev/en/stable/generated/xarray.DataArray.html#xarray.DataArray" title="xarray.core.dataarray.DataArray" class="sphx-glr-backref-module-xarray-core-dataarray sphx-glr-backref-type-py-class sphx-glr-backref-instance"><span class="n">positions</span></a><span class="p">)</span>
<span class="n">distances_fig</span><span class="p">,</span> <span class="n">distances_ax</span> <span class="o">=</span> <span class="n">plt</span><span class="o">.</span><span class="n">subplots</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span> <span class="mi">1</span><span class="p">)</span>
<span class="k">for</span> <span class="n">mouse_name</span><span class="p">,</span> <a href="https://docs.python.org/3/library/stdtypes.html#str" title="builtins.str" class="sphx-glr-backref-module-builtins sphx-glr-backref-type-py-class sphx-glr-backref-instance"><span class="n">col</span></a> <span class="ow">in</span> <a href="https://docs.python.org/3/library/stdtypes.html#list" title="builtins.list" class="sphx-glr-backref-module-builtins sphx-glr-backref-type-py-class sphx-glr-backref-instance"><span class="n">mouse_names_and_colours</span></a><span class="p">:</span>
    <span class="n">distances_ax</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span>
        <a href="https://docs.xarray.dev/en/stable/generated/xarray.DataArray.sel.html#xarray.DataArray.sel" title="xarray.DataArray.sel" class="sphx-glr-backref-module-xarray sphx-glr-backref-type-py-method"><span class="n">distances_to_nest</span><span class="o">.</span><span class="n">sel</span></a><span class="p">(</span><span class="n">individuals</span><span class="o">=</span><span class="n">mouse_name</span><span class="p">),</span>
        <span class="n">c</span><span class="o">=</span><a href="https://docs.python.org/3/library/stdtypes.html#str" title="builtins.str" class="sphx-glr-backref-module-builtins sphx-glr-backref-type-py-class sphx-glr-backref-instance"><span class="n">col</span></a><span class="p">,</span>
        <span class="n">label</span><span class="o">=</span><span class="n">mouse_name</span><span class="p">,</span>
    <span class="p">)</span>
<span class="n">distances_ax</span><span class="o">.</span><span class="n">legend</span><span class="p">()</span>
<span class="n">distances_ax</span><span class="o">.</span><span class="n">set_xlabel</span><span class="p">(</span><span class="s2">&quot;Time (frames)&quot;</span><span class="p">)</span>
<span class="n">distances_ax</span><span class="o">.</span><span class="n">set_ylabel</span><span class="p">(</span><span class="s2">&quot;Distance to nest_region (pixels)&quot;</span><span class="p">)</span>
<span class="n">distances_fig</span><span class="o">.</span><span class="n">show</span><span class="p">()</span>
</pre></div>
</div>
<img src="../_images/sphx_glr_boundary_angles_004.png" srcset="../_images/sphx_glr_boundary_angles_004.png" alt="boundary angles" class = "sphx-glr-single-img"/><p>We can see that the <code class="docutils literal notranslate"><span class="pre">AEON38_TP2</span></code> individual appears to be moving towards
the nest during the experiment, whilst the other two individuals are
moving away from the nest. The “plateau” in the figure between frames 200-400
is when the individuals meet in the <code class="docutils literal notranslate"><span class="pre">ring_region</span></code>, and remain largely
stationary in a group until they can pass each other.</p>
<p>One other thing to note is that <code class="docutils literal notranslate"><span class="pre">compute_distance_to</span></code> is returning the
distance “as the crow flies” to the <code class="docutils literal notranslate"><span class="pre">nest_region</span></code>. This means that
structures potentially in the way (such as the <code class="docutils literal notranslate"><span class="pre">ring_region</span></code> walls) are not
accounted for in this distance calculation. Further to this, the “distance to
a RoI” should always be understood as “the distance from a point to the
closest point within an RoI”.</p>
<p>If we wanted to check the direction of closest approach to a region, referred
to as the <strong>approach vector</strong>, we can use the <code class="docutils literal notranslate"><span class="pre">compute_approach_vector</span></code>
method.
The distances that we computed via <code class="docutils literal notranslate"><span class="pre">compute_distance_to</span></code> are just the
magnitudes of the approach vectors.</p>
<div class="highlight-Python notranslate"><div class="highlight"><pre><span></span><a href="https://docs.xarray.dev/en/stable/generated/xarray.DataArray.html#xarray.DataArray" title="xarray.core.dataarray.DataArray" class="sphx-glr-backref-module-xarray-core-dataarray sphx-glr-backref-type-py-class sphx-glr-backref-instance"><span class="n">approach_vectors</span></a> <span class="o">=</span> <a href="../api/movement.roi.base.BaseRegionOfInterest.html#movement.roi.base.BaseRegionOfInterest.compute_approach_vector" title="movement.roi.base.BaseRegionOfInterest.compute_approach_vector" class="sphx-glr-backref-module-movement-roi-base sphx-glr-backref-type-py-method"><span class="n">nest_region</span><span class="o">.</span><span class="n">compute_approach_vector</span></a><span class="p">(</span><a href="https://docs.xarray.dev/en/stable/generated/xarray.DataArray.html#xarray.DataArray" title="xarray.core.dataarray.DataArray" class="sphx-glr-backref-module-xarray-core-dataarray sphx-glr-backref-type-py-class sphx-glr-backref-instance"><span class="n">positions</span></a><span class="p">)</span>
</pre></div>
</div>
</section>
<section id="the-boundary-only-keyword">
<h2>The <code class="docutils literal notranslate"><span class="pre">boundary_only</span></code> keyword<a class="headerlink" href="#the-boundary-only-keyword" title="Link to this heading">#</a></h2>
<p>From our plot of the distances to the nest, we saw a time-window
in which the individuals are grouped up, possibly trying to pass each other
as they approach from different directions.
We might be interested in whether they move to opposite walls of the ring
while doing so. To examine this, we can plot the distance between each
individual and the <code class="docutils literal notranslate"><span class="pre">ring_region</span></code>, using the same commands as above.</p>
<p>However, we get something slightly unexpected:</p>
<div class="highlight-Python notranslate"><div class="highlight"><pre><span></span><a href="https://docs.xarray.dev/en/stable/generated/xarray.DataArray.html#xarray.DataArray" title="xarray.core.dataarray.DataArray" class="sphx-glr-backref-module-xarray-core-dataarray sphx-glr-backref-type-py-class sphx-glr-backref-instance"><span class="n">distances_to_ring_wall</span></a> <span class="o">=</span> <a href="../api/movement.roi.base.BaseRegionOfInterest.html#movement.roi.base.BaseRegionOfInterest.compute_distance_to" title="movement.roi.base.BaseRegionOfInterest.compute_distance_to" class="sphx-glr-backref-module-movement-roi-base sphx-glr-backref-type-py-method"><span class="n">ring_region</span><span class="o">.</span><span class="n">compute_distance_to</span></a><span class="p">(</span><a href="https://docs.xarray.dev/en/stable/generated/xarray.DataArray.html#xarray.DataArray" title="xarray.core.dataarray.DataArray" class="sphx-glr-backref-module-xarray-core-dataarray sphx-glr-backref-type-py-class sphx-glr-backref-instance"><span class="n">positions</span></a><span class="p">)</span>
<span class="n">distances_fig</span><span class="p">,</span> <span class="n">distances_ax</span> <span class="o">=</span> <span class="n">plt</span><span class="o">.</span><span class="n">subplots</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span> <span class="mi">1</span><span class="p">)</span>
<span class="k">for</span> <span class="n">mouse_name</span><span class="p">,</span> <a href="https://docs.python.org/3/library/stdtypes.html#str" title="builtins.str" class="sphx-glr-backref-module-builtins sphx-glr-backref-type-py-class sphx-glr-backref-instance"><span class="n">col</span></a> <span class="ow">in</span> <a href="https://docs.python.org/3/library/stdtypes.html#list" title="builtins.list" class="sphx-glr-backref-module-builtins sphx-glr-backref-type-py-class sphx-glr-backref-instance"><span class="n">mouse_names_and_colours</span></a><span class="p">:</span>
    <span class="n">distances_ax</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span>
        <a href="https://docs.xarray.dev/en/stable/generated/xarray.DataArray.sel.html#xarray.DataArray.sel" title="xarray.DataArray.sel" class="sphx-glr-backref-module-xarray sphx-glr-backref-type-py-method"><span class="n">distances_to_ring_wall</span><span class="o">.</span><span class="n">sel</span></a><span class="p">(</span><span class="n">individuals</span><span class="o">=</span><span class="n">mouse_name</span><span class="p">),</span>
        <span class="n">c</span><span class="o">=</span><a href="https://docs.python.org/3/library/stdtypes.html#str" title="builtins.str" class="sphx-glr-backref-module-builtins sphx-glr-backref-type-py-class sphx-glr-backref-instance"><span class="n">col</span></a><span class="p">,</span>
        <span class="n">label</span><span class="o">=</span><span class="n">mouse_name</span><span class="p">,</span>
    <span class="p">)</span>
<span class="n">distances_ax</span><span class="o">.</span><span class="n">legend</span><span class="p">()</span>
<span class="n">distances_ax</span><span class="o">.</span><span class="n">set_xlabel</span><span class="p">(</span><span class="s2">&quot;Time (frames)&quot;</span><span class="p">)</span>
<span class="n">distances_ax</span><span class="o">.</span><span class="n">set_ylabel</span><span class="p">(</span><span class="s2">&quot;Distance to closest ring_region wall (pixels)&quot;</span><span class="p">)</span>

<span class="nb">print</span><span class="p">(</span>
    <span class="s2">&quot;distances_to_ring_wall are all zero:&quot;</span><span class="p">,</span>
    <span class="n">np</span><span class="o">.</span><span class="n">allclose</span><span class="p">(</span><a href="https://docs.xarray.dev/en/stable/generated/xarray.DataArray.html#xarray.DataArray" title="xarray.core.dataarray.DataArray" class="sphx-glr-backref-module-xarray-core-dataarray sphx-glr-backref-type-py-class sphx-glr-backref-instance"><span class="n">distances_to_ring_wall</span></a><span class="p">,</span> <span class="mf">0.0</span><span class="p">),</span>
<span class="p">)</span>

<span class="n">distances_fig</span><span class="o">.</span><span class="n">show</span><span class="p">()</span>
</pre></div>
</div>
<img src="../_images/sphx_glr_boundary_angles_005.png" srcset="../_images/sphx_glr_boundary_angles_005.png" alt="boundary angles" class = "sphx-glr-single-img"/><div class="sphx-glr-script-out highlight-none notranslate"><div class="highlight"><pre><span></span>distances_to_ring_wall are all zero: True
</pre></div>
</div>
<p>The distances are all zero because when a point is inside a region, the
closest point to it is itself.</p>
<p>To find distances to the ring’s walls instead, we can use
<code class="docutils literal notranslate"><span class="pre">boundary_only=True</span></code>, which tells <code class="docutils literal notranslate"><span class="pre">movement</span></code> to only look at points on
the boundary of the region, not inside it.
Note that for 1D regions (<code class="docutils literal notranslate"><span class="pre">LineOfInterest</span></code>), the “boundary” is just the
endpoints of the line.</p>
<p>Let’s try again with <code class="docutils literal notranslate"><span class="pre">boundary_only=True</span></code>:</p>
<div class="highlight-Python notranslate"><div class="highlight"><pre><span></span><a href="https://docs.xarray.dev/en/stable/generated/xarray.DataArray.html#xarray.DataArray" title="xarray.core.dataarray.DataArray" class="sphx-glr-backref-module-xarray-core-dataarray sphx-glr-backref-type-py-class sphx-glr-backref-instance"><span class="n">distances_to_ring_wall</span></a> <span class="o">=</span> <a href="../api/movement.roi.base.BaseRegionOfInterest.html#movement.roi.base.BaseRegionOfInterest.compute_distance_to" title="movement.roi.base.BaseRegionOfInterest.compute_distance_to" class="sphx-glr-backref-module-movement-roi-base sphx-glr-backref-type-py-method"><span class="n">ring_region</span><span class="o">.</span><span class="n">compute_distance_to</span></a><span class="p">(</span>
    <a href="https://docs.xarray.dev/en/stable/generated/xarray.DataArray.html#xarray.DataArray" title="xarray.core.dataarray.DataArray" class="sphx-glr-backref-module-xarray-core-dataarray sphx-glr-backref-type-py-class sphx-glr-backref-instance"><span class="n">positions</span></a><span class="p">,</span> <span class="n">boundary_only</span><span class="o">=</span><span class="kc">True</span>
<span class="p">)</span>
<span class="n">distances_fig</span><span class="p">,</span> <span class="n">distances_ax</span> <span class="o">=</span> <span class="n">plt</span><span class="o">.</span><span class="n">subplots</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span> <span class="mi">1</span><span class="p">)</span>
<span class="k">for</span> <span class="n">mouse_name</span><span class="p">,</span> <a href="https://docs.python.org/3/library/stdtypes.html#str" title="builtins.str" class="sphx-glr-backref-module-builtins sphx-glr-backref-type-py-class sphx-glr-backref-instance"><span class="n">col</span></a> <span class="ow">in</span> <a href="https://docs.python.org/3/library/stdtypes.html#list" title="builtins.list" class="sphx-glr-backref-module-builtins sphx-glr-backref-type-py-class sphx-glr-backref-instance"><span class="n">mouse_names_and_colours</span></a><span class="p">:</span>
    <span class="n">distances_ax</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span>
        <a href="https://docs.xarray.dev/en/stable/generated/xarray.DataArray.sel.html#xarray.DataArray.sel" title="xarray.DataArray.sel" class="sphx-glr-backref-module-xarray sphx-glr-backref-type-py-method"><span class="n">distances_to_ring_wall</span><span class="o">.</span><span class="n">sel</span></a><span class="p">(</span><span class="n">individuals</span><span class="o">=</span><span class="n">mouse_name</span><span class="p">),</span>
        <span class="n">c</span><span class="o">=</span><a href="https://docs.python.org/3/library/stdtypes.html#str" title="builtins.str" class="sphx-glr-backref-module-builtins sphx-glr-backref-type-py-class sphx-glr-backref-instance"><span class="n">col</span></a><span class="p">,</span>
        <span class="n">label</span><span class="o">=</span><span class="n">mouse_name</span><span class="p">,</span>
    <span class="p">)</span>
<span class="n">distances_ax</span><span class="o">.</span><span class="n">legend</span><span class="p">()</span>
<span class="n">distances_ax</span><span class="o">.</span><span class="n">set_xlabel</span><span class="p">(</span><span class="s2">&quot;Time (frames)&quot;</span><span class="p">)</span>
<span class="n">distances_ax</span><span class="o">.</span><span class="n">set_ylabel</span><span class="p">(</span><span class="s2">&quot;Distance to closest ring_region wall (pixels)&quot;</span><span class="p">)</span>

<span class="nb">print</span><span class="p">(</span>
    <span class="s2">&quot;distances_to_ring_wall are all zero:&quot;</span><span class="p">,</span>
    <span class="n">np</span><span class="o">.</span><span class="n">allclose</span><span class="p">(</span><a href="https://docs.xarray.dev/en/stable/generated/xarray.DataArray.html#xarray.DataArray" title="xarray.core.dataarray.DataArray" class="sphx-glr-backref-module-xarray-core-dataarray sphx-glr-backref-type-py-class sphx-glr-backref-instance"><span class="n">distances_to_ring_wall</span></a><span class="p">,</span> <span class="mf">0.0</span><span class="p">),</span>
<span class="p">)</span>

<span class="n">distances_fig</span><span class="o">.</span><span class="n">show</span><span class="p">()</span>
</pre></div>
</div>
<img src="../_images/sphx_glr_boundary_angles_006.png" srcset="../_images/sphx_glr_boundary_angles_006.png" alt="boundary angles" class = "sphx-glr-single-img"/><div class="sphx-glr-script-out highlight-none notranslate"><div class="highlight"><pre><span></span>distances_to_ring_wall are all zero: False
</pre></div>
</div>
<p>The resulting plot looks much more like what we expect, but is again
not very helpful; we get the distance to the closest point on <em>either</em>
the interior or exterior wall of the <code class="docutils literal notranslate"><span class="pre">ring_region</span></code>. This means that we
can’t tell if the individuals do move to opposite walls when passing each
other. Instead, let’s ask for the distance  to just the exterior wall.</p>
<div class="highlight-Python notranslate"><div class="highlight"><pre><span></span><span class="c1"># Note that the exterior_boundary of the ring_region is a 1D RoI (a series of</span>
<span class="c1"># connected line segments). As such, boundary_only needs to be False.</span>
<a href="https://docs.xarray.dev/en/stable/generated/xarray.DataArray.html#xarray.DataArray" title="xarray.core.dataarray.DataArray" class="sphx-glr-backref-module-xarray-core-dataarray sphx-glr-backref-type-py-class sphx-glr-backref-instance"><span class="n">distances_to_exterior</span></a> <span class="o">=</span> <span class="n">ring_region</span><span class="o">.</span><span class="n">exterior_boundary</span><span class="o">.</span><span class="n">compute_distance_to</span><span class="p">(</span>
    <a href="https://docs.xarray.dev/en/stable/generated/xarray.DataArray.html#xarray.DataArray" title="xarray.core.dataarray.DataArray" class="sphx-glr-backref-module-xarray-core-dataarray sphx-glr-backref-type-py-class sphx-glr-backref-instance"><span class="n">positions</span></a>
<span class="p">)</span>
<span class="n">distances_exterior_fig</span><span class="p">,</span> <span class="n">distances_exterior_ax</span> <span class="o">=</span> <span class="n">plt</span><span class="o">.</span><span class="n">subplots</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span> <span class="mi">1</span><span class="p">)</span>
<span class="k">for</span> <span class="n">mouse_name</span><span class="p">,</span> <a href="https://docs.python.org/3/library/stdtypes.html#str" title="builtins.str" class="sphx-glr-backref-module-builtins sphx-glr-backref-type-py-class sphx-glr-backref-instance"><span class="n">col</span></a> <span class="ow">in</span> <a href="https://docs.python.org/3/library/stdtypes.html#list" title="builtins.list" class="sphx-glr-backref-module-builtins sphx-glr-backref-type-py-class sphx-glr-backref-instance"><span class="n">mouse_names_and_colours</span></a><span class="p">:</span>
    <span class="n">distances_exterior_ax</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span>
        <a href="https://docs.xarray.dev/en/stable/generated/xarray.DataArray.sel.html#xarray.DataArray.sel" title="xarray.DataArray.sel" class="sphx-glr-backref-module-xarray sphx-glr-backref-type-py-method"><span class="n">distances_to_exterior</span><span class="o">.</span><span class="n">sel</span></a><span class="p">(</span><span class="n">individuals</span><span class="o">=</span><span class="n">mouse_name</span><span class="p">),</span>
        <span class="n">c</span><span class="o">=</span><a href="https://docs.python.org/3/library/stdtypes.html#str" title="builtins.str" class="sphx-glr-backref-module-builtins sphx-glr-backref-type-py-class sphx-glr-backref-instance"><span class="n">col</span></a><span class="p">,</span>
        <span class="n">label</span><span class="o">=</span><span class="n">mouse_name</span><span class="p">,</span>
    <span class="p">)</span>
<span class="n">distances_exterior_ax</span><span class="o">.</span><span class="n">legend</span><span class="p">()</span>
<span class="n">distances_exterior_ax</span><span class="o">.</span><span class="n">set_xlabel</span><span class="p">(</span><span class="s2">&quot;Time (frames)&quot;</span><span class="p">)</span>
<span class="n">distances_exterior_ax</span><span class="o">.</span><span class="n">set_ylabel</span><span class="p">(</span><span class="s2">&quot;Distance to exterior wall (pixels)&quot;</span><span class="p">)</span>
<span class="n">distances_exterior_fig</span><span class="o">.</span><span class="n">show</span><span class="p">()</span>
</pre></div>
</div>
<img src="../_images/sphx_glr_boundary_angles_007.png" srcset="../_images/sphx_glr_boundary_angles_007.png" alt="boundary angles" class = "sphx-glr-single-img"/><p>This output is much more helpful. We see that the individuals are largely the
same distance from the exterior wall during frames 250-350, and then notice
that;</p>
<ul class="simple">
<li><p>Individual <code class="docutils literal notranslate"><span class="pre">AEON_TP1</span></code> moves far away from the exterior wall,</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">AEON3B_NTP</span></code> moves almost up to the exterior wall,</p></li>
<li><p>and <code class="docutils literal notranslate"><span class="pre">AEON3B_TP2</span></code> seems to remain between the other two individuals.</p></li>
</ul>
<p>After frame 400, the individuals appear to go back to chaotic distances from
the exterior wall again, which is consistent with them having passed each
other in the <code class="docutils literal notranslate"><span class="pre">ring_region</span></code> and once again having the entire width of the
ring to explore.</p>
</section>
<section id="boundary-angles">
<h2>Boundary angles<a class="headerlink" href="#boundary-angles" title="Link to this heading">#</a></h2>
<p>Having observed the individuals’ behaviour as they pass one another in the
<code class="docutils literal notranslate"><span class="pre">ring_region</span></code>, we can begin to ask questions about their orientation with
respect to the nest. <code class="docutils literal notranslate"><span class="pre">movement</span></code> currently supports the computation of two
such “boundary angles”;</p>
<ul class="simple">
<li><p>The <strong>allocentric boundary angle</strong>. Given a region of interest <span class="math notranslate nohighlight">\(R\)</span>,
reference vector <span class="math notranslate nohighlight">\(\vec{r}\)</span> (such as global north), and a position
<span class="math notranslate nohighlight">\(p\)</span> in space (e.g. the position of an individual), the allocentric
boundary angle is the signed angle between the approach vector from
<span class="math notranslate nohighlight">\(p\)</span> to <span class="math notranslate nohighlight">\(R\)</span>, and <span class="math notranslate nohighlight">\(\vec{r}\)</span>.</p></li>
<li><p>The <strong>egocentric boundary angle</strong>. Given a region of interest <span class="math notranslate nohighlight">\(R\)</span>, a
forward vector <span class="math notranslate nohighlight">\(\vec{f}\)</span> (e.g. the direction of travel of an
individual), and the point of origin of <span class="math notranslate nohighlight">\(\vec{f}\)</span> denoted <span class="math notranslate nohighlight">\(p\)</span>
(e.g. the individual’s current position), the egocentric boundary angle is
the signed angle between the approach vector from <span class="math notranslate nohighlight">\(p\)</span> to <span class="math notranslate nohighlight">\(R\)</span>,
and <span class="math notranslate nohighlight">\(\vec{f}\)</span>.</p></li>
</ul>
<p>Note that egocentric angles are generally computed with changing frames of
reference in mind - the forward vector may be varying in time as the
individual moves around the arena. By contrast, allocentric angles are always
computed with respect to some fixed reference frame.</p>
<p>For the purposes of our example, we will define our “forward vector” as the
velocity vector between successive time-points, for each individual - we can
compute this from <code class="docutils literal notranslate"><span class="pre">positions</span></code> using the <code class="docutils literal notranslate"><span class="pre">compute_velocity</span></code> function in
<code class="docutils literal notranslate"><span class="pre">movement.kinematics</span></code>.
We will also define our reference frame, or “global north” direction, to be
the direction of the positive x-axis.</p>
<div class="highlight-Python notranslate"><div class="highlight"><pre><span></span><a href="https://docs.xarray.dev/en/stable/generated/xarray.DataArray.html#xarray.DataArray" title="xarray.core.dataarray.DataArray" class="sphx-glr-backref-module-xarray-core-dataarray sphx-glr-backref-type-py-class sphx-glr-backref-instance"><span class="n">forward_vector</span></a> <span class="o">=</span> <span class="n">compute_velocity</span><span class="p">(</span><a href="https://docs.xarray.dev/en/stable/generated/xarray.DataArray.html#xarray.DataArray" title="xarray.core.dataarray.DataArray" class="sphx-glr-backref-module-xarray-core-dataarray sphx-glr-backref-type-py-class sphx-glr-backref-instance"><span class="n">positions</span></a><span class="p">)</span>
<span class="n">global_north</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">([</span><span class="mf">1.0</span><span class="p">,</span> <span class="mf">0.0</span><span class="p">])</span>

<a href="https://docs.xarray.dev/en/stable/generated/xarray.DataArray.html#xarray.DataArray" title="xarray.core.dataarray.DataArray" class="sphx-glr-backref-module-xarray-core-dataarray sphx-glr-backref-type-py-class sphx-glr-backref-instance"><span class="n">allocentric_angles</span></a> <span class="o">=</span> <a href="../api/movement.roi.base.BaseRegionOfInterest.html#movement.roi.base.BaseRegionOfInterest.compute_allocentric_angle_to_nearest_point" title="movement.roi.base.BaseRegionOfInterest.compute_allocentric_angle_to_nearest_point" class="sphx-glr-backref-module-movement-roi-base sphx-glr-backref-type-py-method"><span class="n">nest_region</span><span class="o">.</span><span class="n">compute_allocentric_angle_to_nearest_point</span></a><span class="p">(</span>
    <a href="https://docs.xarray.dev/en/stable/generated/xarray.DataArray.html#xarray.DataArray" title="xarray.core.dataarray.DataArray" class="sphx-glr-backref-module-xarray-core-dataarray sphx-glr-backref-type-py-class sphx-glr-backref-instance"><span class="n">positions</span></a><span class="p">,</span>
    <span class="n">reference_vector</span><span class="o">=</span><span class="n">global_north</span><span class="p">,</span>
    <span class="n">in_degrees</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span>
<span class="p">)</span>
<a href="https://docs.xarray.dev/en/stable/generated/xarray.DataArray.html#xarray.DataArray" title="xarray.core.dataarray.DataArray" class="sphx-glr-backref-module-xarray-core-dataarray sphx-glr-backref-type-py-class sphx-glr-backref-instance"><span class="n">egocentric_angles</span></a> <span class="o">=</span> <a href="../api/movement.roi.base.BaseRegionOfInterest.html#movement.roi.base.BaseRegionOfInterest.compute_egocentric_angle_to_nearest_point" title="movement.roi.base.BaseRegionOfInterest.compute_egocentric_angle_to_nearest_point" class="sphx-glr-backref-module-movement-roi-base sphx-glr-backref-type-py-method"><span class="n">nest_region</span><span class="o">.</span><span class="n">compute_egocentric_angle_to_nearest_point</span></a><span class="p">(</span>
    <a href="https://docs.xarray.dev/en/stable/generated/xarray.DataArray.html#xarray.DataArray" title="xarray.core.dataarray.DataArray" class="sphx-glr-backref-module-xarray-core-dataarray sphx-glr-backref-type-py-class sphx-glr-backref-instance"><span class="n">forward_vector</span></a><span class="p">,</span>
    <a href="https://docs.xarray.dev/en/stable/generated/xarray.DataArray.html#xarray.DataArray" title="xarray.core.dataarray.DataArray" class="sphx-glr-backref-module-xarray-core-dataarray sphx-glr-backref-type-py-class sphx-glr-backref-instance"><span class="n">positions</span></a><span class="p">[:</span><span class="o">-</span><span class="mi">1</span><span class="p">],</span>
    <span class="n">in_degrees</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span>
<span class="p">)</span>

<span class="n">angle_plot</span><span class="p">,</span> <span class="n">angle_ax</span> <span class="o">=</span> <span class="n">plt</span><span class="o">.</span><span class="n">subplots</span><span class="p">(</span><span class="mi">2</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="n">sharex</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
<span class="n">allo_ax</span><span class="p">,</span> <span class="n">ego_ax</span> <span class="o">=</span> <span class="n">angle_ax</span>

<span class="k">for</span> <span class="n">mouse_name</span><span class="p">,</span> <a href="https://docs.python.org/3/library/stdtypes.html#str" title="builtins.str" class="sphx-glr-backref-module-builtins sphx-glr-backref-type-py-class sphx-glr-backref-instance"><span class="n">col</span></a> <span class="ow">in</span> <a href="https://docs.python.org/3/library/stdtypes.html#list" title="builtins.list" class="sphx-glr-backref-module-builtins sphx-glr-backref-type-py-class sphx-glr-backref-instance"><span class="n">mouse_names_and_colours</span></a><span class="p">:</span>
    <span class="n">allo_ax</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span>
        <a href="https://docs.xarray.dev/en/stable/generated/xarray.DataArray.sel.html#xarray.DataArray.sel" title="xarray.DataArray.sel" class="sphx-glr-backref-module-xarray sphx-glr-backref-type-py-method"><span class="n">allocentric_angles</span><span class="o">.</span><span class="n">sel</span></a><span class="p">(</span><span class="n">individuals</span><span class="o">=</span><span class="n">mouse_name</span><span class="p">),</span>
        <span class="n">c</span><span class="o">=</span><a href="https://docs.python.org/3/library/stdtypes.html#str" title="builtins.str" class="sphx-glr-backref-module-builtins sphx-glr-backref-type-py-class sphx-glr-backref-instance"><span class="n">col</span></a><span class="p">,</span>
        <span class="n">label</span><span class="o">=</span><span class="n">mouse_name</span><span class="p">,</span>
    <span class="p">)</span>
    <span class="n">ego_ax</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span>
        <a href="https://docs.xarray.dev/en/stable/generated/xarray.DataArray.sel.html#xarray.DataArray.sel" title="xarray.DataArray.sel" class="sphx-glr-backref-module-xarray sphx-glr-backref-type-py-method"><span class="n">egocentric_angles</span><span class="o">.</span><span class="n">sel</span></a><span class="p">(</span><span class="n">individuals</span><span class="o">=</span><span class="n">mouse_name</span><span class="p">),</span>
        <span class="n">c</span><span class="o">=</span><a href="https://docs.python.org/3/library/stdtypes.html#str" title="builtins.str" class="sphx-glr-backref-module-builtins sphx-glr-backref-type-py-class sphx-glr-backref-instance"><span class="n">col</span></a><span class="p">,</span>
        <span class="n">label</span><span class="o">=</span><span class="n">mouse_name</span><span class="p">,</span>
    <span class="p">)</span>

<span class="n">ego_ax</span><span class="o">.</span><span class="n">set_xlabel</span><span class="p">(</span><span class="s2">&quot;Time (frames)&quot;</span><span class="p">)</span>

<span class="n">ego_ax</span><span class="o">.</span><span class="n">set_ylabel</span><span class="p">(</span><span class="s2">&quot;Egocentric angle (degrees)&quot;</span><span class="p">)</span>
<span class="n">allo_ax</span><span class="o">.</span><span class="n">set_ylabel</span><span class="p">(</span><span class="s2">&quot;Allocentric angle (degrees)&quot;</span><span class="p">)</span>
<span class="n">allo_ax</span><span class="o">.</span><span class="n">legend</span><span class="p">()</span>

<span class="n">angle_plot</span><span class="o">.</span><span class="n">tight_layout</span><span class="p">()</span>
<span class="n">angle_plot</span><span class="o">.</span><span class="n">show</span><span class="p">()</span>
</pre></div>
</div>
<img src="../_images/sphx_glr_boundary_angles_008.png" srcset="../_images/sphx_glr_boundary_angles_008.png" alt="boundary angles" class = "sphx-glr-single-img"/><p>Allocentric angles show step-like behaviour because they only depend on an
individual’s position relative to the RoI, not their forward vector. This
makes the allocentric angle graph resemble the distance-to-nest graph
(inverted on the y-axis), with a “plateau” during frames 200-400 when the
individuals are (largely) stationary while passing each other.</p>
<p>Egocentric angles, on the other hand, fluctuate more due to their sensitivity
to changes in the forward vector. Outside frames 200-400, we see trends:</p>
<ul class="simple">
<li><p><code class="docutils literal notranslate"><span class="pre">AEON3B_TP2</span></code> moves counter-clockwise around the ring, so its egocentric
angle decreases ever so slightly with time - almost hitting an angle of 0
degrees as it moves along the direction of closest approach after passing
the other individuals.</p></li>
<li><p>The other two individuals move clockwise, so their angles show a
gradual increase with time. Because the two individuals occasionally get in
each others’ way, we see frequent “spikes” in their egocentric angles as
their forward vectors rapidly change.</p></li>
</ul>
<p>During frames 200-400, rapid changes in direction cause large fluctuations in
the egocentric angles of all the individuals, reflecting the individuals’
attempts to avoid colliding with (and to make space to move passed) each
other.</p>
<p class="sphx-glr-timing"><strong>Total running time of the script:</strong> (0 minutes 1.364 seconds)</p>
<div class="sphx-glr-footer sphx-glr-footer-example docutils container" id="sphx-glr-download-examples-boundary-angles-py">
<div class="binder-badge docutils container">
<a class="reference external image-reference" href="https://mybinder.org/v2/gh/neuroinformatics-unit/movement/gh-pages?filepath=notebooks/examples/boundary_angles.ipynb"><img alt="Launch binder" src="../_images/binder_badge_logo1.svg" style="width: 150px;" />
</a>
</div>
<div class="sphx-glr-download sphx-glr-download-jupyter docutils container">
<p><a class="reference download internal" download="" href="../_downloads/04baca85edf678962f8916ab8b73b51f/boundary_angles.ipynb"><code class="xref download docutils literal notranslate"><span class="pre">Download</span> <span class="pre">Jupyter</span> <span class="pre">notebook:</span> <span class="pre">boundary_angles.ipynb</span></code></a></p>
</div>
<div class="sphx-glr-download sphx-glr-download-python docutils container">
<p><a class="reference download internal" download="" href="../_downloads/4324940b47889633cb8b191f3179f4df/boundary_angles.py"><code class="xref download docutils literal notranslate"><span class="pre">Download</span> <span class="pre">Python</span> <span class="pre">source</span> <span class="pre">code:</span> <span class="pre">boundary_angles.py</span></code></a></p>
</div>
<div class="sphx-glr-download sphx-glr-download-zip docutils container">
<p><a class="reference download internal" download="" href="../_downloads/3ef320cda94d0b88f7dab70c65d48a2b/boundary_angles.zip"><code class="xref download docutils literal notranslate"><span class="pre">Download</span> <span class="pre">zipped:</span> <span class="pre">boundary_angles.zip</span></code></a></p>
</div>
</div>
<p class="sphx-glr-signature"><a class="reference external" href="https://sphinx-gallery.github.io">Gallery generated by Sphinx-Gallery</a></p>
</section>
</section>

<div class="section ablog__blog_comments">
   
</div>

                </article>
              
              
              
              
              
                <footer class="prev-next-footer d-print-none">
                  
<div class="prev-next-area">
    <a class="left-prev"
       href="compute_kinematics.html"
       title="previous page">
      <i class="fa-solid fa-angle-left"></i>
      <div class="prev-next-info">
        <p class="prev-next-subtitle">previous</p>
        <p class="prev-next-title">Compute and visualise kinematics.</p>
      </div>
    </a>
    <a class="right-next"
       href="load_and_upsample_bboxes.html"
       title="next page">
      <div class="prev-next-info">
        <p class="prev-next-subtitle">next</p>
        <p class="prev-next-title">Load and upsample bounding box tracks</p>
      </div>
      <i class="fa-solid fa-angle-right"></i>
    </a>
</div>
                </footer>
              
            </div>
            
            
              
                <dialog id="pst-secondary-sidebar-modal"></dialog>
                <div id="pst-secondary-sidebar" class="bd-sidebar-secondary bd-toc"><div class="sidebar-secondary-items sidebar-secondary__inner">


  <div class="sidebar-secondary-item">
<div
    id="pst-page-navigation-heading-2"
    class="page-toc tocsection onthispage">
    <i class="fa-solid fa-list"></i> On this page
  </div>
  <nav class="bd-toc-nav page-toc" aria-labelledby="pst-page-navigation-heading-2">
    <ul class="visible nav section-nav flex-column">
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#imports">Imports</a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#load-sample-dataset">Load sample dataset</a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#define-regions-of-interest">Define regions of interest</a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#view-individual-paths-inside-the-arena">View individual paths inside the arena</a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#compute-the-distance-to-the-nest">Compute the distance to the nest</a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#the-boundary-only-keyword">The <code class="docutils literal notranslate"><span class="pre">boundary_only</span></code> keyword</a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#boundary-angles">Boundary angles</a></li>
</ul>
  </nav></div>

  <div class="sidebar-secondary-item">
  <div role="note" aria-label="source link">
    <h3>This Page</h3>
    <ul class="this-page-menu">
      <li><a href="../_sources/examples/boundary_angles.rst.txt"
            rel="nofollow">Show Source</a></li>
    </ul>
   </div></div>

</div></div>
              
            
          </div>
          <footer class="bd-footer-content">
            
          </footer>
        
      </main>
    </div>
  </div>
  
  <!-- Scripts loaded after <body> so the DOM is not blocked -->
  <script defer src="../_static/scripts/bootstrap.js?digest=8878045cc6db502f8baf"></script>
<script defer src="../_static/scripts/pydata-sphinx-theme.js?digest=8878045cc6db502f8baf"></script>

  <footer class="bd-footer">
<div class="bd-footer__inner bd-page-width">
  
    <div class="footer-items__start">
      
        <div class="footer-item"><p class="sphinx-version">
    Created using <a href="https://www.sphinx-doc.org/">Sphinx</a> 8.1.3.
    <br/>
    </p>
    <p class="theme-version">
    Built with the
    <a href="https://pydata-sphinx-theme.readthedocs.io/en/stable/index.html">PyData Sphinx Theme</a>
    0.16.1.
    </p></div>
      
    </div>
  
  
  
    <div class="footer-items__end">
      
        <div class="footer-item"><div class="things-in-a-row">
    <a href="https://neuroinformatics.dev/">
        <img src="../_static/light-logo-niu.png" alt="Sponsors" class="only-light img-sponsor"/>
        <img src="../_static/dark-logo-niu.png" alt="Sponsors" class="only-dark img-sponsor"/>
    </a>
    <a href="https://www.sainsburywellcome.org/web/">
        <img src="../_static/light-logo-swc.png" alt="Sponsors" class="only-light img-sponsor"/>
        <img src="../_static/dark-logo-swc.png" alt="Sponsors" class="only-dark img-sponsor"/>
    </a>
    <a href="https://www.ucl.ac.uk/gatsby/gatsby-computational-neuroscience-unit">
        <img src="../_static/light-logo-gatsby.png" alt="Sponsors" class="only-light img-sponsor"/>
        <img src="../_static/dark-logo-gatsby.png" alt="Sponsors" class="only-dark img-sponsor"/>
    </a>
    <a href="https://www.ucl.ac.uk/">
        <img src="../_static/light-logo-ucl.png" alt="Sponsors" class="only-light img-sponsor"/>
        <img src="../_static/dark-logo-ucl.png" alt="Sponsors" class="only-dark img-sponsor"/>
    </a>
</div></div>
      
    </div>
  
</div>

  </footer>
  </body>
</html>